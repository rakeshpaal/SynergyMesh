apiVersion: machinenativeops.io/v1
kind: GovernanceConfig
metadata:
  description: Root layer governance and policy configuration
  name: root-governance
  version: 1.0.0
spec:
  audit:
    logging:
      enabled: true
      format: json
      level: INFO
      outputs:
      - path: var/log/machine-native-ops/audit.log
        retention: 365d
        rotation: daily
        type: file
      - facility: auth
        severity: info
        type: syslog
    monitoring:
      alerts:
      - action: notify_admins
        condition: access_denials.rate > 10/min
        name: high_access_denials
        severity: warning
      - action: notify_security_team
        condition: authentication_failures.rate > 5/min
        name: authentication_failure_spike
        severity: critical
      enabled: true
      metrics:
      - description: Number of policy evaluations
        name: policy_evaluations
        type: counter
      - description: Number of access denials
        name: access_denials
        type: counter
      - description: Number of authentication failures
        name: authentication_failures
        type: counter
  policies:
    change-management:
      description: Policy for managing system changes
      name: change-management
      rules:
      - action: require_approval
        approvers:
        - system-admin
        condition: change.type == 'critical'
        description: All changes require approval
        name: require-approval
      - action: require_validation
        condition: change.target == 'config'
        description: All configuration changes require validation
        name: require-validation
        validator: config-validator
    compliance:
      description: Regulatory compliance requirements
      name: compliance
      rules:
      - action: retain_data
        condition: data.type == 'audit_log'
        description: Audit logs must be retained for 1 year
        name: data-retention
        period: 365d
      - action: schedule_review
        condition: user.role != 'viewer'
        description: Quarterly access reviews required
        frequency: quarterly
        name: access-review
    security:
      description: Security and access control policies
      name: security
      rules:
      - action: require_authentication
        condition: operation.sensitive == true
        description: All operations require authentication
        methods:
        - mfa
        - certificate
        name: require-authentication
      - action: log_audit
        condition: operation.category == 'security'
        description: All security operations must be logged
        name: audit-logging
        retention: 365d
  rbac:
    roles:
      config-admin:
        description: Configuration administrator
        name: config-admin
        permissions:
        - config:*
        - policy:read
        restrictions:
        - security:*
      operator:
        description: System operator
        name: operator
        permissions:
        - monitoring:read
        - logging:read
        - health:read
        restrictions:
        - config:*
        - security:*
      security-admin:
        description: Security administrator
        name: security-admin
        permissions:
        - security:*
        - trust:*
        - integrity:*
        restrictions:
        - config:write
      system-admin:
        description: System administrator with full access
        name: system-admin
        permissions:
        - '*:*'
        restrictions: []
      viewer:
        description: Read-only access
        name: viewer
        permissions:
        - '*:read'
        restrictions:
        - config:*
        - security:*
        - trust:*
    users:
      admin-user:
        groups:
        - admin-team
        roles:
        - config-admin
        - security-admin
      ops-user:
        groups:
        - ops-team
        roles:
        - operator
      superninja:
        groups:
        - admin-team
        roles:
        - system-admin
status:
  created: '2025-12-21T05:14:00Z'
  total_policies: 3
  total_roles: 5
  updated: '2025-12-21T05:14:00Z'
  validated: true
  version: 1.0.0
