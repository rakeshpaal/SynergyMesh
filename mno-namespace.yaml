<<<<<<< HEAD
# MachineNativeOps Namespace Configuration
# 對齊所有 MachineNativeOps 標準

apiVersion: machinenativeops.io/v2
kind: MachineNativeOpsGlobalBaseline
metadata:
  name: mno-namespace-baseline
  namespace: machinenativenops
  labels:
    machinenativeops.io/name: mno-namespace-baseline
    machinenativeops.io/version: v2.0.0
    machinenativeops.io/component: namespace-configuration
    machinenativeops.io/managed-by: machine-native-ops-aaps
  annotations:
    machinenativeops.io/description: "MachineNativeOps namespace baseline configuration"
    machinenativeops.io/created-by: "namespace-alignment-tool"
    machinenativeops.io/registry: "registry.machinenativeops.io"
    machinenativeops.io/certificate-path: "etc/machinenativeops/pkl"
    machinenativeops.io/cluster-token: "super-agent-etcd-cluster"
spec:
  # MachineNativeOps 標準配置
  namespace: machinenativenops
  registry: registry.machinenativeops.io
  certificatePath: etc/machinenativeops/pkl
  clusterToken: super-agent-etcd-cluster
  
  # 標籤和註解前綴
  labelPrefix: machinenativeops.io
  annotationPrefix: machinenativeops.io
  urnPrefix: "urn:machinenativenops:"
  
  # API 版本配置
  apiVersion: machinenativeops.io/v2
  resourceType: MachineNativeOpsGlobalBaseline
  
  # 命名空間對齊規則
  alignmentRules:
    - name: "apiVersion alignment"
      pattern: "machinenativeops.io"
      required: true
    - name: "namespace alignment" 
      pattern: "machinenativenops"
      required: true
    - name: "registry alignment"
      pattern: "registry.machinenativeops.io"
      required: true
    - name: "certificate path alignment"
      pattern: "etc/machinenativeops/pkl"
      required: true
    - name: "cluster token alignment"
      pattern: "super-agent-etcd-cluster"
      required: true
  
  # 驗證配置
  validation:
    strictMode: true
    enforceAllTags: true
    checkLegacyReferences: false
    
  # 轉換配置
  conversion:
    autoFix: true
    backupEnabled: true
    dryRunSupported: true
=======
# ═══════════════════════════════════════════════════════════════════════════════
#                    MachineNativeOps Namespace Configuration
#                    命名空間配置 - 統一命名標準
# ═══════════════════════════════════════════════════════════════════════════════
#
# Version: 1.0.0
# Purpose: Define and enforce MachineNativeOps namespace standards across all systems
# Updated: 2025-12-22
# ═══════════════════════════════════════════════════════════════════════════════

apiVersion: machinenativeops.io/v1
kind: NamespaceConfig
metadata:
  name: mno-namespace-config
  namespace: machinenativeops
  labels:
    machinenativeops.io/tier: "core"
    machinenativeops.io/version: "v1.0.0"
    machinenativeops.io/component: "namespace"
  annotations:
    machinenativeops.io/description: "Unified namespace configuration for MachineNativeOps platform"
    machinenativeops.io/enforcement: "strict"
    machinenativeops.io/last-modified: "2025-12-22T06:40:00Z"

spec:
  version: 1
  
  # ============================================================================
  # Core Namespace Definitions (核心命名空間定義)
  # ============================================================================
  namespaces:
    primary:
      name: "machinenativeops"
      description: "Primary namespace for all MachineNativeOps resources"
      scope: "global"
      
    subspaces:
      - name: "machinenativeops-specs"
        description: "Specifications and schemas"
        parent: "machinenativeops"
      
      - name: "machinenativeops-modules"
        description: "Core modules and services"
        parent: "machinenativeops"
      
      - name: "machinenativeops-agents"
        description: "Agent configurations and policies"
        parent: "machinenativeops"
      
      - name: "machinenativeops-monitoring"
        description: "Monitoring and observability"
        parent: "machinenativeops"
      
      - name: "machinenativeops-security"
        description: "Security and compliance"
        parent: "machinenativeops"

  # ============================================================================
  # Domain Standards (域名標準)
  # ============================================================================
  domains:
    primary: "machinenativeops.io"
    aliases:
      - "mno.io"
      - "machinenative.io"
    
    registry:
      host: "registry.machinenativeops.io"
      protocol: "https"
      port: 443
      mirrors:
        - "registry.mno.io"
        - "ghcr.io/machinenativeops"
    
    api:
      host: "api.machinenativeops.io"
      versions:
        - "v1"
        - "v2"
      endpoints:
        health: "/health"
        metrics: "/metrics"
        status: "/status"

  # ============================================================================
  # Kubernetes Integration (Kubernetes 整合)
  # ============================================================================
  kubernetes:
    namespace: "machinenativeops"
    labels:
      app.kubernetes.io/name: "machinenativeops"
      app.kubernetes.io/instance: "{{ .Release.Name }}"
      app.kubernetes.io/version: "{{ .Chart.AppVersion }}"
      app.kubernetes.io/managed-by: "{{ .Release.Service }}"
      machinenativeops.io/tier: "{{ .Values.tier }}"
    
    annotations:
      machinenativeops.io/namespace: "machinenativeops"
      machinenativeops.io/managed: "true"
    
    service_account:
      name: "machinenativeops-sa"
      namespace: "machinenativeops"

  # ============================================================================
  # File System Paths (檔案系統路徑)
  # ============================================================================
  filesystem:
    base_path: "/opt/machinenativeops"
    
    directories:
      config: "/etc/machinenativeops"
      certificates: "/etc/machinenativeops/pkl"
      data: "/var/lib/machinenativeops"
      logs: "/var/log/machinenativeops"
      cache: "/var/cache/machinenativeops"
      tmp: "/tmp/machinenativeops"
    
    files:
      config: "/etc/machinenativeops/config.yaml"
      namespace: "/etc/machinenativeops/namespace.yaml"
      certificates:
        ca: "/etc/machinenativeops/pkl/ca.crt"
        cert: "/etc/machinenativeops/pkl/tls.crt"
        key: "/etc/machinenativeops/pkl/tls.key"

  # ============================================================================
  # ETCD Configuration (ETCD 配置)
  # ============================================================================
  etcd:
    cluster_name: "super-agent-etcd-cluster"
    namespace_prefix: "machinenativeops"
    
    endpoints:
      - "https://etcd-0.super-agent-etcd-cluster.machinenativeops.svc.cluster.local:2379"
      - "https://etcd-1.super-agent-etcd-cluster.machinenativeops.svc.cluster.local:2379"
      - "https://etcd-2.super-agent-etcd-cluster.machinenativeops.svc.cluster.local:2379"
    
    paths:
      config: "/machinenativeops/config"
      modules: "/machinenativeops/modules"
      agents: "/machinenativeops/agents"
      state: "/machinenativeops/state"
      locks: "/machinenativeops/locks"
    
    authentication:
      enabled: true
      cert_file: "/etc/machinenativeops/pkl/etcd-client.crt"
      key_file: "/etc/machinenativeops/pkl/etcd-client.key"
      ca_file: "/etc/machinenativeops/pkl/ca.crt"

  # ============================================================================
  # Container Registry (容器鏡像倉庫)
  # ============================================================================
  registry:
    host: "registry.machinenativeops.io"
    organization: "machinenativeops"
    
    repositories:
      core:
        - "machinenativeops/core"
        - "machinenativeops/agent"
        - "machinenativeops/mcp-server"
      
      monitoring:
        - "machinenativeops/prometheus"
        - "machinenativeops/grafana"
        - "machinenativeops/alertmanager"
      
      security:
        - "machinenativeops/scanner"
        - "machinenativeops/validator"
    
    tagging_strategy:
      pattern: "{{ .Version }}-{{ .BuildDate }}"
      latest: true
      semantic_versioning: true

  # ============================================================================
  # Naming Conventions (命名規範)
  # ============================================================================
  naming_conventions:
    resource_types:
      deployment: "{{ .Component }}-deployment"
      service: "{{ .Component }}-service"
      configmap: "{{ .Component }}-config"
      secret: "{{ .Component }}-secret"
      ingress: "{{ .Component }}-ingress"
    
    labels:
      app: "machinenativeops"
      component: "{{ .Component }}"
      tier: "{{ .Tier }}"
      version: "{{ .Version }}"
    
    annotations:
      managed_by: "machinenativeops.io/managed-by"
      version: "machinenativeops.io/version"
      namespace: "machinenativeops.io/namespace"

  # ============================================================================
  # API Versioning (API 版本控制)
  # ============================================================================
  api_versioning:
    current: "v1"
    supported:
      - version: "v1"
        deprecated: false
        sunset_date: null
      - version: "v2"
        deprecated: false
        sunset_date: null
    
    format: "machinenativeops.io/{{ .Version }}"
    
    compatibility:
      backward_compatible: true
      forward_compatible: false

  # ============================================================================
  # Migration Rules (遷移規則)
  # ============================================================================
  migration:
    legacy_namespaces:
      - from: "axiom"
        to: "machinenativeops"
        auto_convert: true
      - from: "machinenativeops.io"
        to: "machinenativeops.io"
        auto_convert: true
      - from: "MachineNativeOpsGlobalBaseline"
        to: "MachineNativeOpsGlobalBaseline"
        auto_convert: true
    
    conversion_rules:
      - pattern: "^axiom\\.io/v(\\d+)$"
        replacement: "machinenativeops.io/v$1"
        scope: "api_version"
      
      - pattern: "^urn:machinenativeops:(.*)$"
        replacement: "urn:machinenativeops:$1"
        scope: "urn"
      
      - pattern: "^machinenativeops-(.*)$"
        replacement: "machinenativeops-$1"
        scope: "resource_name"

  # ============================================================================
  # Validation Rules (驗證規則)
  # ============================================================================
  validation:
    enabled: true
    strict_mode: true
    
    rules:
      - id: "NS-001"
        description: "All resources must use machinenativeops namespace"
        severity: "error"
        pattern: "^machinenativeops"
      
      - id: "NS-002"
        description: "API versions must follow domain/version format"
        severity: "error"
        pattern: "^machinenativeops\\.io/v\\d+$"
      
      - id: "NS-003"
        description: "Resource names must use kebab-case"
        severity: "error"
        pattern: "^[a-z][a-z0-9-]*[a-z0-9]$"
      
      - id: "NS-004"
        description: "No legacy axiom namespace references allowed"
        severity: "error"
        pattern: "^(?!.*axiom).*$"
    
    auto_fix:
      enabled: false
      dry_run: true

  # ============================================================================
  # Enforcement (執行策略)
  # ============================================================================
  enforcement:
    level: "strict"
    gates:
      - name: "namespace-validation"
        type: "pre-commit"
        enabled: true
      
      - name: "api-version-check"
        type: "pre-merge"
        enabled: true
      
      - name: "resource-naming"
        type: "ci"
        enabled: true
    
    exceptions:
      - resource: "legacy-migration-*"
        reason: "Temporary exception during migration"
        expires: "2026-01-31"

# ============================================================================
# Status (狀態)
# ============================================================================
status:
  phase: "Active"
  conditions:
    - type: "Validated"
      status: "True"
      last_transition_time: "2025-12-22T06:40:00Z"
      reason: "ConfigurationComplete"
      message: "Namespace configuration is complete and active"
  
  statistics:
    total_namespaces: 6
    total_rules: 4
    migration_paths: 3
    enforcement_gates: 3
#                    命名空間配置 - 統一命名規範
# ═══════════════════════════════════════════════════════════════════════════════
#
# Version: 1.0.0
# Updated: 2025-12-22
# Purpose: 定義所有 MachineNativeOps 相關的命名空間、標籤、倉庫和路徑
#
# This file defines the canonical naming conventions for all MachineNativeOps
# components, ensuring consistency across:
# - Container images and registries
# - Kubernetes namespaces
# - Certificate paths
# - Cluster tokens
# - Domain names
# ═══════════════════════════════════════════════════════════════════════════════

version: "1.0.0"
name: "MachineNativeOps Namespace Configuration"

# ============================================================================
# Primary Namespace (主要命名空間)
# ============================================================================
namespace:
  primary: "machinenativeops"
  short: "mno"
  full: "machine-native-ops"
  
  # Alternative forms for different contexts
  variants:
    camelCase: "machineNativeOps"
    PascalCase: "MachineNativeOps"
    snake_case: "machine_native_ops"
    kebab-case: "machine-native-ops"
    lowercase: "machinenativeops"

# ============================================================================
# Domain Configuration (域名配置)
# ============================================================================
domains:
  primary: "machinenativeops.io"
  registry: "registry.machinenativeops.io"
  docs: "docs.machinenativeops.io"
  api: "api.machinenativeops.io"
  monitoring: "monitoring.machinenativeops.io"

# ============================================================================
# Registry Configuration (鏡像倉庫配置)
# ============================================================================
registries:
  primary:
    url: "registry.machinenativeops.io"
    namespace: "machinenativeops"
    type: "harbor"
    
  mirrors:
    - url: "ghcr.io/machinenativeops"
      type: "github"
    - url: "docker.io/machinenativeops"
      type: "dockerhub"

# ============================================================================
# Certificate Paths (證書路徑)
# ============================================================================
certificates:
  base_path: "/etc/machinenativeops"
  pkl_path: "/etc/machinenativeops/pkl"
  
  paths:
    ca_cert: "/etc/machinenativeops/ca.crt"
    server_cert: "/etc/machinenativeops/server.crt"
    server_key: "/etc/machinenativeops/server.key"
    client_cert: "/etc/machinenativeops/client.crt"
    client_key: "/etc/machinenativeops/client.key"

# ============================================================================
# Cluster Configuration (集群配置)
# ============================================================================
clusters:
  etcd:
    token: "super-agent-etcd-cluster"
    namespace: "machinenativeops-system"
    service_name: "etcd-machinenativeops"
    
  kubernetes:
    namespace: "machinenativeops"
    system_namespace: "machinenativeops-system"
    monitoring_namespace: "machinenativeops-monitoring"
    
# ============================================================================
# Container Image Tags (容器鏡像標籤)
# ============================================================================
image_tags:
  prefix: "machinenativeops"
  
  # Standard image naming pattern:
  # registry.machinenativeops.io/machinenativeops/<component>:<version>
  pattern: "${registry}/${namespace}/${component}:${version}"
  
  components:
    core:
      - "synergymesh-core"
      - "ai-decision-engine"
      - "contract-service"
      
    autonomous:
      - "autonomous-drone"
      - "intelligent-agent"
      - "auto-monitor"
      
    governance:
      - "policy-engine"
      - "schema-validator"
      - "governance-controller"
      
    services:
      - "mcp-server"
      - "code-analyzer"
      - "security-scanner"

# ============================================================================
# Service Naming (服務命名)
# ============================================================================
services:
  naming_pattern: "mno-${component}-${environment}"
  
  prefixes:
    core: "mno-core"
    agent: "mno-agent"
    api: "mno-api"
    worker: "mno-worker"
    
  examples:
    - "mno-core-synergymesh-prod"
    - "mno-agent-autonomous-dev"
    - "mno-api-gateway-staging"

# ============================================================================
# Configuration Paths (配置路徑)
# ============================================================================
config_paths:
  base: "/opt/machinenativeops"
  config: "/opt/machinenativeops/config"
  data: "/var/lib/machinenativeops"
  logs: "/var/log/machinenativeops"
  cache: "/var/cache/machinenativeops"
  
  # Application-specific paths
  apps:
    synergymesh: "/opt/machinenativeops/synergymesh"
    autonomous: "/opt/machinenativeops/autonomous"
    governance: "/opt/machinenativeops/governance"

# ============================================================================
# Label Standards (標籤標準)
# ============================================================================
labels:
  # Kubernetes label recommendations
  kubernetes:
    app: "app.kubernetes.io/name"
    version: "app.kubernetes.io/version"
    component: "app.kubernetes.io/component"
    part_of: "app.kubernetes.io/part-of"
    managed_by: "app.kubernetes.io/managed-by"
    
  # Custom MachineNativeOps labels
  custom:
    namespace: "machinenativeops.io/namespace"
    subsystem: "machinenativeops.io/subsystem"
    tier: "machinenativeops.io/tier"
    environment: "machinenativeops.io/environment"
    
  # Label values
  values:
    part_of: "machinenativeops"
    managed_by: "machinenativeops-operator"

# ============================================================================
# Annotation Standards (註解標準)
# ============================================================================
annotations:
  prefix: "machinenativeops.io"
  
  standard:
    description: "machinenativeops.io/description"
    version: "machinenativeops.io/version"
    docs: "machinenativeops.io/docs"
    owner: "machinenativeops.io/owner"
    contact: "machinenativeops.io/contact"

# ============================================================================
# Environment Variables (環境變數)
# ============================================================================
env_vars:
  prefix: "MNO"
  
  standard:
    - "MNO_NAMESPACE"
    - "MNO_ENVIRONMENT"
    - "MNO_REGISTRY"
    - "MNO_CLUSTER_TOKEN"
    - "MNO_CONFIG_PATH"
    - "MNO_DATA_PATH"
    - "MNO_LOG_LEVEL"

# ============================================================================
# Validation Rules (驗證規則)
# ============================================================================
validation:
  namespace_pattern: "^machinenativeops(-[a-z0-9]+)*$"
  component_pattern: "^[a-z][a-z0-9-]*$"
  version_pattern: "^v?\\d+\\.\\d+\\.\\d+(-[a-z0-9.-]+)?$"
  
  constraints:
    max_namespace_length: 63
    max_label_length: 63
    allowed_characters: "a-z0-9-"

# ============================================================================
# Migration Support (遷移支援)
# ============================================================================
migration:
  legacy_namespaces:
    - "machine-native-ops-aaps"
    - "aaps"
    
  mapping:
    "machine-native-ops-aaps": "machinenativeops"
    "aaps": "machinenativeops"
    
  deprecation_date: "2026-06-01"
  migration_guide: "docs/migration/namespace-migration.md"
apiVersion: machinenativeops.io/v2
kind: MachineNativeOpsNamespaceConfig
metadata:
  name: machinenativeops-namespace-configuration
  namespace: machinenativeops
  labels:
    machinenativeops.io/component: namespace-config
    machinenativeops.io/version: v2
  annotations:
    machinenativeops.io/description: "MachineNativeOps 命名空間標準配置"
    machinenativeops.io/urn: "urn:machinenativeops:config:namespace:v2"

spec:
  # 命名空間標準
  namespace:
    primary: "machinenativeops"
    aliases:
      - "mno"
      - "machine-native-ops"
  
  # 域名標準
  domains:
    primary: "machinenativeops.io"
    api_versions:
      - "machinenativeops.io/v1"
      - "machinenativeops.io/v2"
    registry: "registry.machinenativeops.io"
    documentation: "docs.machinenativeops.io"
  
  # URN 標準
  urn:
    prefix: "urn:machinenativeops:"
    format: "urn:machinenativeops:{category}:{component}:{version}"
    examples:
      - "urn:machinenativeops:config:namespace:v2"
      - "urn:machinenativeops:service:auth:v1"
      - "urn:machinenativeops:policy:rbac:v2"
  
  # 標籤和註解標準
  labels:
    prefix: "machinenativeops.io/"
    required:
      - "machinenativeops.io/component"
      - "machinenativeops.io/version"
    recommended:
      - "machinenativeops.io/environment"
      - "machinenativeops.io/team"
      - "machinenativeops.io/managed-by"
  
  # 證書路徑標準
  certificates:
    base_path: "/etc/machinenativeops/pkl"
    ca_cert: "/etc/machinenativeops/pkl/ca.crt"
    client_cert: "/etc/machinenativeops/pkl/client.crt"
    client_key: "/etc/machinenativeops/pkl/client.key"
  
  # 集群標準
  cluster:
    etcd:
      name: "super-agent-etcd-cluster"
      namespace: "machinenativeops"
      token_prefix: "super-agent-etcd-"
    kubernetes:
      namespace: "machinenativeops"
      service_account_prefix: "machinenativeops-"
  
  # 遷移規則（從舊命名空間）
  migration:
    deprecated_patterns:
      - pattern: "axiom\\.io"
        replacement: "machinenativeops.io"
        status: "deprecated"
      - pattern: "MachineNativeOpsGlobalBaseline"
        replacement: "MachineNativeOpsGlobalBaseline"
        status: "deprecated"
      - pattern: "urn:machinenativeops:"
        replacement: "urn:machinenativeops:"
        status: "deprecated"
      - pattern: "machinenativeops-"
        replacement: "machinenativeops-"
        status: "deprecated"
    
    conversion_rules:
      strict_mode: true
      preserve_comments: true
      backup_originals: false
  
  # 驗證規則
  validation:
    enforce_urn_format: true
    enforce_label_prefix: true
    enforce_namespace: true
    allow_legacy_references: false
    
    # 排除路徑
    exclude_paths:
      - ".git"
      - ".github"
      - "node_modules"
      - "__pycache__"
      - "dist"
      - "build"
      - ".venv"
      - "venv"
      - "archive"
    
    # 文件類型
    file_extensions:
      - ".yaml"
      - ".yml"
      - ".json"
      - ".py"
      - ".md"
      - ".ts"
      - ".js"
---
# MachineNativeOps Namespace Configuration
# 機器原生運維命名空間配置
apiVersion: v1
kind: Namespace
metadata:
  name: machinenativeops
  labels:
    machinenativeops.io/managed: "true"
    machinenativeops.io/version: "v2"
    machinenativeops.io/component: "core"
  annotations:
    machinenativeops.io/description: "MachineNativeOps 核心命名空間"
    machinenativeops.io/registry: "registry.machinenativeops.io"
    machinenativeops.io/certificate-path: "etc/machinenativeops/pkl"
    machinenativeops.io/cluster-token: "super-agent-etcd-cluster"
---
# MachineNativeOps Registry Configuration
# 鏡像倉庫配置
apiVersion: v1
kind: ConfigMap
metadata:
  name: registry-config
  namespace: machinenativeops
  labels:
    machinenativeops.io/component: "registry"
data:
  registry.url: "registry.machinenativeops.io"
  registry.mirror: "registry.machinenativeops.io/mirror"
  certificate.path: "/etc/machinenativeops/pkl"
  cluster.token: "super-agent-etcd-cluster"
---
# MachineNativeOps Global Baseline
# 全局基線配置
apiVersion: machinenativeops.io/v2
kind: MachineNativeOpsGlobalBaseline
metadata:
  name: global-baseline
  namespace: machinenativeops
  labels:
    machinenativeops.io/baseline: "v2"
spec:
  namespace:
    primary: "machinenativeops"
    registry: "registry.machinenativeops.io"
  tags:
    domain: "machinenativeops.io"
    prefix: "machinenativeops.io/"
  paths:
    certificates: "etc/machinenativeops/pkl"
    config: "etc/machinenativeops/config"
  cluster:
    token: "super-agent-etcd-cluster"
    name: "machinenativeops-cluster"
  urn:
    pattern: "urn:machinenativeops:{resource}:{version}"
    examples:
      - "urn:machinenativeops:agent:v1"
      - "urn:machinenativeops:service:v2"
      - "urn:machinenativeops:monitor:v1"
>>>>>>> main
