apiVersion: machinenativeops.io/v2
kind: Namespace
metadata:
  name: '{{ .team }}-{{ .domain }}-{{ .environment }}'
  annotations:
    machinenativeops.io/canonical-urn: urn:machinenativeops:{{ .team }}:{{ .domain
      }}:env:{{ .environment }}:v1
    machinenativeops.io/description: '{{ .description | default "Team namespace for
      " }}{{ .domain }} in {{ .environment }}'
    machinenativeops.io/owner: '{{ .owner_email | default "team@example.com" }}'
    machinenativeops.io/slack-channel: '{{ .slack_channel | default "#team-" }}{{
      .domain }}'
    machinenativeops.io/cost-center: '{{ .cost_center | default "CC-0000" }}'
    machinenativeops.io/project: '{{ .project | default .domain }}'
    machinenativeops.io/service-mesh-id: '{{ .domain }}.{{ .environment }}.svc.cluster.local'
    machinenativeops.io/created-by: canonical-namespace-template
    machinenativeops.io/created-at: '{{ .timestamp | default now }}'
  labels:
    machinenativeops.io/environment: '{{ .environment }}'
    machinenativeops.io/tenant: '{{ .tenant | default "platform-team" }}'
    machinenativeops.io/team: '{{ .team }}-team'
    machinenativeops.io/name: '{{ .domain }}'
    machinenativeops.io/managed-by: '{{ .managed_by | default "helm" }}'
    machinenativeops.io/part-of: '{{ .part_of | default .domain }}'
    machinenativeops.io/domain: '{{ .domain }}'
    machinenativeops.io/criticality: '{{ .criticality | default "medium" }}'
spec: {}
---
apiVersion: machinenativeops.io/v2
kind: Namespace
metadata:
  name: tenant-{{ .workload }}-{{ .environment }}-{{ .region }}
  annotations:
    machinenativeops.io/canonical-urn: urn:machinenativeops:tenant:{{ .workload }}:env:{{
      .environment }}:region:{{ .region }}
    machinenativeops.io/description: Multi-tenant {{ .workload }} in {{ .environment
      }} ({{ .region }})
    machinenativeops.io/tenant-id: '{{ .tenant_id }}'
    machinenativeops.io/owner: '{{ .owner_email }}'
    machinenativeops.io/cost-center: '{{ .cost_center }}'
    machinenativeops.io/region: '{{ .region }}'
    machinenativeops.io/data-residency: '{{ .data_residency | default .region }}'
    machinenativeops.io/compliance: '{{ .compliance | default "standard" }}'
    machinenativeops.io/created-by: canonical-namespace-template
  labels:
    machinenativeops.io/environment: '{{ .environment }}'
    machinenativeops.io/tenant: '{{ .tenant_id }}'
    machinenativeops.io/workload: '{{ .workload }}'
    machinenativeops.io/region: '{{ .region }}'
    machinenativeops.io/name: '{{ .workload }}'
    machinenativeops.io/managed-by: '{{ .managed_by | default "terraform" }}'
    machinenativeops.io/criticality: '{{ .criticality | default "high" }}'
    machinenativeops.io/multi-tenant: 'true'
spec: {}
---
apiVersion: machinenativeops.io/v2
kind: Namespace
metadata:
  name: '{{ .environment }}-{{ .app }}-{{ .version }}'
  annotations:
    machinenativeops.io/canonical-urn: urn:machinenativeops:env:{{ .environment }}:app:{{
      .app }}:version:{{ .version }}
    machinenativeops.io/description: '{{ .app }} version {{ .version }} in {{ .environment
      }}'
    machinenativeops.io/app-version: '{{ .version }}'
    machinenativeops.io/owner: '{{ .owner_email }}'
    machinenativeops.io/deployment-strategy: '{{ .strategy | default "rolling" }}'
    machinenativeops.io/traffic-split: '{{ .traffic_split | default "100" }}'
    machinenativeops.io/predecessor-version: '{{ .predecessor | default "none" }}'
    machinenativeops.io/created-by: canonical-namespace-template
  labels:
    machinenativeops.io/environment: '{{ .environment }}'
    machinenativeops.io/tenant: '{{ .tenant | default "platform-team" }}'
    machinenativeops.io/app: '{{ .app }}'
    machinenativeops.io/version: '{{ .version }}'
    machinenativeops.io/name: '{{ .app }}'
    machinenativeops.io/managed-by: '{{ .managed_by | default "argocd" }}'
    machinenativeops.io/deployment-strategy: '{{ .strategy | default "rolling" }}'
spec: {}
---
apiVersion: machinenativeops.io/v2
kind: ResourceQuota
metadata:
  name: namespace-quota
  namespace: machinenativenops
  annotations:
    machinenativeops.io/description: Resource quota for {{ .namespace_name }}
spec:
  hard:
    requests.cpu: '{{ .quota.cpu_requests | default "10" }}'
    requests.memory: '{{ .quota.memory_requests | default "20Gi" }}'
    limits.cpu: '{{ .quota.cpu_limits | default "20" }}'
    limits.memory: '{{ .quota.memory_limits | default "40Gi" }}'
    persistentvolumeclaims: '{{ .quota.pvc_count | default "10" }}'
    pods: '{{ .quota.pod_count | default "50" }}'
    services: '{{ .quota.service_count | default "20" }}'
    configmaps: '{{ .quota.configmap_count | default "20" }}'
    secrets: '{{ .quota.secret_count | default "20" }}'
---
apiVersion: machinenativeops.io/v2
kind: LimitRange
metadata:
  name: namespace-limits
  namespace: machinenativenops
  annotations:
    machinenativeops.io/description: Resource limits for {{ .namespace_name }}
spec:
  limits:
  - type: Pod
    max:
      cpu: '{{ .limits.pod_max_cpu | default "4" }}'
      memory: '{{ .limits.pod_max_memory | default "8Gi" }}'
    min:
      cpu: '{{ .limits.pod_min_cpu | default "10m" }}'
      memory: '{{ .limits.pod_min_memory | default "64Mi" }}'
  - type: Container
    default:
      cpu: '{{ .limits.container_default_cpu | default "500m" }}'
      memory: '{{ .limits.container_default_memory | default "512Mi" }}'
    defaultRequest:
      cpu: '{{ .limits.container_default_request_cpu | default "100m" }}'
      memory: '{{ .limits.container_default_request_memory | default "128Mi" }}'
    max:
      cpu: '{{ .limits.container_max_cpu | default "2" }}'
      memory: '{{ .limits.container_max_memory | default "4Gi" }}'
    min:
      cpu: '{{ .limits.container_min_cpu | default "10m" }}'
      memory: '{{ .limits.container_min_memory | default "64Mi" }}'
---
apiVersion: machinenativeops.io/v2
kind: NetworkPolicy
metadata:
  name: default-deny-ingress
  namespace: machinenativenops
  annotations:
    machinenativeops.io/description: Default deny ingress policy for {{ .namespace_name
      }}
spec:
  podSelector: {}
  policyTypes:
  - Ingress
--- null
...
