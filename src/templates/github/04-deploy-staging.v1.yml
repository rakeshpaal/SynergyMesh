name: 04-deploy-staging
true:
  push:
    branches:
    - staging
  workflow_dispatch:
    inputs:
      ref:
        default: staging
        description: Git ref to deploy
        required: false
jobs:
  deploy:
    environment:
      name: staging
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        ref: ${{ github.event.inputs.ref || github.ref }}
    - name: Install dependencies
      run: npm install
    - name: Build verification
      run: npm run build --workspaces --if-present
    - env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        ISLAND_ENV: staging
      name: Deploy to staging
      run: ./deploy.sh staging
