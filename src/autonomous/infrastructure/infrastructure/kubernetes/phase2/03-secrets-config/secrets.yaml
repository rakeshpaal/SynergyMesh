# ============================================================================
# 密鑰管理 (使用 External Secrets Operator)
# ============================================================================

apiVersion: v1
kind: Secret
metadata:
  name: autofix-secrets
  namespace: autofix
  labels:
    app: autofix
type: Opaque
stringData:
  # 數據庫
  DATABASE_USER: "autofix_user"
  DATABASE_PASSWORD: "CHANGE_ME"
  
  # Redis
  REDIS_PASSWORD: "CHANGE_ME"
  
  # GitHub
  GITHUB_TOKEN: "${GITHUB_TOKEN}"
  GITHUB_APP_ID: "${GITHUB_APP_ID}"
  GITHUB_APP_PRIVATE_KEY: "${GITHUB_APP_PRIVATE_KEY}"
  
  # 第三方服務
  SLACK_WEBHOOK_URL: "${SLACK_WEBHOOK_URL}"
  SLACK_BOT_TOKEN: "${SLACK_BOT_TOKEN}"
  SNYK_TOKEN: "${SNYK_TOKEN}"
  SONARQUBE_TOKEN: "${SONARQUBE_TOKEN}"
  
  # 加密
  ENCRYPTION_KEY: "CHANGE_ME"
  JWT_SECRET: "CHANGE_ME"
  
  # AWS
  AWS_ACCESS_KEY_ID: "${AWS_ACCESS_KEY_ID}"
  AWS_SECRET_ACCESS_KEY: "${AWS_SECRET_ACCESS_KEY}"
  AWS_REGION: "us-east-1"
  S3_BUCKET: "autofix-backups"
  
  # 郵件
  SMTP_SERVER: "${SMTP_SERVER}"
  SMTP_PORT: "587"
  SMTP_USER: "${SMTP_USER}"
  SMTP_PASSWORD: "${SMTP_PASSWORD}"
  
  # Vault
  VAULT_ADDR: "https://vaultconfig/autofix.svc.cluster.local:8200"
  VAULT_TOKEN: "${VAULT_TOKEN}"

---
# TLS 證書
apiVersion: v1
kind: Secret
metadata:
  name: autofix-tls
  namespace: autofix
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCi4uLgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCi4uLgotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0t

---
# Docker Registry
apiVersion: v1
kind: Secret
metadata:
  name: autofix-registry
  namespace: autofix
type: kubernetes.io/dockerconfigjson
data:
  # IMPORTANT:
  #   This value MUST be overridden with a base64-encoded Docker config JSON
  #   (e.g. contents of ~/.docker/config.json) that includes registry auth.
  #   Leaving this placeholder as-is will cause image pulls to fail.
  #
  # Example (Linux/macOS):
  #   cat ~/.docker/config.json | base64 -w0
  #
  # NOTE: Many CI/CD systems or external secret managers are expected to
  #       inject the real value here at deploy time.
  #       Use tools like envsubst, kustomize, or Helm to substitute this value.
  .dockerconfigjson: "CHANGE_ME"
