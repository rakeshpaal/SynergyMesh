api:
  base_path: /api/v1/self-healing
  endpoints:
  - description: Trigger recovery operation
    method: POST
    path: /recover
    request_body: health_status + recovery_policy
    response: recovery_result
  - description: Get component recovery status
    method: GET
    path: /status/{component_id}
    response: component recovery history
  - description: List available recovery policies
    method: GET
    path: /policies
    response: array of recovery policies
behavior:
  invariants:
  - Recovery must complete within configured timeout
  - All recovery attempts must be logged with audit trail
  - Must not perform destructive actions without explicit approval
  - Must respect rate limiting (max 10 recoveries per minute per component)
  - Must emit metrics for all recovery operations
  performance:
  - 'Average recovery time: < 60 seconds'
  - 'P95 recovery time: < 120 seconds'
  - 'Max recovery time: 300 seconds'
  - 'Throughput: > 100 recoveries per minute (system-wide)'
  reliability:
  - 'Recovery success rate: > 90%'
  - 'False positive rate: < 10%'
  - 'Availability: 99.9%'
  side_effects:
  - May restart services or containers
  - May scale resources (up or down)
  - May trigger failover to backup instances
  - May send notifications to monitoring systems
  - May update health status in registry
contract:
  created_at: '2025-12-11'
  id: contract.self-healing.v1
  name: Self-Healing Module Contract
  owner: self-healing-team@machinenativeops.io
  status: active
  updated_at: '2025-12-11'
  version: 1.0.0
dependencies:
  optional:
  - contract_id: contract.notification.v1
    description: Optional notification service integration
    version: ^1.0.0
  required:
  - contract_id: contract.monitoring.v1
    description: Requires monitoring service for health data
    version: ^1.0.0
  - contract_id: contract.automation.v1
    description: Requires automation engine for executing recovery
    version: ^1.0.0
  - contract_id: contract.audit.v1
    description: Requires audit system for logging
    version: ^1.0.0
interface:
  errors:
  - code: SH001
    description: Recovery attempt failed
    http_status: 500
    name: RecoveryFailure
    retry_allowed: true
  - code: SH002
    description: Invalid recovery policy provided
    http_status: 400
    name: InvalidPolicy
    retry_allowed: false
  - code: SH003
    description: Maximum recovery attempts exceeded
    http_status: 429
    name: MaxAttemptsExceeded
    retry_allowed: false
  - code: SH004
    description: Recovery operation timed out
    http_status: 504
    name: TimeoutExceeded
    retry_allowed: true
  inputs:
    health_status:
      description: Component health status information
      required: true
      schema:
        properties:
          component_id:
            description: Unique component identifier
            type: string
          metrics:
            description: Health metrics
            properties:
              cpu_usage:
                maximum: 100
                minimum: 0
                type: number
              error_rate:
                minimum: 0
                type: number
              latency_ms:
                minimum: 0
                type: number
              memory_usage:
                maximum: 100
                minimum: 0
                type: number
            type: object
          status:
            description: Current health status
            enum:
            - healthy
            - degraded
            - failed
            type: string
          timestamp:
            description: Status timestamp
            format: date-time
            type: string
        required:
        - component_id
        - status
        - timestamp
        type: object
      type: object
    recovery_policy:
      description: Recovery policy configuration
      required: false
      schema:
        properties:
          max_attempts:
            default: 3
            maximum: 5
            minimum: 1
            type: integer
          notify:
            default: true
            type: boolean
          strategy:
            default: restart
            enum:
            - restart
            - failover
            - scale
            - rollback
            - custom
            type: string
          timeout_seconds:
            default: 60
            maximum: 300
            minimum: 30
            type: integer
        type: object
      type: object
  module_id: 40-self-healing
  module_path: governance/40-self-healing
  outputs:
    recovery_result:
      description: Recovery operation result
      schema:
        properties:
          actions_taken:
            items:
              properties:
                action:
                  type: string
                result:
                  type: string
                timestamp:
                  format: date-time
                  type: string
              type: object
            type: array
          message:
            description: Human-readable result message
            type: string
          new_status:
            enum:
            - healthy
            - degraded
            - failed
            type: string
          recovery_time:
            description: Time taken for recovery in seconds
            type: number
          success:
            description: Whether recovery succeeded
            type: boolean
        required:
        - success
        - actions_taken
        - recovery_time
        type: object
      type: object
metadata:
  documentation_url: https://docs.machinenativeops.io/contracts/self-healing
  sla:
    availability: 99.9
    response_time_p95_ms: 100
    support_hours: 24/7
  support_contact: self-healing-team@machinenativeops.io
  tags:
  - self-healing
  - recovery
  - automation
  - resilience
testing:
  contract_tests:
    consumer_tests_required: true
    framework: pact
    provider_tests_required: true
  integration_tests:
    required: true
    test_scenarios:
    - end_to_end_recovery
    - dependency_integration
    - error_handling
  unit_tests:
    coverage_requirement: 80
    required_scenarios:
    - successful_recovery
    - failed_recovery
    - timeout_scenario
    - max_attempts_exceeded
versioning:
  backward_compatible_with: []
  changelog:
  - changes:
    - Initial contract definition
    date: '2025-12-11'
    version: 1.0.0
  current_version: 1.0.0
  forward_compatible: false
