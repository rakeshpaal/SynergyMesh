apiVersion: machinenativeops.io/v2
kind: PrometheusRule
metadata:
  name: ai-predictive-governance
  namespace: machinenativenops
spec:
  groups:
  - interval: 10s
    name: ai_predictions
    rules:
    - alert: PredictedResourceExhaustion
      annotations:
        action: AUTO_SCALE
        summary: AI predicts resource exhaustion in 1 hour
      expr: predict_linear(governance_resources_total[1h], 3600) > 1000
      for: 0s
      labels:
        ai_generated: 'true'
        severity: warning
    - alert: PredictedComplianceDrift
      annotations:
        action: AUTO_REMEDIATE
        summary: AI detects increasing compliance violations
      expr: rate(governance_policy_violations_total[5m]) > 0.1
      for: 0s
      labels:
        ai_generated: 'true'
        severity: critical
