apiVersion: machinenativeops.io/v2
kind: CustomResourceDefinition
metadata:
  annotations:
    machinenativeops.io/description: Risk Register CRD for governance risk management
    machinenativeops.io/category: strategic
    machinenativeops.io/layer: execution
  labels:
    machinenativeops.io/app: governance-framework
    machinenativeops.io/component: risk-management
    machinenativeops.io/version: v1
  name: riskregisters.governance.machinenativeops.io
spec:
  conversion:
    strategy: None
  group: governance.machinenativeops.io
  names:
    kind: RiskRegister
    plural: riskregisters
    shortNames:
    - risk
    - rr
    singular: riskregister
  preserveUnknownFields: false
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Risk level
      jsonPath: .spec.riskLevel
      name: Risk Level
      type: string
    - description: Risk category
      jsonPath: .spec.category
      name: Category
      type: string
    - description: Risk owner
      jsonPath: .spec.owner
      name: Owner
      type: string
    - description: Risk score
      jsonPath: .spec.riskScore
      name: Score
      type: number
    - description: Mitigation status
      jsonPath: .spec.mitigationStatus
      name: Status
      type: string
    - description: Days since identification
      format: date-time
      jsonPath: .metadata.creationTimestamp
      name: Age
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              businessImpact:
                properties:
                  financial:
                    description: Estimated financial impact in USD
                    example: 1000000
                    type: number
                  legal:
                    description: Legal/regulatory impact level
                    enum:
                    - none
                    - low
                    - medium
                    - high
                    - critical
                    example: medium
                    type: string
                  operational:
                    description: Operational impact level
                    enum:
                    - none
                    - minor
                    - moderate
                    - significant
                    - severe
                    example: significant
                    type: string
                  reputational:
                    description: Reputational impact level
                    enum:
                    - none
                    - low
                    - medium
                    - high
                    - critical
                    example: high
                    type: string
                type: object
              category:
                description: Risk category classification
                enum:
                - strategic
                - operational
                - financial
                - security
                - compliance
                - reputational
                - environmental
                example: security
                type: string
              complianceFrameworks:
                description: Relevant compliance frameworks
                example:
                - GDPR
                - ISO-27001
                items:
                  enum:
                  - SOX
                  - ISO-27001
                  - GDPR
                  - HIPAA
                  - PCI-DSS
                  - NIST
                  - SOC2
                  type: string
                type: array
              department:
                description: Department responsible for the risk
                example: IT Security
                maxLength: 100
                type: string
              description:
                description: Detailed risk description
                example: Potential unauthorized access to sensitive customer data
                  due to inadequate security controls
                maxLength: 2000
                type: string
              identifiedDate:
                description: Date when risk was identified
                example: '2025-01-15'
                format: date
                type: string
              impact:
                description: Impact level (0 to 10)
                example: 8.5
                format: float
                maximum: 10
                minimum: 0
                type: number
              mitigationCost:
                description: Estimated cost of mitigation in USD
                example: 50000
                minimum: 0
                type: number
              mitigationStatus:
                description: Status of mitigation efforts
                enum:
                - not_started
                - in_progress
                - completed
                - monitored
                example: in_progress
                type: string
              mitigationStrategy:
                description: Strategy to mitigate the risk
                example: Implement multi-factor authentication and regular security
                  audits
                maxLength: 1000
                type: string
              monitoring:
                properties:
                  alerts:
                    description: Alert conditions
                    example:
                    - failed_login_attempts > 100
                    - security_incidents > 0
                    items:
                      type: string
                    type: array
                  frequency:
                    description: Monitoring frequency
                    enum:
                    - daily
                    - weekly
                    - monthly
                    - quarterly
                    - annually
                    example: monthly
                    type: string
                  metrics:
                    description: Key risk indicators
                    example:
                    - failed_login_attempts
                    - security_incidents
                    items:
                      type: string
                    type: array
                type: object
              owner:
                description: Risk owner responsible for mitigation
                example: security-team
                maxLength: 100
                type: string
              probability:
                description: Probability of occurrence (0.0 to 1.0)
                example: 0.3
                format: float
                maximum: 1
                minimum: 0
                type: number
              relatedRisks:
                description: List of related risk IDs
                example:
                - RISK-2025-002
                - RISK-2025-003
                items:
                  type: string
                type: array
              residualRisk:
                description: Residual risk after mitigation
                example: 1.5
                format: float
                maximum: 10
                minimum: 0
                type: number
              reviewDate:
                description: Next review date
                example: '2025-04-15'
                format: date
                type: string
              riskId:
                description: Unique risk identifier in format RISK-YYYY-NNN
                example: RISK-2025-001
                pattern: ^RISK-[0-9]{4}-[0-9]{3}$
                type: string
              riskLevel:
                description: Calculated risk level based on probability and impact
                enum:
                - critical
                - high
                - medium
                - low
                example: high
                type: string
              riskScore:
                description: Calculated risk score (probability * impact)
                example: 2.55
                format: float
                maximum: 10
                minimum: 0
                type: number
              subcategory:
                description: More specific risk subcategory
                example: cybersecurity
                maxLength: 100
                type: string
              tags:
                description: Risk tags for categorization
                example:
                - cybersecurity
                - data-protection
                - compliance
                items:
                  type: string
                type: array
              title:
                description: Risk title or summary
                example: Data breach in customer database
                maxLength: 200
                type: string
            required:
            - riskId
            - category
            - probability
            - impact
            - riskLevel
            type: object
          status:
            properties:
              conditions:
                items:
                  properties:
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      type: string
                    reason:
                      type: string
                    status:
                      enum:
                      - true
                      - false
                      type: string
                    type:
                      enum:
                      - mitigation_required
                      - review_overdue
                      - high_risk
                      - compliance_issue
                      type: string
                  type: object
                type: array
              lastUpdated:
                description: Last status update timestamp
                example: '2025-01-15T10:30:00Z'
                format: date-time
                type: string
              metrics:
                properties:
                  averageRiskScore:
                    description: Average risk score
                    format: float
                    type: number
                  criticalRisks:
                    description: Number of critical risks
                    type: integer
                  highRisks:
                    description: Number of high risks
                    type: integer
                  mitigatedRisks:
                    description: Number of mitigated risks
                    type: integer
                  totalRisks:
                    description: Total number of risks in this category
                    type: integer
                type: object
              phase:
                description: Current risk lifecycle phase
                enum:
                - identified
                - assessed
                - mitigated
                - accepted
                - transferred
                - avoided
                example: mitigated
                type: string
              updatedBy:
                description: User who last updated the risk
                example: risk-manager
                type: string
            type: object
        type: object
    served: true
    storage: true
