$schema: https://schema.machinenativeops.io/audit-format/v1
actionTypes:
  autofix:
  - autofix.triggered
  - autofix.completed
  - autofix.failed
  - autofix.pr_created
  index:
  - index.scanned
  - index.generated
  - index.updated
  - index.validated
  policy:
  - policy.evaluated
  - policy.passed
  - policy.denied
  - policy.exception
  supplyChain:
  - sbom.generated
  - sbom.validated
  - provenance.generated
  - provenance.injected
  - signature.created
  - signature.verified
  - signature.failed
  system:
  - pipeline.started
  - pipeline.completed
  - pipeline.failed
  - config.changed
  - secret.accessed
  validation:
  - validation.started
  - validation.passed
  - validation.failed
  - validation.skipped
eventSchema:
  optional:
  - repository
  - commit
  - workflow
  - runId
  - details
  - integrity
  - previousHash
  required:
  - eventId
  - timestamp
  - action
  - subject
  - actor
examples:
  autofixTriggered:
    action: autofix.triggered
    actor: platform-governance
    details:
      branch: autofix/fix-policy-schema
      error: 'Missing required field: version'
      trigger: schema_validation_failed
    eventId: 660e8400-e29b-41d4-a716-446655440001
    integrity:
      algorithm: sha256
      value: b2c3d4e5f6g7...
    previousHash: a1b2c3d4e5f6...
    subject: governance/23-policies/base-policy.yaml
    timestamp: '2025-11-30T09:05:00.000Z'
  validationPassed:
    action: validation.passed
    actor: github-actions[bot]
    commit: abc123def456
    details:
      duration_ms: 1234
      items_validated: 30
      stage: schema
    eventId: 550e8400-e29b-41d4-a716-446655440000
    integrity:
      algorithm: sha256
      value: a1b2c3d4e5f6...
    repository: Unmanned-Island-admin/SynergyMesh
    runId: '12345678'
    subject: docs/knowledge_index.yaml
    timestamp: '2025-11-30T09:00:00.000Z'
    workflow: Governance Pipeline
integrity:
  algorithm: sha256
  chainedEvents: true
  hashFields:
  - eventId
  - timestamp
  - action
  - subject
  - actor
  - details
  verification:
    alertOnTampering: true
    allowGaps: false
    checkPreviousHash: true
metadata:
  created: '2025-11-30'
  description: 審計事件格式定義，支援不可變日誌與完整性鏈
  name: audit-format
  owner: platform-governance
output:
  backup:
    enabled: true
    frequency: daily
    retention: 1y
  primary:
    encoding: utf-8
    format: jsonl
    path: governance/audit/events.jsonl
  rotation:
    archivePath: governance/audit/archive/
    compress: true
    maxAge: 90d
    maxSize: 10MB
version: 1.0.0
