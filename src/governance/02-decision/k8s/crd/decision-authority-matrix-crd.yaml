apiVersion: machinenativeops.io/v2
kind: CustomResourceDefinition
metadata:
  annotations:
    machinenativeops.io/description: Decision Authority Matrix CRD for governance
      decision management
    machinenativeops.io/category: decision
    machinenativeops.io/layer: execution
  labels:
    machinenativeops.io/app: governance-framework
    machinenativeops.io/component: decision-management
    machinenativeops.io/version: v1
  name: decisionauthoritymatrices.governance.machinenativeops.io
spec:
  conversion:
    strategy: None
  group: governance.machinenativeops.io
  names:
    kind: DecisionAuthorityMatrix
    plural: decisionauthoritymatrices
    shortNames:
    - dam
    - decision-matrix
    singular: decisionauthoritymatrix
  preserveUnknownFields: false
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Matrix title
      jsonPath: .spec.title
      name: Title
      type: string
    - description: Matrix version
      jsonPath: .spec.version
      name: Version
      type: string
    - description: Current status
      jsonPath: .status.phase
      name: Status
      type: string
    - description: Effective date
      jsonPath: .spec.effectiveDate
      name: Effective Date
      type: string
    - description: Total decisions processed
      jsonPath: .status.statistics.totalDecisions
      name: Total Decisions
      type: integer
    name: v1
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              compliance:
                properties:
                  auditRequirements:
                    description: Audit requirements
                    example:
                    - all_decisions_logged
                    - approval_trail_maintained
                    - retention_period_7_years
                    - immutable_audit_trail
                    items:
                      type: string
                    type: array
                  frameworks:
                    description: Compliance frameworks
                    example:
                    - SOX
                    - ISO-37001
                    - GDPR
                    items:
                      enum:
                      - SOX
                      - ISO-37001
                      - GDPR
                      - HIPAA
                      - PCI-DSS
                      - NIST
                      - SOC2
                      type: string
                    type: array
                  reporting:
                    properties:
                      format:
                        description: Report format
                        enum:
                        - PDF
                        - Excel
                        - JSON
                        - XML
                        example: PDF
                        type: string
                      frequency:
                        description: Reporting frequency
                        enum:
                        - daily
                        - weekly
                        - monthly
                        - quarterly
                        - annually
                        example: monthly
                        type: string
                      recipients:
                        description: Report recipients
                        example:
                        - audit_committee
                        - compliance_officer
                        items:
                          type: string
                        type: array
                    type: object
                type: object
              decisionCategories:
                items:
                  properties:
                    category:
                      description: Decision category
                      example: financial
                      maxLength: 100
                      type: string
                    complianceFrameworks:
                      description: Relevant compliance frameworks
                      example:
                      - SOX
                      - GDPR
                      items:
                        enum:
                        - SOX
                        - ISO-27001
                        - GDPR
                        - HIPAA
                        - PCI-DSS
                        - NIST
                        - SOC2
                        type: string
                      type: array
                    defaultLevel:
                      description: Default decision level for this category
                      example: L2-Tactical
                      pattern: ^L[1-9]-[A-Za-z]+$
                      type: string
                    description:
                      description: Category description
                      example: 財務相關決策
                      maxLength: 500
                      type: string
                    riskLevel:
                      description: Typical risk level for this category
                      enum:
                      - low
                      - medium
                      - high
                      - critical
                      example: medium
                      type: string
                    specialRules:
                      items:
                        properties:
                          additionalApprovers:
                            description: Additional approvers required
                            example:
                            - CFO
                            - Board
                            items:
                              type: string
                            type: array
                          condition:
                            description: Condition for special rule
                            example: capital_expenditure > $500,000
                            maxLength: 200
                            type: string
                          enhancedDocumentation:
                            description: Whether enhanced documentation is required
                            example: true
                            type: boolean
                          requiredLevel:
                            description: Required level when condition is met
                            example: L3-Strategic
                            pattern: ^L[1-9]-[A-Za-z]+$
                            type: string
                        type: object
                      type: array
                  required:
                  - category
                  - defaultLevel
                  type: object
                minItems: 1
                type: array
              decisionLevels:
                items:
                  properties:
                    approvalRequired:
                      description: Whether approval is required
                      example: false
                      type: boolean
                    approvers:
                      description: List of approvers if approval required
                      example:
                      - Operations Director
                      - Finance Manager
                      items:
                        type: string
                      type: array
                    authority:
                      description: Authority role or title
                      example: Team Lead
                      maxLength: 100
                      type: string
                    delegationAllowed:
                      description: Whether delegation is allowed
                      example: true
                      type: boolean
                    documentationRequired:
                      description: Whether documentation is required
                      example: false
                      type: boolean
                    escalationThreshold:
                      description: Threshold for escalation to next level
                      example: impact > $10,000
                      maxLength: 200
                      type: string
                    level:
                      description: Decision level identifier
                      example: L1-Operational
                      pattern: ^L[1-9]-[A-Za-z]+$
                      type: string
                    reviewFrequency:
                      description: Review frequency for decisions at this level
                      enum:
                      - none
                      - monthly
                      - quarterly
                      - semi-annually
                      - annually
                      example: none
                      type: string
                    scope:
                      description: Scope of decisions at this level
                      example: 日常運營決策
                      maxLength: 500
                      type: string
                    timeLimit:
                      description: Time limit for decision making
                      example: 24 hours
                      maxLength: 50
                      type: string
                  required:
                  - level
                  - authority
                  - scope
                  type: object
                minItems: 1
                type: array
              description:
                description: Matrix description
                example: Defines decision authority levels and approval workflows
                maxLength: 2000
                type: string
              effectiveDate:
                description: Effective date of this matrix version
                example: '2025-01-01'
                format: date
                type: string
              expiryDate:
                description: Expiry date of this matrix version
                example: '2026-12-31'
                format: date
                type: string
              integrationPoints:
                properties:
                  externalSystems:
                    items:
                      properties:
                        authentication:
                          description: Authentication method
                          enum:
                          - OAuth2
                          - API_Key
                          - Basic_Auth
                          - Certificate
                          - Service_Account
                          example: OAuth2
                          type: string
                        endpoint:
                          description: System endpoint
                          example: https://erp.company.com/api
                          type: string
                        interface:
                          description: Interface type
                          enum:
                          - REST_API
                          - SOAP_API
                          - gRPC
                          - Message_Queue
                          - File_Transfer
                          - Database
                          example: SOAP API
                          type: string
                        name:
                          description: External system name
                          example: ERP System
                          type: string
                        purpose:
                          description: Integration purpose
                          example: Financial data validation
                          type: string
                      type: object
                    type: array
                  governanceFramework:
                    description: Governance framework integration points
                    example:
                    - policy-engine
                    - risk-management
                    - compliance-monitoring
                    items:
                      type: string
                    type: array
                type: object
              matrixId:
                description: Unique matrix identifier
                example: MATRIX-2025-001
                pattern: ^MATRIX-[0-9]{4}-[0-9]{3}$
                type: string
              monitoring:
                properties:
                  alerts:
                    items:
                      properties:
                        action:
                          description: Action to take
                          example: notify_governance_team
                          type: string
                        condition:
                          description: Alert condition
                          example: decision_processing_time > 48 hours
                          type: string
                        escalation:
                          description: Escalation path
                          example: notify_governance_committee
                          type: string
                        severity:
                          description: Alert severity
                          enum:
                          - info
                          - warning
                          - error
                          - critical
                          example: high
                          type: string
                      type: object
                    type: array
                  metrics:
                    items:
                      properties:
                        description:
                          description: Metric description
                          example: Time taken to process decisions
                          type: string
                        name:
                          description: Metric name
                          example: decision_processing_time
                          type: string
                        threshold:
                          description: Alert threshold
                          example: < 24 hours
                          type: string
                        type:
                          description: Metric type
                          enum:
                          - counter
                          - gauge
                          - histogram
                          - summary
                          example: histogram
                          type: string
                      type: object
                    type: array
                type: object
              title:
                description: Matrix title
                example: Enterprise Decision Authority Matrix
                maxLength: 200
                type: string
              version:
                description: Matrix version
                example: 1.0.0
                pattern: ^[0-9]+\.[0-9]+\.[0-9]+$
                type: string
              workflowRules:
                properties:
                  automation:
                    properties:
                      autoApprove:
                        items:
                          properties:
                            condition:
                              description: Condition for auto-approval
                              example: risk_level = low AND impact < $1,000
                              type: string
                            level:
                              description: Decision level for auto-approval
                              example: L1-Operational
                              pattern: ^L[1-9]-[A-Za-z]+$
                              type: string
                          type: object
                        type: array
                      autoEscalate:
                        items:
                          properties:
                            condition:
                              description: Condition for auto-escalation
                              example: risk_level = critical
                              type: string
                            reason:
                              description: Reason for escalation
                              example: Critical risk detected
                              type: string
                            toLevel:
                              description: Level to escalate to
                              example: L4-Governance
                              pattern: ^L[1-9]-[A-Za-z]+$
                              type: string
                          type: object
                        type: array
                    type: object
                  notifications:
                    items:
                      properties:
                        channels:
                          description: Notification channels
                          example:
                          - email
                          - portal
                          items:
                            enum:
                            - email
                            - slack
                            - teams
                            - sms
                            - portal
                            type: string
                          type: array
                        recipients:
                          description: Notification recipients
                          example:
                          - requester
                          - authority
                          items:
                            type: string
                          type: array
                        template:
                          description: Notification template
                          example: decision-submitted-template
                          type: string
                        trigger:
                          description: Notification trigger
                          enum:
                          - decision_submitted
                          - approval_required
                          - decision_approved
                          - decision_rejected
                          - escalation_triggered
                          - timeout_warning
                          example: decision_submitted
                          type: string
                      type: object
                    type: array
                  validation:
                    items:
                      properties:
                        check:
                          description: Validation check type
                          enum:
                          - authority_level
                          - risk_assessment
                          - stakeholder_impact
                          - compliance_check
                          - budget_availability
                          - resource_capacity
                          example: authority_level
                          type: string
                        errorMessage:
                          description: Error message if check fails
                          example: Authority level validation failed
                          type: string
                        required:
                          description: Whether this check is required
                          example: true
                          type: boolean
                      type: object
                    type: array
                type: object
            required:
            - matrixId
            - decisionLevels
            - decisionCategories
            type: object
          status:
            properties:
              conditions:
                items:
                  properties:
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      type: string
                    reason:
                      type: string
                    status:
                      enum:
                      - true
                      - false
                      type: string
                    type:
                      enum:
                      - compliance_issue
                      - performance_degradation
                      - integration_failure
                      - security_violation
                      type: string
                  type: object
                type: array
              lastUpdated:
                description: Last status update timestamp
                example: '2025-01-15T10:30:00Z'
                format: date-time
                type: string
              phase:
                description: Current matrix phase
                enum:
                - draft
                - active
                - deprecated
                - superseded
                example: active
                type: string
              statistics:
                properties:
                  approvalRate:
                    description: Approval rate percentage
                    example: 94.5
                    maximum: 100
                    minimum: 0
                    type: number
                  averageProcessingTime:
                    description: Average processing time
                    example: 18 hours
                    type: string
                  escalationRate:
                    description: Escalation rate percentage
                    example: 3.2
                    maximum: 100
                    minimum: 0
                    type: number
                  totalDecisions:
                    description: Total decisions processed
                    example: 1250
                    minimum: 0
                    type: integer
                type: object
              updatedBy:
                description: User who last updated the matrix
                example: governance-admin
                type: string
              version:
                description: Current version
                example: 1.0.0
                type: string
            type: object
        type: object
    served: true
    storage: true
