apiVersion: machinenativeops.io/v2
kind: Policy
metadata:
  category: compliance-attestation
  description: 合規框架標準與控制要求 / Compliance framework standards and control requirements
  enforcement: mandatory
  name: compliance-standards
  priority: 800
  version: v1.0.0
spec:
  attestation_generation:
    enabled: true
    frequency: every-6-hours
    providers:
    - cosign
    - in-toto
    - slsa-provenance
    storage: s3://compliance-evidence-bucket/attestations/
  evidence_collection:
    access_reviews: quarterly
    audit_logs_retention_days: 2555
    configuration_snapshots: hourly
    encryption: AES-256-GCM
    immutable_storage: true
    security_scans: daily
    storage_location: s3://compliance-evidence-bucket/
  policy_as_code_integration:
    audit_mode: true
    enabled: true
    engines:
    - name: OPA Gatekeeper
      policies: governance/01-architecture/policies/conftest/
      version: v3.14.0
    - name: Kyverno
      policies: infrastructure/kubernetes/kyverno-policies/
      version: v1.11.0
    validation_mode: enforce
  references:
  - description: SOC 2 Trust Services Criteria
    url: https://www.aicpa.org/soc2
  - description: GDPR Official Text
    url: https://gdpr-info.eu/
  - description: PCI DSS v4.0
    url: https://www.pcisecuritystandards.org/
  - description: ISO/IEC 27001:2022
    url: https://www.iso.org/standard/27001
  related_policies:
  - audit-policy
  - rbac-role-matrix
  - pod-security-standards
  - network-segmentation-policy
  reporting:
    automated_reports:
    - frequency: monthly
      recipients:
      - compliance-team@example.com
      type: SOC2
    - frequency: quarterly
      recipients:
      - dpo@example.com
      - legal@example.com
      type: GDPR
    - frequency: quarterly
      recipients:
      - security-team@example.com
      type: PCI-DSS
    compliance_dashboard: true
    dashboard_url: https://compliance.example.com/dashboard
  supported_frameworks:
    gdpr:
      breach_notification:
        authority_notification_hours: 72
        data_subject_notification_required: true
        documentation_required: true
        incident_severity_assessment: true
        notification_template: gdpr-breach-notification.yaml
      data_protection_officer:
        contact: dpo@example.com
        required: true
        responsibilities:
        - Monitor GDPR compliance
        - Conduct DPIAs
        - Cooperate with supervisory authorities
      description: General Data Protection Regulation
      enabled: true
      principles:
        data_minimization:
          controls:
          - PII identification and classification
          - Data retention policies enforced
          - Automated data purging after retention period
          - Data inventory maintained
          description: 僅收集必要資料 / Collect only necessary data
          validation:
            classification_labels: true
            data_discovery_tool: automated-pii-scanner
            retention_automation: true
        data_subject_rights:
          controls:
          - Right to access automated process
          - Right to erasure implemented
          - Data portability enabled
          - Right to rectification process
          description: 資料主體權利 / Data subject rights
          validation:
            deletion_verification: true
            response_time_sla: 30-days
            self_service_portal: true
        purpose_limitation:
          controls:
          - Consent management system implemented
          - Purpose tags on all data stores
          - Access control based on purpose
          - Audit trail for data usage
          description: 資料使用限於宣告目的 / Data used only for stated purposes
          validation:
            consent_records: true
            purpose_based_access: true
      version: 2018/679
    hipaa:
      enabled: false
      future_consideration: true
      reason: Healthcare data not processed
    iso27001:
      annex_a_controls:
        a12_operations_security:
        - 'A.12.1: Operational procedures'
        - 'A.12.4: Logging and monitoring'
        - 'A.12.6: Technical vulnerability management'
        a5_organizational:
        - 'A.5.1: Information security policies'
        - 'A.5.8: Information security in project management'
        a8_asset_management:
        - 'A.8.1: Responsibility for assets'
        - 'A.8.2: Information classification'
        - 'A.8.3: Media handling'
      certification_body: ISO Accredited Certifier
      description: Information Security Management System
      enabled: true
      isms_scope: All Kubernetes clusters and workloads
      surveillance_audit_frequency: annual
      version: '2022'
    pci_dss:
      annual_assessment: true
      description: Payment Card Industry Data Security Standard
      enabled: true
      penetration_testing_frequency: annual
      qsa_required: true
      quarterly_scan: true
      requirements:
        requirement_1:
          name: 安裝與維護網路安全控制 / Install and Maintain Network Security Controls
          sub_requirements:
          - controls:
            - Microsegmentation with NetworkPolicies
            - DMZ zone for cardholder data
            - Firewall rules documented
            description: Network segmentation implemented
            id: 1.2.1
          - controls:
            - Default deny all policy
            - Explicit allow rules only
            - Traffic monitoring enabled
            description: Ingress/egress traffic restrictions
            id: 1.3.1
        requirement_10:
          name: 記錄並監控所有存取 / Log and Monitor All Access
          sub_requirements:
          - controls:
            - Kubernetes audit logs enabled
            - Application-level logging
            - Immutable log storage
            description: Audit trail for all access to cardholder data
            id: 10.2.1
        requirement_3:
          name: 保護儲存的帳戶資料 / Protect Stored Account Data
          sub_requirements:
          - controls:
            - AES-256-GCM encryption
            - Key rotation every 90 days
            - Hardware Security Module (HSM) for key storage
            description: Encryption of cardholder data at rest
            id: 3.5.1
          - controls:
            - Key generation documented
            - Key distribution secured
            - Key retirement process
            description: Cryptographic key management
            id: 3.6.1
      version: '4.0'
    soc2_type2:
      audit_requirements:
        annual_assessment: true
        external_auditor_required: true
        penetration_testing: quarterly
        retention_years: 7
        vulnerability_scanning: weekly
      controls:
        cc6_1:
          automation:
            auto_remediation: false
            drift_detection: true
            policy_engine: OPA Gatekeeper
          category: Common Criteria
          evidence_collection:
          - iam-audit-logs
          - access-review-reports
          - mfa-enrollment-status
          - rbac-role-assignments
          name: 邏輯與實體存取控制 / Logical and Physical Access Controls
          requirements:
          - Multi-factor authentication for all privileged access
          - Access review performed quarterly
          - Automated deprovisioning within 24 hours
          - Role-based access control (RBAC) implemented
          - Principle of least privilege enforced
          validation_frequency: daily
        cc7_2:
          automation:
            alerting_system: AlertManager
            incident_tracking: PagerDuty
            monitoring_tool: Prometheus + Grafana
          category: Common Criteria
          evidence_collection:
          - security-event-logs
          - alert-history
          - incident-reports
          - siem-integration-status
          name: 系統監控 / System Monitoring
          requirements:
          - Continuous monitoring of security events
          - Automated alerting for anomalies
          - Incident response plan documented and tested
          - Log retention for at least 90 days
          - SIEM integration for real-time analysis
          validation_frequency: real-time
        cc7_3:
          category: Common Criteria
          evidence_collection:
          - change-management-logs
          - backup-test-reports
          - capacity-metrics
          - patch-compliance-reports
          name: 系統操作 / System Operations
          requirements:
          - Change management process documented
          - Backup and recovery procedures tested quarterly
          - Capacity planning and monitoring
          - Patch management policy enforced
          validation_frequency: weekly
      description: SOC 2 Type II - Service Organization Control 2
      enabled: true
      version: '2017'
  version: v1.0.0
