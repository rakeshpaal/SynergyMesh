apiVersion: machinenativeops.io/v2
kind: Policy
metadata:
  category: namespace-governance
  description: 命名空間命名規範 / Namespace naming convention standards
  enforcement: mandatory
  name: namespace-naming-policy
  priority: 1000
  version: v1.0.0
spec:
  constraints:
    allowed_characters: lowercase alphanumeric and hyphens only
    max_length: 63
    min_length: 3
    must_end_with: alphanumeric character
    must_start_with: lowercase letter
  enforced: true
  exemptions:
  - kube-system
  - kube-public
  - kube-node-lease
  - default
  - istio-system
  - cert-manager
  - monitoring
  - logging
  forbidden_prefixes:
  - kube-
  - kubernetes-
  - system-
  - default-
  patterns:
    development:
      description: 開發環境命名規範 / Development environment naming
      examples:
      - service-a-dev
      - ml-training-development
      regex: ^[a-z][a-z0-9-]*-(dev|development)$
    feature:
      description: 特性分支命名規範 / Feature branch naming
      examples:
      - api-gateway-feature-oauth
      - frontend-feature-darkmode
      regex: ^[a-z][a-z0-9-]*-feature-[a-z0-9-]+$
    production:
      description: 生產環境命名規範 / Production environment naming
      examples:
      - service-a-prod
      - data-pipeline-production
      - api-gateway-prod
      regex: ^[a-z][a-z0-9-]*-(prod|production)$
    staging:
      description: 預備環境命名規範 / Staging environment naming
      examples:
      - service-a-stg
      - data-pipeline-staging
      regex: ^[a-z][a-z0-9-]*-(stg|staging)$
    tenant:
      description: 租戶隔離命名規範 / Tenant isolation naming
      examples:
      - tenant-acme-prod
      - tenant-beta-dev
      regex: ^tenant-[a-z0-9]+-(dev|stg|prod)$
  references:
  - description: Kubernetes Namespace Design Best Practices
    url: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/
  - description: DNS RFC 1123 Naming Convention
    url: https://tools.ietf.org/html/rfc1123
  related_policies:
  - namespace-labels-policy
  - resource-quota-policy
  remediation:
    auto_reject: true
    error_message: Namespace name does not comply with naming policy. Please refer
      to governance/23-policies/namespace-naming-policy.yaml
  validation:
    admission_webhook: true
    failure_policy: Fail
    timeout_seconds: 10
    webhook_endpoint: /validate/namespace/naming
  version: v1.0.0
