apiVersion: machinenativeops.io/v2
kind: DimensionModule
metadata:
  category: execution
  created_at: '2025-12-11T15:30:50Z'
  id: 48-rollback
  name: 回滾治理
  name_en: Rollback Governance
  owner: governance-bot
  tags:
  - rollback
  - revert
  - recovery
  - safety
  updated_at: '2025-12-11T15:30:50Z'
  version: 1.0.0
spec:
  behavior:
    invariants:
    - All operations must be auditable
    - State changes require validation
    - Dependencies must be satisfied
    postconditions:
    - Output conforms to schema
    - Audit log generated
    preconditions:
    - Input must conform to schema
    - Required dependencies available
    side_effects:
    - Generates audit trail
    - May update metrics
  compliance:
    audit_frequency: continuous
    controls: []
    frameworks:
    - ISO-42001
    - NIST-AI-RMF
    - COBIT-2019
  dependencies:
    optional: []
    required:
    - 42-deployment
    - 47-versioning
  description: 回滾策略、狀態恢復與安全回退
  interface:
    errors:
    - code: E48001
      description: Input validation failed
      name: ValidationError
    - code: E48002
      description: Policy check failed
      name: PolicyViolation
    - code: E48003
      description: Required dependency unavailable
      name: DependencyError
    inputs:
    - name: config
      required: true
      schema_ref: '#/definitions/config'
      type: object
    - name: context
      required: false
      schema_ref: '#/definitions/context'
      type: object
    outputs:
    - name: result
      schema_ref: '#/definitions/result'
      type: object
    - name: audit_log
      schema_ref: '#/definitions/audit_log'
      type: object
  lifecycle:
    states:
    - pending
    - initializing
    - active
    - degraded
    - maintenance
    - retiring
    - retired
    transitions:
    - from: pending
      to: initializing
      trigger: initialize
    - from: initializing
      to: active
      trigger: activation_complete
    - from: active
      to: degraded
      trigger: health_check_failed
    - from: degraded
      to: active
      trigger: recovery_complete
    - from: active
      to: maintenance
      trigger: maintenance_start
    - from: maintenance
      to: active
      trigger: maintenance_complete
    - from: active
      to: retiring
      trigger: deprecation_start
    - from: retiring
      to: retired
      trigger: retirement_complete
  metrics:
  - description: Total operations executed
    name: rollback_operations_total
    type: counter
  - description: Operation duration in seconds
    name: rollback_operation_duration_seconds
    type: histogram
  - description: Total errors encountered
    name: rollback_errors_total
    type: counter
  - description: Current health status (0=unhealthy, 1=healthy)
    name: rollback_health_status
    type: gauge
  policy:
    enforcement: required
    engine: opa
    path: ./policy.rego
  schema:
    format: json-schema
    path: ./schema.json
    validation: required
status: active
