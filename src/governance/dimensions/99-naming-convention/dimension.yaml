apiVersion: machinenativeops.io/v2
kind: DimensionModule
metadata:
  category: meta-specification
  created_at: '2025-12-18T00:00:00Z'
  id: 99-naming-convention
  layer: 90-99
  layer_name: Meta-Specification Layer
  name: 統一命名規範治理
  name_en: Unified Naming Convention Governance
  owner: governance-bot
  tags:
  - naming
  - convention
  - standards
  - uri
  - urn
  - kebab-case
  - canonical
  updated_at: '2025-12-18T00:00:00Z'
  version: 1.0.0
spec:
  behavior:
    invariants:
    - 所有操作必須可稽核
    - 命名驗證必須冪等
    - 元規範不可引入循環依賴
    postconditions:
    - 輸出必須包含驗證結果
    - 違規必須有對應的修正建議
    preconditions:
    - 輸入必須符合資源 schema
    - 上下文必須包含有效環境
    side_effects:
    - 生成稽核軌跡
    - 更新命名統計指標
  compliance:
    audit_frequency: continuous
    controls:
    - 'NC-001: 目錄命名合規'
    - 'NC-002: 檔案命名合規'
    - 'NC-003: URN 格式合規'
    frameworks:
    - ISO-42001
    - NIST-AI-RMF
    - COBIT-2019
  dependencies:
    optional:
    - id: 27-templates
      reason: 提供命名模板範例
    - id: 34-config
      reason: 配置命名標準
    - id: 60-contracts
      reason: 契約命名標準
    required:
    - id: 01-architecture
      reason: 命名規範基於架構設計原則
    - id: 25-principles
      reason: 命名規範遵循治理原則
    - id: 31-schemas
      reason: 命名規範需要結構驗證支持
  description: '統一命名規範治理維度是 MachineNativeOps 治理框架的元規範層頂點。

    此維度定義了整個系統的命名標準，確保所有維度、檔案、鍵值、

    引用和依賴關係遵循一致的命名慣例。

    '
  interface:
    errors:
    - code: E99001
      description: 命名規範違規
      name: NamingViolation
    - code: E99002
      description: 模式不匹配
      name: PatternMismatch
    - code: E99003
      description: 使用保留關鍵字
      name: ReservedKeyword
    - code: E99004
      description: URN 格式錯誤
      name: URNFormatError
    - code: E99005
      description: 循環依賴檢測
      name: CircularDependency
    inputs:
    - description: 待驗證的資源（檔案、目錄、配置等）
      name: resource
      required: true
      type: object
    - description: 驗證上下文（環境、嚴格程度等）
      name: context
      required: false
      type: object
    outputs:
    - description: 驗證結果
      name: validation_result
      schema_ref: '#/definitions/validation_result'
      type: object
    - description: 命名建議列表
      name: suggestions
      type: array
    - description: 標準化後的名稱
      name: canonical_form
      type: string
  lifecycle:
    states:
    - draft
    - review
    - active
    - deprecated
    - retired
    transitions:
    - from: draft
      to: review
      trigger: submit_for_review
    - from: review
      to: active
      trigger: approval_complete
    - from: active
      to: deprecated
      trigger: deprecation_notice
    - from: deprecated
      to: retired
      trigger: retirement_complete
  meta_constraints:
    description: 作為元規範層，99-naming-convention 不可依賴下游模組
    no_downstream_dependencies: true
  metrics:
  - description: 命名驗證總數
    name: naming_validations_total
    type: counter
  - description: 命名違規總數
    labels:
    - rule_id
    - severity
    name: naming_violations_total
    type: counter
  - description: 驗證耗時（秒）
    name: naming_validation_duration_seconds
    type: histogram
  - description: 命名合規率
    name: naming_compliance_ratio
    type: gauge
  policy:
    enforcement: required
    engine: opa
    path: ./policy.rego
  schema:
    format: json-schema
    path: ./schema.json
    validation: required
  sub_specifications:
  - id: dir-naming
    name: 目錄命名規範
    name_en: Directory Naming Standards
    rules:
    - description: 所有目錄必須使用 kebab-case（小寫連字符）
      name: kebab-case-only
      pattern: ^[a-z0-9]+(-[a-z0-9]+)*$
      rule_id: DIR-001
      severity: error
    - allowed_values:
      - src
      - config
      - scripts
      - docs
      - tests
      description: 根目錄必須使用標準化名稱
      name: standard-root-directories
      rule_id: DIR-002
      severity: error
    - description: 禁止同義詞目錄共存
      forbidden_pairs:
      - - infra
        - infrastructure
      - - config
        - configuration
      - - script
        - scripts
      - - doc
        - docs
      - - test
        - tests
      name: synonym-elimination
      rule_id: DIR-003
      severity: error
    spec_file: ./specs/01-directory-naming.yaml
  - id: file-naming
    name: 檔案命名規範
    name_en: File Naming Standards
    rules:
    - description: 一般檔案必須使用 kebab-case
      name: kebab-case-filenames
      pattern: ^[a-z0-9]+(-[a-z0-9]+)*\.[a-z0-9]+$
      rule_id: FILE-001
      severity: error
    - allowed_uppercase:
      - README.md
      - LICENSE
      - CHANGELOG.md
      - CONTRIBUTING.md
      - CODE_OF_CONDUCT.md
      - SECURITY.md
      description: 特殊標記檔案使用全大寫
      name: special-files-uppercase
      rule_id: FILE-002
      severity: warning
    - description: 生成檔案必須有明確前綴或後綴
      name: generated-file-prefix
      patterns:
        generated_prefix: ^_generated-
        generated_suffix: -generated\.[a-z]+$
      rule_id: FILE-003
      severity: info
    spec_file: ./specs/02-file-naming.yaml
  - id: extension-standards
    name: 副檔名規範
    name_en: File Extension Standards
    rules:
    - description: 內容類型與副檔名的標準映射
      mappings:
        dockerfile:
        - Dockerfile
        - .dockerfile
        go:
        - .go
        javascript:
        - .js
        - .jsx
        - .mjs
        - .cjs
        json_config:
        - .json
        markdown:
        - .md
        python:
        - .py
        rego_policy:
        - .rego
        rust:
        - .rs
        shell_script:
        - .sh
        typescript:
        - .ts
        - .tsx
        yaml_config:
        - .yaml
        - .yml
      name: content-type-mapping
      rule_id: EXT-001
      severity: error
    - description: 偏好的副檔名選擇
      name: preferred-extensions
      preferences:
        typescript: .ts
        yaml: .yaml
      rule_id: EXT-002
      severity: warning
    - description: 禁止使用的副檔名
      forbidden:
      - .bak
      - .tmp
      - .old
      - .orig
      name: forbidden-extensions
      rule_id: EXT-003
      severity: error
    spec_file: ./specs/03-extension-standards.yaml
  - id: key-naming
    name: 鍵名規範
    name_en: Key Naming Standards
    rules:
    - applies_to:
      - .yaml
      - .yml
      description: YAML 配置鍵使用 snake_case
      name: yaml-key-snake-case
      pattern: ^[a-z][a-z0-9]*(_[a-z0-9]+)*$
      rule_id: KEY-001
      severity: error
    - applies_to:
      - .json
      context: api_response
      description: JSON API 回應鍵使用 camelCase
      name: json-key-camelCase
      pattern: ^[a-z][a-zA-Z0-9]*$
      rule_id: KEY-002
      severity: warning
    - description: 保留關鍵字不可作為自定義鍵名
      name: reserved-keywords
      reserved:
      - apiVersion
      - kind
      - metadata
      - spec
      - status
      - id
      - name
      - version
      rule_id: KEY-003
      severity: error
    - applies_to: annotations
      description: 自定義鍵需使用命名空間前綴
      name: namespace-prefix
      pattern: ^machinenativeops\.io/[a-z0-9-]+$
      rule_id: KEY-004
      severity: warning
    spec_file: ./specs/04-key-naming.yaml
  - id: value-naming
    name: 值名規範
    name_en: Value Naming Standards
    rules:
    - description: 枚舉值使用小寫 kebab-case
      examples:
        correct:
        - active
        - in-progress
        - pending-review
        incorrect:
        - Active
        - IN_PROGRESS
        - pendingReview
      name: enum-lowercase-kebab
      pattern: ^[a-z0-9]+(-[a-z0-9]+)*$
      rule_id: VAL-001
      severity: error
    - canonical:
        false_values:
        - false
        - 'false'
        true_values:
        - true
        - 'true'
      description: 布林值的標準表示
      forbidden:
      - 'yes'
      - 'no'
      - 'on'
      - 'off'
      - '1'
      - '0'
      name: boolean-canonical
      rule_id: VAL-002
      severity: error
    - description: 版本號必須符合語意化版本
      examples:
        correct:
        - 1.0.0
        - v2.1.3
        - 1.0.0-alpha
        - 1.0.0+build.123
        incorrect:
        - '1.0'
        - v1
        - version-1.0.0
      name: version-semver
      pattern: ^v?[0-9]+\.[0-9]+\.[0-9]+(-[a-z0-9]+)?(\+[a-z0-9]+)?$
      rule_id: VAL-003
      severity: error
    - canonical_mappings:
        development: dev
        learning: learn
        production: prod
        staging: staging
        testing: test
      description: 環境名稱的標準縮寫
      name: environment-abbreviations
      rule_id: VAL-004
      severity: error
    spec_file: ./specs/05-value-naming.yaml
  - id: mapping-standards
    name: 映射規範
    name_en: Mapping Standards
    rules:
    - description: 路徑別名格式標準
      examples:
        alias:
        - '@config/'
        - '@shared/'
        - '@governance/'
        relative:
        - ./config/
        - ../shared/
      name: path-alias-format
      patterns:
        absolute: ^/
        alias: ^@[a-z-]+/
        relative: ^\.\.?/
      rule_id: MAP-001
      severity: warning
    - description: 映射表命名標準
      examples:
      - dimension-to-policy
      - module-to-schema
      name: junction-table-naming
      pattern: ^[a-z]+-to-[a-z]+$
      rule_id: MAP-002
      severity: info
    - description: 映射變更追蹤元數據
      name: change-tracking-metadata
      required_fields:
      - created_at
      - updated_at
      - version
      - owner
      rule_id: MAP-003
      severity: warning
    spec_file: ./specs/06-mapping-standards.yaml
  - id: reference-standards
    name: 引用規範
    name_en: Reference Standards
    rules:
    - description: 跨檔案引用格式
      formats:
        env_reference: $env{VARIABLE_NAME}
        file_reference: $file{path/to/file.yaml}
        json_pointer: '#/path/to/element'
        yaml_anchor: '*anchor_name'
      name: cross-file-reference-format
      rule_id: REF-001
      severity: error
    - description: 導入模式標準
      name: import-pattern
      patterns:
        absolute_import: from '@package/module'
        dynamic_import: import('./module')
        relative_import: from './module'
      rule_id: REF-002
      severity: warning
    - description: 引用完整性檢查
      name: link-integrity
      rule_id: REF-003
      severity: error
      validations:
      - check_file_exists
      - check_anchor_exists
      - check_circular_reference
    spec_file: ./specs/07-reference-standards.yaml
  - id: dependency-standards
    name: 依賴規範
    name_en: Dependency Standards
    rules:
    - description: 版本約束語法
      name: semver-constraints
      patterns:
        caret: ^1.2.3
        exact: 1.2.3
        range: '>=1.0.0 <2.0.0'
        tilde: ~1.2.3
        wildcard: 1.x
      rule_id: DEP-001
      severity: error
    - description: 傳遞依賴可見性規則
      name: transitive-visibility
      rule_id: DEP-002
      rules:
      - direct_dependencies_explicit
      - transitive_dependencies_documented
      - peer_dependencies_declared
      severity: warning
    - description: 循環依賴預防
      max_depth: 10
      name: cycle-prevention
      rule_id: DEP-003
      severity: error
      validation: acyclic_graph_check
    - description: 依賴聲明格式
      format:
        optional_fields:
        - reason
        - alternatives
        required_fields:
        - id
        - version
        - type
      name: dependency-declaration-format
      rule_id: DEP-004
      severity: error
    spec_file: ./specs/08-dependency-standards.yaml
  - id: uri-urn-standards
    name: URI/URN 規範
    name_en: URI/URN Standards
    rules:
    - description: 標準 URN 格式
      examples:
        correct:
        - urn:machinenativeops:governance:naming-convention:v1
        - urn:machinenativeops:ai:cognitive-engine:v2
        - urn:machinenativeops:core:execution-engine:v1
        incorrect:
        - urn:MachineNativeOps:Governance:NamingConvention
        - machinenativeops:governance:naming
        - urn:machinenativeops:Governance:naming-convention
      name: canonical-urn-format
      pattern: ^urn:machinenativeops:[a-z0-9-]+:[a-z0-9-]+(:v[0-9]+)?$
      rule_id: URN-001
      severity: error
      template: urn:machinenativeops:{domain}:{resource}:{version}
    - description: URN 域名登錄
      name: urn-domain-registry
      registered_domains:
        ai: AI 相關資源
        autonomous: 自主系統資源
        config: 配置資源
        core: 核心引擎資源
        dimension: 維度資源
        governance: 治理框架資源
      rule_id: URN-002
      severity: error
    - checksum_algorithm: sha256-short
      checksum_length: 8
      description: URN 校驗碼欄位
      format: urn:machinenativeops:{domain}:{resource}:{version}:{checksum}
      name: urn-checksum-slot
      optional: true
      rule_id: URN-003
      severity: info
    - description: URN 環境範圍
      environments:
      - dev
      - staging
      - prod
      format: urn:machinenativeops:{env}:{domain}:{resource}:{version}
      name: urn-environment-scoping
      rule_id: URN-004
      severity: warning
    - description: API URI 路徑模式
      examples:
        correct:
        - /api/v1/dimensions/99-naming-convention
        - /api/v2/governance/policies
        incorrect:
        - /API/V1/Dimensions
        - /api/dimensions/NamingConvention
      name: api-uri-pattern
      patterns:
        graphql: /graphql
        rest_api: /api/v{version}/{resource}/{id?}
        websocket: /ws/{channel}
      rule_id: URI-001
      severity: error
    - description: 資源 URI 路徑模式
      name: resource-uri-pattern
      pattern: ^/[a-z0-9]+(/[a-z0-9-]+)*$
      rule_id: URI-002
      severity: error
    spec_file: ./specs/09-uri-urn-standards.yaml
status: active
