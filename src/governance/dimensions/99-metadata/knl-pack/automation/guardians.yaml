approvals:
  approval_teams:
  - governance-team
  - platform-team
  approval_timeout_hours: 48
  auto_approve_minor: false
  required_for_critical: 2
  required_for_error: 1
  required_for_warning: 0
description: 守護欄配置 - Guardian Pre-flight Checks for Safe Operations
execution:
  collect_all_failures: true
  fail_fast: false
  parallel: true
  timeout_seconds: 300
guardians:
- checks:
  - analyze_depth: 3
    description: Check if changes affect dependent artifacts
    max_affected: 50
    type: dependency_impact
  - allow_minor_updates: true
    check_versions: true
    description: Verify API backward compatibility
    type: api_compatibility
  - allow_additive: true
    allow_deprecation: true
    deny_removal: true
    description: Validate schema changes are non-breaking
    type: schema_compatibility
  description: 確保變更不會破壞現有依賴 - Ensure changes don't break dependencies
  enabled: true
  failure_action:
    action: block
    message: Breaking changes detected. Manual review required.
    notify: true
  name: no_breaking_changes
  severity: critical
- checks:
  - description: Validate against all governance policies
    enforcement: strict
    policies:
    - naming-convention
    - metadata-completeness
    - lineage-tracking
    - provenance-recording
    type: policy_check
  - description: Run OPA policy validation
    policy_files:
    - ../../policy.rego
    - ../governance/policies.rego
    type: opa_validation
  - description: Apply custom governance rules
    rules:
    - no_sensitive_data_in_public
    - required_approvals_obtained
    type: custom_rules
  description: 所有策略必須合規 - All policies must be compliant
  enabled: true
  failure_action:
    action: block
    message: Policy violations found. Fix before proceeding.
    notify: true
  name: all_policies_compliant
  severity: error
- checks:
  - description: Ensure changes don't affect too many artifacts
    max_artifacts: 50
    max_depth: 3
    type: radius_check
  - description: Analyze cascade effects of changes
    max_cascades: 5
    type: cascade_analysis
    warn_threshold: 3
  - description: Check how many teams are affected
    max_teams: 5
    type: team_impact
  description: 變更影響範圍限制 - Limit change impact radius
  enabled: true
  failure_action:
    action: warn
    approval_threshold: 2
    message: Large impact radius detected. Additional approvals required.
    notify: true
    require_approval: true
  name: impact_radius
  severity: warning
- checks:
  - description: Verify metadata completeness
    min_completeness: 0.8
    required_fields:
    - owner
    - domain
    - lifecycle
    - compliance
    type: completeness_check
  - check_constraints: true
    check_formats: true
    check_types: true
    description: Validate data accuracy
    type: accuracy_check
  - check_references: true
    cross_reference: true
    description: Ensure internal consistency
    type: consistency_check
  description: 確保數據質量標準 - Ensure data quality standards
  enabled: true
  failure_action:
    action: block
    message: Data quality standards not met.
    notify: true
  name: data_quality
  severity: error
- checks:
  - description: Scan for exposed secrets
    patterns:
    - api_key
    - password
    - token
    - secret
    type: secrets_scan
  - description: Detect personally identifiable information
    sensitivity: high
    type: pii_detection
  - check_ownership: true
    check_permissions: true
    description: Verify proper access controls
    type: access_control
  description: 安全性驗證 - Security validation checks
  enabled: true
  failure_action:
    action: block
    escalate: true
    message: Security violations detected. Immediate action required.
    notify: true
  name: security_validation
  severity: critical
- checks:
  - description: Check artifact size limits
    max_size_kb: 1024
    type: size_check
    warn_size_kb: 512
  - description: Assess complexity metrics
    max_branches: 20
    max_depth: 10
    type: complexity_check
  - description: Estimate query performance impact
    max_query_time_ms: 1000
    type: query_impact
  description: 性能影響評估 - Performance impact assessment
  enabled: true
  failure_action:
    action: warn
    message: Performance impact may be significant.
    notify: true
  name: performance_impact
  severity: warning
- checks:
  - description: Verify backup exists before changes
    require_snapshot: true
    type: backup_exists
  - description: Ensure rollback plan is defined
    require_plan: true
    type: rollback_plan
  - description: Check if rollback preserves dependencies
    type: dependency_preservation
    validate_dependencies: true
  description: 回滾準備檢查 - Rollback readiness checks
  enabled: true
  failure_action:
    action: warn
    message: Rollback preparation incomplete.
    notify: true
  name: rollback_readiness
  severity: warning
notifications:
  on_approval_needed:
    method: github_review
    reviewers:
    - '@governance-team'
  on_failure:
    labels:
    - guardian-failure
    - requires-review
    method: github_issue
  on_warning:
    method: github_comment
version: 1.0.0
