apiVersion: machinenativeops.io/v2
kind: ExampleValidationConfig
metadata:
  created: '2025-12-19'
  name: example-validation
  namespace: machinenativenops
  version: 1.0.0
spec:
  caching:
    cache_key: validation-${git_commit_sha}
    cache_paths:
    - node_modules/
    - .npm/
    - .cache/
    - __pycache__/
    enabled: true
    invalidate_on:
    - package.json
    - requirements.txt
    - pom.xml
    - go.mod
  reporting:
    enabled: true
    formats:
    - json
    - html
    - markdown
    include:
    - validation_summary
    - failed_checks
    - warnings
    - metrics
    - recommendations
    notifications:
    - enabled: true
      type: console
      verbose: true
    - enabled: true
      path: validation.log
      type: file
    - channel: '#validation-alerts'
      enabled: false
      type: slack
      webhook_url: ${SLACK_WEBHOOK_URL}
    output_path: validation-reports/
  retry:
    backoff: exponential
    enabled: true
    initial_delay_ms: 1000
    max_attempts: 3
    max_delay_ms: 10000
    retry_on:
    - network_error
    - timeout
    - rate_limit
  validation_pipeline:
    stages:
    - name: pre-validation
      steps:
      - install_dependencies
      - setup_environment
    - name: syntax_check
      parallel: true
      steps:
      - lint_code
      - format_check
      - type_check
    - depends_on:
      - syntax_check
      name: compilation
      steps:
      - compile_code
    - depends_on:
      - compilation
      name: testing
      parallel: false
      steps:
      - unit_tests
      - integration_tests
      - e2e_tests
    - depends_on:
      - compilation
      name: security_scan
      parallel: true
      steps:
      - dependency_audit
      - vulnerability_scan
      - static_analysis
    - depends_on:
      - testing
      - security_scan
      name: post-validation
      steps:
      - generate_report
      - cleanup
  validation_rules:
    compile_validation:
      enabled: true
      environments:
      - cache_dependencies: true
        commands:
        - npm install
        - npm run build
        name: nodejs
        timeout: 5m
        version: 20.x
      - commands:
        - pip install -r requirements.txt
        - python -m py_compile *.py
        name: python
        timeout: 3m
        use_venv: true
        version: '3.10'
      - commands:
        - mvn clean compile
        name: java
        timeout: 5m
        version: '17'
      - commands:
        - go build ./...
        name: go
        timeout: 3m
        version: '1.21'
      fail_on_warning: false
    dependency_validation:
      checks:
      - check_peer_dependencies: true
        enabled: true
        name: version_compatibility
      - allowed_licenses:
        - MIT
        - Apache-2.0
        - BSD-3-Clause
        - ISC
        denied_licenses:
        - GPL-3.0
        - AGPL-3.0
        enabled: true
        name: license_compliance
      - enabled: true
        max_age_days: 365
        name: outdated_packages
      - enabled: true
        name: vulnerability_scan
        severity_threshold: moderate
      enabled: true
    runtime_validation:
      enabled: true
      fail_fast: false
      runtime_checks:
      - enabled: true
        name: memory_leak_detection
        threshold_mb: 500
      - enabled: true
        max_execution_time_ms: 5000
        name: performance_profiling
      - check_breaking_changes: true
        enabled: true
        name: api_compatibility
      tests:
      - command: npm test
        coverage:
          enabled: true
          minimum: 70
          reporters:
          - text
          - lcov
          - html
        timeout: 5m
        type: unit_test
      - cleanup:
        - docker_compose_down
        command: npm run test:integration
        prerequisites:
        - docker_compose_up
        - wait_for_services
        timeout: 10m
        type: integration_test
      - command: npm run test:e2e
        environment: test
        headless: true
        timeout: 15m
        type: e2e_test
    security_validation:
      enabled: true
      fail_on_critical: true
      fail_on_high: true
      scans:
      - command: snyk test
        options:
          fail_on: upgradable
          json_output: true
          severity_threshold: high
        tool: snyk
      - command: semgrep --config=auto
        exclude_patterns:
        - test/**
        - '*.test.ts'
        rules:
        - security
        - best-practices
        - owasp-top-ten
        tool: semgrep
      - command: trivy filesystem .
        ignore_unfixed: false
        scan_type: vulnerability
        severity:
        - CRITICAL
        - HIGH
        tool: trivy
      - audit_level: moderate
        command: npm audit
        production_only: true
        tool: npm-audit
      static_analysis:
      - coverage_threshold: 80
        enabled: true
        quality_gate: strict
        tool: sonarqube
      - enabled: true
        languages:
        - typescript
        - python
        - java
        queries:
        - security-extended
        tool: codeql
    syntax_validation:
      enabled: true
      strict_mode: true
      tools:
        go:
        - name: gofmt
          simplify: true
        - min_confidence: 0.8
          name: golint
        java:
        - config: checkstyle.xml
          name: checkstyle
          style: google
        - name: google-java-format
          version: 1.17.0
        python:
        - config: .flake8
          ignore:
          - E203
          - W503
          max_line_length: 100
          name: flake8
        - config: pyproject.toml
          line_length: 100
          name: black
        typescript:
        - config: .eslintrc.json
          name: eslint
          rules:
          - no-console: warn
          - no-unused-vars: error
          - prefer-const: error
        - config: .prettierrc
          name: prettier
          options:
            printWidth: 100
            semi: true
            singleQuote: true
            tabWidth: 2
