version: "1.0.0"
skeleton_id: "performance-reliability"

schemas:
  performance_reliability_input:
    type: object
    description: "效能與可靠性請求：SLO 定義、容量規劃或故障恢復設計"
    properties:
      action_type:
        type: string
        enum:
          - "define_slo"
          - "plan_capacity"
          - "design_failover"
          - "set_recovery_targets"
          - "analyze_performance"
        description: "執行動作類型"
      service_name:
        type: string
        description: "目標服務名稱"
      current_metrics:
        type: object
        properties:
          latency_p50: { type: number }
          latency_p99: { type: number }
          error_rate: { type: number }
          throughput_rps: { type: number }
        description: "當前效能指標"
      scale_requirements:
        type: object
        properties:
          expected_users: { type: integer }
          peak_rps: { type: number }
          growth_rate: { type: number }
        description: "預期規模與成長率"
    required:
      - action_type
      - service_name

  performance_reliability_report:
    type: object
    description: "效能與可靠性評估報告：SLO/SLI 分析與優化建議"
    properties:
      service_name: { type: string }
      slo_definition:
        type: object
        properties:
          availability_target: { type: number, minimum: 0.9, maximum: 0.99999 }
          latency_p50_target: { type: number }
          latency_p99_target: { type: number }
          error_rate_target: { type: number }
      sli_tracking:
        type: object
        properties:
          availability_achieved: { type: number }
          latency_p50_achieved: { type: number }
          latency_p99_achieved: { type: number }
          error_rate_achieved: { type: number }
          slo_compliance_percentage: { type: number }
      capacity_analysis:
        type: object
        properties:
          current_capacity_rps: { type: number }
          current_utilization_percentage: { type: number }
          headroom_percentage: { type: number }
          scaling_recommendation: { type: string }
          expected_saturation_date: { type: string, format: "date" }
      failover_readiness:
        type: object
        properties:
          rto_current: { type: string }
          rto_target: { type: string }
          rpo_current: { type: string }
          rpo_target: { type: string }
          failover_tested: { type: boolean }
          backup_lag_seconds: { type: integer }
      reliability_risks:
        type: array
        items:
          type: object
          properties:
            risk_id: { type: string }
            description: { type: string }
            impact: { enum: ["critical", "high", "medium", "low"] }
            mitigation: { type: string }
      timestamp: { type: string, format: "date-time" }
    required:
      - service_name
      - slo_definition
      - capacity_analysis

  performance_reliability_suggestion:
    type: object
    description: "效能與可靠性改善建議：擴展策略、優化或高可用性方案"
    properties:
      service_name: { type: string }
      suggestion_type:
        type: string
        enum:
          - "scaling_strategy"
          - "optimization_technique"
          - "high_availability"
          - "caching_strategy"
          - "replication_setup"
      current_state: { type: string }
      recommended_state: { type: string }
      implementation_roadmap:
        type: array
        items:
          type: object
          properties:
            phase: { type: string }
            tasks: { type: array, items: { type: string } }
            expected_improvement: { type: object }
      expected_outcomes:
        type: object
        properties:
          latency_improvement_percentage: { type: number }
          availability_improvement_percentage: { type: number }
          cost_impact: { type: string }
      risks_and_mitigations:
        type: array
        items:
          type: object
          properties:
            risk: { type: string }
            mitigation: { type: string }
    required:
      - service_name
      - suggestion_type
      - current_state
      - recommended_state
