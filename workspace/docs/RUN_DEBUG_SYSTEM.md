# åŸ·è¡Œèˆ‡åµéŒ¯ç³»çµ± (Run &amp; Debug System)

## ğŸ¯ ç³»çµ±æ¦‚è¿°

é€™æ˜¯ä¸€å€‹è¶…è¶Šå‚³çµ± IDE çš„åŸ·è¡Œèˆ‡åµéŒ¯ç³»çµ±ï¼Œæ•´åˆäº†ï¼š

- **å¤šèªè¨€æ”¯æ´**ï¼šPython, JavaScript/TypeScript, Go, Rust, Java ç­‰
- **çµ‚ç«¯æ©ŸåµéŒ¯**ï¼šç›´æ¥åœ¨çµ‚ç«¯æ©Ÿä¸­åŸ·è¡ŒåµéŒ¯å‘½ä»¤
- **äº’å‹•å¼èŠå¤©åµéŒ¯**ï¼šä½¿ç”¨è‡ªç„¶èªè¨€é€²è¡ŒåµéŒ¯
- **æ™ºèƒ½è¨ºæ–·**ï¼šAI é©…å‹•çš„éŒ¯èª¤åˆ†æèˆ‡ä¿®å¾©å»ºè­°
- **launch.json ç›¸å®¹**ï¼šå®Œå…¨ç›¸å®¹ VS Code çš„é…ç½®æ ¼å¼

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä½¿ç”¨è€…ä»‹é¢å±¤                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  çµ‚ç«¯æ©Ÿä»‹é¢   â”‚   èŠå¤©ä»‹é¢        â”‚   VS Code æ“´å……           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŸ·è¡Œèˆ‡åµéŒ¯å¼•æ“                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŸ·è¡Œç®¡ç†å™¨   â”‚   åµéŒ¯å”è­°        â”‚   æœƒè©±ç®¡ç†               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    èªè¨€é©é…å±¤                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Python DAP  â”‚   Node.js DAP     â”‚   å…¶ä»–èªè¨€ DAP           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº•å±¤åŸ·è¡Œç’°å¢ƒ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¨‹åºç®¡ç†     â”‚   æª”æ¡ˆç³»çµ±        â”‚   ç¶²è·¯é€šè¨Š               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### 1. åŸ·è¡Œç®¡ç† (Execution Management)

#### 1.1 é…ç½®ç³»çµ±

æ”¯æ´æ¨™æº– launch.json æ ¼å¼ï¼Œç¯„ä¾‹é…ç½®ï¼š

**Python é…ç½®**

```json
{
  "type": "python",
  "request": "launch",
  "name": "Python: Current File",
  "program": "${file}",
  "console": "integratedTerminal"
}
```

**Node.js é…ç½®**

```json
{
  "type": "node",
  "request": "launch",
  "name": "Node: Current File",
  "program": "${file}",
  "skipFiles": ["<node_internals>/**"]
}
```

#### 1.2 è®Šæ•¸æ›¿æ›

- `${workspaceFolder}` - å·¥ä½œå€æ ¹ç›®éŒ„
- `${file}` - ç•¶å‰æª”æ¡ˆ
- `${fileBasename}` - ç•¶å‰æª”æ¡ˆåç¨±
- `${fileDirname}` - ç•¶å‰æª”æ¡ˆç›®éŒ„
- `${env:NAME}` - ç’°å¢ƒè®Šæ•¸
- `${config:NAME}` - é…ç½®å€¼

### 2. åµéŒ¯å”è­° (Debug Adapter Protocol)

å®Œæ•´å¯¦ä½œ DAP å”è­°ï¼Œæ”¯æ´æ‰€æœ‰æ¨™æº–åµéŒ¯æ“ä½œã€‚

### 3. çµ‚ç«¯æ©ŸåµéŒ¯ä»‹é¢

#### 3.1 å‘½ä»¤åˆ—å·¥å…·

```bash
# å•Ÿå‹•åµéŒ¯æœƒè©±
$ mno debug start --config python-debug

# è¨­å®šæ–·é»
$ mno debug breakpoint set src/main.py:10

# åŸ·è¡Œåˆ°ä¸‹ä¸€è¡Œ
$ mno debug next

# æª¢è¦–è®Šæ•¸
$ mno debug var inspect myVariable

# è©•ä¼°è¡¨é”å¼
$ mno debug eval "x + y"

# æª¢è¦–å †ç–Šè¿½è¹¤
$ mno debug stack

# ç¹¼çºŒåŸ·è¡Œ
$ mno debug continue
```

#### 3.2 äº’å‹•å¼åµéŒ¯ REPL

```bash
$ mno debug repl
(mno-debug) break src/main.py:10
Breakpoint 1 set at src/main.py:10

(mno-debug) run
Starting program...
Breakpoint 1 hit at src/main.py:10

(mno-debug) print x
x = 42

(mno-debug) next
Stepped to src/main.py:11

(mno-debug) continue
Program finished.
```

### 4. èŠå¤©å¼åµéŒ¯ä»‹é¢

#### 4.1 è‡ªç„¶èªè¨€äº’å‹•ç¯„ä¾‹

**éŒ¯èª¤è¨ºæ–·**

```
User: ç‚ºä»€éº¼æˆ‘çš„ç¨‹å¼åœ¨ç¬¬ 10 è¡Œå´©æ½°ï¼Ÿ

AI: æˆ‘åˆ†æäº†æ‚¨çš„ç¨‹å¼ç¢¼ï¼Œç™¼ç¾ç¬¬ 10 è¡Œæœ‰é™¤ä»¥é›¶çš„éŒ¯èª¤ã€‚
    è®Šæ•¸ 'divisor' çš„å€¼ç‚º 0ï¼Œå°è‡´ ZeroDivisionErrorã€‚
    
    å»ºè­°ä¿®å¾©ï¼š
    1. åœ¨é™¤æ³•å‰æª¢æŸ¥ divisor æ˜¯å¦ç‚º 0
    2. ä½¿ç”¨ try-except æ•ç²ç•°å¸¸
    
    è¦æˆ‘å¹«æ‚¨è‡ªå‹•ä¿®å¾©å—ï¼Ÿ
```

**è®Šæ•¸æª¢æŸ¥**

```
User: x çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ

AI: åœ¨ç•¶å‰æ–·é»è™•ï¼Œè®Šæ•¸ x çš„å€¼ç‚ºï¼š
    x = 42 (type: int)
    
    ç›¸é—œè®Šæ•¸ï¼š
    - y = 10
    - result = x + y = 52
```

**ç¨‹å¼ç¢¼å»ºè­°**

```
User: å¦‚ä½•å„ªåŒ–é€™æ®µç¨‹å¼ç¢¼ï¼Ÿ

AI: æˆ‘ç™¼ç¾ä»¥ä¸‹å„ªåŒ–æ©Ÿæœƒï¼š
    1. ç¬¬ 15-20 è¡Œçš„è¿´åœˆå¯ä»¥ç”¨åˆ—è¡¨æ¨å°å¼ç°¡åŒ–
    2. ç¬¬ 25 è¡Œçš„å­—ä¸²æ‹¼æ¥å¯ä»¥ç”¨ f-string æå‡æ•ˆèƒ½
    3. ç¬¬ 30 è¡Œçš„æ¢ä»¶åˆ¤æ–·å¯ä»¥åˆä½µ
    
    è¦æˆ‘å±•ç¤ºå„ªåŒ–å¾Œçš„ç¨‹å¼ç¢¼å—ï¼Ÿ
```

### 5. æ™ºèƒ½è¨ºæ–·ç³»çµ±

#### 5.1 éŒ¯èª¤åˆ†æ

- è‡ªå‹•è­˜åˆ¥å¸¸è¦‹éŒ¯èª¤æ¨¡å¼
- æä¾›ä¸Šä¸‹æ–‡ç›¸é—œçš„ä¿®å¾©å»ºè­°
- å­¸ç¿’å°ˆæ¡ˆç‰¹å®šçš„éŒ¯èª¤æ¨¡å¼

#### 5.2 æ•ˆèƒ½åˆ†æ

- å³æ™‚æ•ˆèƒ½ç›£æ§
- è¨˜æ†¶é«”ä½¿ç”¨åˆ†æ
- ç“¶é ¸è­˜åˆ¥èˆ‡å»ºè­°

#### 5.3 ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥

- éœæ…‹åˆ†ææ•´åˆ
- æœ€ä½³å¯¦è¸å»ºè­°
- å®‰å…¨æ€§æ¼æ´æª¢æ¸¬

## ğŸ“š ä½¿ç”¨ç¯„ä¾‹

### ç¯„ä¾‹ 1ï¼šPython åµéŒ¯

**launch.json**

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Python: Debug Current File",
      "type": "python",
      "request": "launch",
      "program": "${file}",
      "console": "integratedTerminal",
      "justMyCode": true,
      "env": {
        "PYTHONPATH": "${workspaceFolder}/src"
      }
    }
  ]
}
```

**çµ‚ç«¯æ©Ÿä½¿ç”¨**

```bash
$ mno debug start --config "Python: Debug Current File"
$ mno debug break src/calculator.py:15
$ mno debug run
# ç¨‹å¼åœ¨æ–·é»è™•åœæ­¢
$ mno debug var inspect result
$ mno debug next
$ mno debug continue
```

### ç¯„ä¾‹ 2ï¼šNode.js åµéŒ¯

**launch.json**

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Node: Debug Server",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/src/server.js",
      "skipFiles": ["<node_internals>/**"],
      "env": {
        "NODE_ENV": "development"
      }
    }
  ]
}
```

**èŠå¤©å¼åµéŒ¯**

```
User: å•Ÿå‹• Node ä¼ºæœå™¨åµéŒ¯

AI: å·²å•Ÿå‹• Node.js åµéŒ¯æœƒè©±ã€‚ä¼ºæœå™¨æ­£åœ¨ http://localhost:3000 é‹è¡Œã€‚
    è¦è¨­å®šæ–·é»å—ï¼Ÿ

User: åœ¨è™•ç† /api/users è«‹æ±‚çš„åœ°æ–¹è¨­å®šæ–·é»

AI: å·²åœ¨ src/routes/users.js:25 è¨­å®šæ–·é»ã€‚
    é€™æ˜¯è™•ç† GET /api/users è«‹æ±‚çš„ä½ç½®ã€‚
    
User: ç™¼é€æ¸¬è©¦è«‹æ±‚

AI: å·²è§¸ç™¼æ–·é»ï¼ç•¶å‰ç‹€æ…‹ï¼š
    - req.params = {}
    - req.query = { page: 1, limit: 10 }
    - å³å°‡åŸ·è¡Œè³‡æ–™åº«æŸ¥è©¢
    
    è¦ç¹¼çºŒåŸ·è¡Œé‚„æ˜¯æª¢æŸ¥è®Šæ•¸ï¼Ÿ
```

### ç¯„ä¾‹ 3ï¼šå¤šèªè¨€å°ˆæ¡ˆåµéŒ¯

**launch.json**

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Full Stack Debug",
      "type": "compound",
      "configurations": [
        "Python: Backend API",
        "Node: Frontend Dev Server"
      ]
    },
    {
      "name": "Python: Backend API",
      "type": "python",
      "request": "launch",
      "program": "${workspaceFolder}/backend/main.py",
      "console": "integratedTerminal"
    },
    {
      "name": "Node: Frontend Dev Server",
      "type": "node",
      "request": "launch",
      "runtimeExecutable": "npm",
      "runtimeArgs": ["run", "dev"],
      "cwd": "${workspaceFolder}/frontend"
    }
  ]
}
```

## ğŸš€ é€²éšåŠŸèƒ½

### 1. æ¢ä»¶æ–·é»

```bash
mno debug break src/main.py:10 --condition "x > 100"
```

### 2. æ—¥èªŒé» (Logpoints)

```bash
mno debug logpoint src/main.py:15 --message "Value of x: {x}"
```

### 3. è³‡æ–™æ–·é» (Data Breakpoints)

```bash
mno debug watch myObject.property
```

### 4. ç•°å¸¸æ–·é»

```bash
mno debug break-on-exception --type ValueError
```

### 5. æ™‚é–“æ—…è¡ŒåµéŒ¯ (Time Travel Debugging)

```bash
mno debug record
mno debug replay
mno debug step-back
```

## ğŸ”Œ æ“´å……æ€§

### è‡ªè¨‚èªè¨€æ”¯æ´

```typescript
import { DebugAdapter } from '@mno/debug-core';

class MyLanguageDebugAdapter extends DebugAdapter {
  async initialize(args: InitializeRequestArguments) {
    // å¯¦ä½œåˆå§‹åŒ–é‚è¼¯
  }
  
  async launch(args: LaunchRequestArguments) {
    // å¯¦ä½œå•Ÿå‹•é‚è¼¯
  }
  
  // å¯¦ä½œå…¶ä»– DAP æ–¹æ³•...
}

// è¨»å†Šé©é…å™¨
registerDebugAdapter('mylang', MyLanguageDebugAdapter);
```

### è‡ªè¨‚è¨ºæ–·è¦å‰‡

```yaml
# custom-diagnostics.yaml
rules:
  - id: custom-null-check
    pattern: "if x == None:"
    message: "ä½¿ç”¨ 'if x is None:' è€Œä¸æ˜¯ 'if x == None:'"
    severity: warning
    fix: "if x is None:"
    
  - id: custom-performance
    pattern: "for .+ in .+:\n\\s+list.append"
    message: "è€ƒæ…®ä½¿ç”¨åˆ—è¡¨æ¨å°å¼ä»¥æå‡æ•ˆèƒ½"
    severity: info
```

## ğŸ“Š ç›£æ§èˆ‡åˆ†æ

### åµéŒ¯æœƒè©±çµ±è¨ˆ

- æ–·é»å‘½ä¸­æ¬¡æ•¸
- å¹³å‡åµéŒ¯æ™‚é–“
- æœ€å¸¸è¦‹çš„éŒ¯èª¤é¡å‹
- æ•ˆèƒ½ç“¶é ¸åˆ†æ

### åœ˜éšŠå”ä½œ

- å…±äº«åµéŒ¯é…ç½®
- åµéŒ¯æœƒè©±éŒ„è£½èˆ‡å›æ”¾
- å”ä½œå¼å•é¡Œè§£æ±º

## ğŸ”’ å®‰å…¨æ€§

### æ•æ„Ÿè³‡æ–™ä¿è­·

- è‡ªå‹•é®è”½å¯†ç¢¼å’Œé‡‘é‘°
- å®‰å…¨çš„ç’°å¢ƒè®Šæ•¸è™•ç†
- åµéŒ¯æ—¥èªŒåŠ å¯†

### å­˜å–æ§åˆ¶

- åŸºæ–¼è§’è‰²çš„åµéŒ¯æ¬Šé™
- ç”Ÿç”¢ç’°å¢ƒåµéŒ¯é™åˆ¶
- å¯©è¨ˆæ—¥èªŒ

## ğŸ“– æœ€ä½³å¯¦è¸

1. **ä½¿ç”¨æœ‰æ„ç¾©çš„é…ç½®åç¨±**
2. **å–„ç”¨æ¢ä»¶æ–·é»æ¸›å°‘ä¸­æ–·æ¬¡æ•¸**
3. **åˆ©ç”¨æ—¥èªŒé»é€²è¡Œéä¾µå…¥å¼åµéŒ¯**
4. **å®šæœŸæ¸…ç†æœªä½¿ç”¨çš„æ–·é»**
5. **ä½¿ç”¨èŠå¤©ä»‹é¢å¿«é€Ÿè¨ºæ–·å•é¡Œ**
6. **è¨˜éŒ„ä¸¦åˆ†äº«æœ‰ç”¨çš„åµéŒ¯é…ç½®**

## ğŸ“ å­¸ç¿’è³‡æº

- [å¿«é€Ÿå…¥é–€æŒ‡å—](./RUN_DEBUG_QUICKSTART.md)
- [API åƒè€ƒæ–‡ä»¶](./RUN_DEBUG_API.md)
- [æ•…éšœæ’é™¤æŒ‡å—](./RUN_DEBUG_TROUBLESHOOTING.md)
- [ç¯„ä¾‹å°ˆæ¡ˆ](../examples/debug-examples/)
- [å½±ç‰‡æ•™å­¸](https://example.com/tutorials)

## ğŸ¤ è²¢ç»

æ­¡è¿è²¢ç»æ–°çš„èªè¨€æ”¯æ´ã€è¨ºæ–·è¦å‰‡æˆ–åŠŸèƒ½æ”¹é€²ï¼
è«‹åƒé–± [è²¢ç»æŒ‡å—](../CONTRIBUTING.md)ã€‚

## ğŸ“ æˆæ¬Š

MIT License - è©³è¦‹ [LICENSE](../LICENSE) æª”æ¡ˆã€‚
