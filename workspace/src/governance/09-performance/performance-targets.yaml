---
apiVersion: governance.machinenativeops.io/v1
kind: PerformanceTargets
metadata:
  name: performance-targets
  version: "1.0.0"
  lastUpdated: "2025-12-18"
  owner: performance-team
  description: 系統性能目標定義和監控指標

system_specifications:
  version: "1.0.0"
  components:
    - name: "performance_monitor"
      version: ">= 3.0.0"
      purpose: "性能監控引擎"
      interface: "Prometheus + Grafana"
    - name: "metrics_collector"
      version: ">= 2.5.0"
      purpose: "指標收集服務"
      interface: "OpenTelemetry"
    - name: "alerting_engine"
      version: ">= 2.0.0"
      purpose: "告警引擎"
      interface: "AlertManager"
    - name: "sla_tracker"
      version: ">= 1.8.0"
      purpose: "SLA 追蹤器"
      interface: "REST API"
  
  dependencies:
    required:
      - "monitoring-infrastructure"
      - "metrics-storage"
      - "alerting-system"
    optional:
      - "ml-anomaly-detection"
      - "predictive-analytics"
  
  interfaces:
    input:
      - name: "performance_metrics"
        type: "MetricsData"
        schema: "metrics-data.schema.json"
      - name: "sla_requirements"
        type: "SLARequirements"
        schema: "sla-requirements.schema.json"
    output:
      - name: "performance_report"
        type: "PerformanceReport"
        schema: "performance-report.schema.json"
      - name: "sla_compliance"
        type: "SLACompliance"
        schema: "sla-compliance.schema.json"

performance_categories:
  - category: "availability"
    description: "系統可用性指標"
    targets:
      - metric: "uptime_percentage"
        target: "99.9%"
        threshold: "99.5%"
        measurement: "monthly"
      - metric: "mttr"
        target: "< 4 hours"
        threshold: "< 8 hours"
        measurement: "rolling_30d"
      - metric: "mtbf"
        target: "> 720 hours"
        threshold: "> 360 hours"
        measurement: "rolling_90d"
        
  - category: "response_time"
    description: "響應時間指標"
    targets:
      - metric: "api_response_p95"
        target: "< 200ms"
        threshold: "< 500ms"
        measurement: "daily"
      - metric: "api_response_p99"
        target: "< 500ms"
        threshold: "< 1000ms"
        measurement: "daily"
      - metric: "page_load_time"
        target: "< 2s"
        threshold: "< 5s"
        measurement: "weekly"
        
  - category: "throughput"
    description: "吞吐量指標"
    targets:
      - metric: "requests_per_second"
        target: "> 10,000"
        threshold: "> 5,000"
        measurement: "peak_hour"
      - metric: "concurrent_users"
        target: "> 50,000"
        threshold: "> 25,000"
        measurement: "peak_hour"
      - metric: "data_processing_rate"
        target: "> 1GB/s"
        threshold: "> 500MB/s"
        measurement: "continuous"
        
  - category: "resource_utilization"
    description: "資源利用率指標"
    targets:
      - metric: "cpu_utilization"
        target: "< 70%"
        threshold: "< 85%"
        measurement: "5min_average"
      - metric: "memory_utilization"
        target: "< 80%"
        threshold: "< 90%"
        measurement: "5min_average"
      - metric: "disk_utilization"
        target: "< 75%"
        threshold: "< 85%"
        measurement: "hourly"
      - metric: "network_bandwidth"
        target: "< 60%"
        threshold: "< 80%"
        measurement: "5min_average"

service_level_objectives:
  - name: "critical_services_slo"
    description: "關鍵服務 SLO"
    availability_target: "99.9%"
    latency_target: "p99 < 500ms"
    error_budget: "0.1%"
    measurement_period: "30 days"
    
  - name: "standard_services_slo"
    description: "標準服務 SLO"
    availability_target: "99.5%"
    latency_target: "p95 < 200ms"
    error_budget: "0.5%"
    measurement_period: "30 days"
    
  - name: "internal_services_slo"
    description: "內部服務 SLO"
    availability_target: "99.0%"
    latency_target: "p90 < 100ms"
    error_budget: "1.0%"
    measurement_period: "30 days"

monitoring_configuration:
  metrics_collection:
    interval: "30 seconds"
    retention: "90 days"
    aggregation: "1m, 5m, 1h, 1d"
    
  alerting_rules:
    - name: "high_response_time"
      condition: "api_response_p95 > 500ms"
      duration: "5m"
      severity: "warning"
      
    - name: "critical_availability"
      condition: "uptime_percentage < 99.5%"
      duration: "1m"
      severity: "critical"
      
    - name: "resource_exhaustion"
      condition: "cpu_utilization > 85%"
      duration: "10m"
      severity: "warning"
      
  dashboards:
    - name: "system_overview"
      refresh_interval: "30s"
      panels:
        - "availability_gauge"
        - "response_time_trend"
        - "throughput_graph"
        - "resource_utilization"
        
    - name: "sla_compliance"
      refresh_interval: "1m"
      panels:
        - "slo_status"
        - "error_budget_burn"
        - "incident_timeline"
        - "compliance_trend"

performance_optimization:
  auto_scaling:
    - metric: "cpu_utilization"
      target: "70%"
      min_instances: 2
      max_instances: 50
      scale_up_cooldown: "5m"
      scale_down_cooldown: "10m"
      
    - metric: "memory_utilization"
      target: "80%"
      min_instances: 2
      max_instances: 50
      scale_up_cooldown: "5m"
      scale_down_cooldown: "10m"
      
  caching_strategy:
    - level: "application_cache"
      ttl: "5 minutes"
      hit_ratio_target: "> 80%"
      
    - level: "database_cache"
      ttl: "1 hour"
      hit_ratio_target: "> 90%"
      
    - level: "cdn_cache"
      ttl: "24 hours"
      hit_ratio_target: "> 95%"

reporting:
  daily_reports:
    - "performance_summary"
    - "sla_status"
    - "resource_utilization"
    
  weekly_reports:
    - "performance_trends"
    - "capacity_planning"
    - "optimization_recommendations"
    
  monthly_reports:
    - "slo_compliance"
    - "performance_baseline"
    - "cost_optimization"
    - "capacity_forecast"

integration_points:
  monitoring_systems:
    - "prometheus"
    - "grafana"
    - "alertmanager"
    - "jaeger"
    
  business_systems:
    - name: "billing_system"
      purpose: "usage-based billing"
      interface: "REST API"
    - name: "customer_portal"
      purpose: "status page"
      interface: "WebSocket"
    - name: "incident_management"
      purpose: "incident correlation"
      interface: "Webhook"

compliance:
  frameworks:
    - "ISO-27001"
    - "SOC2"
    - "GDPR"
    
  audit_requirements:
    - "performance_data_retention_1_year"
    - "sla_compliance_reporting"
    - "incident_documentation"
    - "change_impact_analysis"
