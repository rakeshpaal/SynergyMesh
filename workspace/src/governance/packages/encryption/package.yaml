# =============================================================================
# SynergyMesh Governance - Encryption Package
# Cryptographic utilities for governance security
# =============================================================================

apiVersion: governance.machinenativeops.io/v2
kind: Package
metadata:
  name: encryption
  version: "1.0.0"
  description: "Cryptographic utilities for data protection and signing"
  owner: governance-bot
  created_at: "2025-12-11T00:00:00Z"

spec:
  type: utility
  language: python

  exports:
    - name: KeyManager
      type: class
      description: "Cryptographic key management"
    - name: Signer
      type: class
      description: "Digital signature creation and verification"
    - name: Encryptor
      type: class
      description: "Data encryption and decryption"
    - name: HashGenerator
      type: class
      description: "Cryptographic hash generation"
    - name: sign_data
      type: function
      description: "Sign data with private key"
    - name: verify_signature
      type: function
      description: "Verify digital signature"
    - name: encrypt
      type: function
      description: "Encrypt sensitive data"
    - name: hash
      type: function
      description: "Generate cryptographic hash"

  dependencies:
    required:
      - name: cryptography
        version: ">=41.0.0"
      - name: pynacl
        version: ">=1.5.0"
    optional:
      - name: hashicorp-vault
        version: ">=0.3.0"
      - name: aws-kms
        version: ">=1.0.0"

  configuration:
    key_backend:
      type: string
      enum: [local, vault, aws-kms, azure-keyvault, gcp-kms]
      default: local
    default_algorithm:
      encryption:
        type: string
        default: "AES-256-GCM"
      signing:
        type: string
        default: "Ed25519"
      hashing:
        type: string
        default: "SHA-256"
    key_rotation:
      enabled:
        type: boolean
        default: true
      interval_days:
        type: integer
        default: 90

  interfaces:
    - name: sign
      inputs:
        - name: data
          type: bytes
        - name: key_id
          type: string
      outputs:
        - name: signature
          type: string
        - name: algorithm
          type: string
        - name: key_id
          type: string

  compliance:
    standards:
      - FIPS-140-2
      - ISO-27001
    requirements:
      - "Keys must be stored securely"
      - "Key rotation must be automated"
      - "All operations must be audited"
