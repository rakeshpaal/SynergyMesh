# =============================================================================
# SynergyMesh Governance - Notification Package
# Multi-channel notification utilities
# =============================================================================

apiVersion: governance.machinenativeops.io/v2
kind: Package
metadata:
  name: notification
  version: "1.0.0"
  description: "Multi-channel notification and alerting"
  owner: governance-bot
  created_at: "2025-12-11T00:00:00Z"

spec:
  type: utility
  language: python

  exports:
    - name: NotificationManager
      type: class
      description: "Multi-channel notification orchestration"
    - name: AlertManager
      type: class
      description: "Alert routing and escalation"
    - name: TemplateEngine
      type: class
      description: "Notification template rendering"
    - name: send_notification
      type: function
      description: "Send notification via configured channels"
    - name: send_alert
      type: function
      description: "Send alert with escalation"

  dependencies:
    required:
      - name: logging
        type: internal
        version: "1.0.0"
      - name: jinja2
        version: ">=3.1.0"
    optional:
      - name: slack-sdk
        version: ">=3.0.0"
      - name: sendgrid
        version: ">=6.0.0"
      - name: pagerduty
        version: ">=5.0.0"

  configuration:
    channels:
      email:
        enabled:
          type: boolean
          default: true
        provider:
          type: string
          enum: [smtp, sendgrid, ses]
      slack:
        enabled:
          type: boolean
          default: true
        webhook_url:
          type: string
          secret: true
      pagerduty:
        enabled:
          type: boolean
          default: false
        api_key:
          type: string
          secret: true
    routing:
      default_channel:
        type: string
        default: slack
      severity_routing:
        critical:
          type: array
          default: [pagerduty, slack, email]
        high:
          type: array
          default: [slack, email]
        medium:
          type: array
          default: [slack]
        low:
          type: array
          default: [email]

  interfaces:
    - name: notify
      inputs:
        - name: type
          type: string
        - name: severity
          type: string
        - name: message
          type: string
        - name: recipients
          type: array
        - name: context
          type: object
      outputs:
        - name: notification_id
          type: string
        - name: channels_sent
          type: array
        - name: status
          type: string

  compliance:
    - "Notifications must be logged"
    - "PII must be masked in notifications"
    - "Escalation policies must be followed"
