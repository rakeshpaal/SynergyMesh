{
  "$schema": "./schemas/shared.schema.json",
  "version": "1.0.0",
  "timestamp": "2025-12-11T00:00:00Z",
  "metadata": {
    "name": "Shared Resources Registry",
    "description": "橫切資源索引 - 跨維度共享的基礎設施和工具",
    "purpose": "讓機器知道哪些資源是共享的，避免重複初始化"
  },
  "shared_resources": [
    {
      "name": "events",
      "path": "index/events/",
      "purpose": "Event persistence and shared memory - REQUIRED for all agents",
      "type": "memory",
      "audit_log": true,
      "consumers": ["all"],
      "files": {
        "registry": "index/events/registry.json",
        "session": "index/events/current-session.json",
        "vectors": "index/events/vector-index.json",
        "bootstrap": "index/events/bootstrap-contract.json"
      },
      "execution": {
        "priority": 0,
        "latency": "<=5s",
        "required": true,
        "bootstrap_required": true
      },
      "description": "解決代理失憶問題 - 所有代理啟動前必須讀取此資源"
    },
    {
      "name": "ci",
      "path": "ci/",
      "purpose": "CI/CD workflows and pipeline configurations",
      "type": "infrastructure",
      "audit_log": true,
      "consumers": ["all"],
      "files": {
        "workflows": "ci/workflows/",
        "actions": "ci/actions/",
        "templates": "ci/templates/"
      },
      "execution": {
        "priority": 1,
        "latency": "<=60s",
        "required": true
      }
    },
    {
      "name": "policies",
      "path": "policies/",
      "purpose": "OPA/Conftest policy files for governance validation",
      "type": "policy_engine",
      "audit_log": true,
      "consumers": ["10-policy", "05-compliance", "06-security", "30-agents"],
      "engine": "OPA",
      "format": "Rego",
      "execution": {
        "priority": 1,
        "latency": "<=5s",
        "required": true
      }
    },
    {
      "name": "schemas",
      "path": "schemas/",
      "purpose": "JSON Schema definitions for validation",
      "type": "validation",
      "audit_log": true,
      "consumers": ["31-schemas", "all"],
      "format": "JSON Schema Draft-07",
      "execution": {
        "priority": 1,
        "latency": "<=1s",
        "required": true
      }
    },
    {
      "name": "scripts",
      "path": "scripts/",
      "purpose": "Utility and automation scripts",
      "type": "automation",
      "audit_log": true,
      "consumers": ["35-scripts", "39-automation"],
      "languages": ["Python", "Shell", "TypeScript"],
      "execution": {
        "priority": 2,
        "latency": "<=30s",
        "required": false
      }
    },
    {
      "name": "packages",
      "path": "packages/",
      "purpose": "Reusable governance packages",
      "type": "library",
      "audit_log": true,
      "consumers": ["36-modules", "33-common"],
      "execution": {
        "priority": 2,
        "latency": "<=10s",
        "required": false
      }
    },
    {
      "name": "dimensions",
      "path": "dimensions/",
      "purpose": "Dimension metadata registry (00-80)",
      "type": "metadata",
      "audit_log": true,
      "consumers": ["all"],
      "execution": {
        "priority": 1,
        "latency": "<=1s",
        "required": true
      }
    },
    {
      "name": "index",
      "path": "index/",
      "purpose": "Governance index files (SSOT)",
      "type": "index",
      "audit_log": true,
      "consumers": ["all"],
      "execution": {
        "priority": 0,
        "latency": "<=1s",
        "required": true
      }
    }
  ],
  "dependency_injection": {
    "description": "共享資源的依賴注入配置",
    "injection_order": [
      "events",
      "schemas",
      "policies",
      "dimensions",
      "index",
      "ci",
      "scripts",
      "packages"
    ],
    "lazy_load": ["packages", "scripts"],
    "eager_load": ["events", "schemas", "policies", "index"],
    "bootstrap_first": ["events"]
  },
  "resource_locks": {
    "enabled": true,
    "lock_timeout": "30s",
    "deadlock_detection": true,
    "retry_policy": {
      "max_retries": 3,
      "backoff": "exponential",
      "initial_delay": "100ms"
    }
  },
  "cache_config": {
    "enabled": true,
    "ttl": "300s",
    "invalidation": {
      "on_file_change": true,
      "on_config_change": true
    },
    "cache_layers": [
      {"layer": "memory", "size": "100MB", "ttl": "60s"},
      {"layer": "disk", "size": "1GB", "ttl": "3600s"}
    ]
  }
}
