{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schema.superroot.kn/mndoc/entity/system/v1",
  "title": "System Entity Schema",
  "description": "定義系統本體實體結構。Defines the structure for System entities representing the top-level system definition.",
  "type": "object",
  "required": ["$schema", "entity", "id", "title", "version", "domain", "layer", "subsystems"],
  "properties": {
    "$schema": {
      "type": "string",
      "const": "https://schema.superroot.kn/mndoc/entity/system/v1",
      "description": "Schema namespace identifier"
    },
    "entity": {
      "type": "string",
      "const": "System",
      "description": "Entity type discriminator"
    },
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9]+([a-z0-9-]*[a-z0-9])?$",
      "description": "System identifier (slug format)"
    },
    "title": {
      "type": "string",
      "description": "Human-readable system name"
    },
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "System version (semantic versioning)"
    },
    "description": {
      "type": "string",
      "description": "System description"
    },
    "domain": {
      "type": "string",
      "description": "Primary business/technical domain"
    },
    "layer": {
      "type": "string",
      "enum": ["control-plane", "data-plane", "governance", "automation"],
      "description": "Primary architecture layer"
    },
    "subsystems": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9]+([a-z0-9-]*[a-z0-9])?$"
      },
      "minItems": 1,
      "description": "List of subsystem identifiers"
    },
    "criticality": {
      "type": "string",
      "enum": ["low", "medium", "high", "critical"],
      "description": "System criticality level"
    },
    "slo": {
      "type": "object",
      "properties": {
        "latency_ms": {
          "type": "integer",
          "minimum": 0,
          "description": "Target latency in milliseconds"
        },
        "availability_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Target availability percentage"
        },
        "error_budget_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Error budget percentage"
        }
      },
      "description": "Service Level Objectives"
    },
    "owner": {
      "type": "string",
      "description": "System owner (team or individual)"
    },
    "status": {
      "type": "string",
      "enum": ["draft", "active", "deprecated", "archived"],
      "description": "System lifecycle status"
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Classification tags"
    },
    "evidence_ref": {
      "type": "object",
      "properties": {
        "sbom": { "type": "string" },
        "signature": { "type": "string" },
        "slsa_ref": { "type": "string" }
      },
      "description": "Supply chain evidence references"
    },
    "meta": {
      "type": "object",
      "description": "Additional metadata"
    }
  },
  "additionalProperties": false
}
