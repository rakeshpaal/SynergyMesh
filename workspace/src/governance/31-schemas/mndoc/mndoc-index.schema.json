{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schema.superroot.kn/mndoc/index/v1",
  "title": "MN-DOC Index Schema v1",
  "description": "定義機器原生文檔索引結構。Schema for the MN-DOC knowledge layer master index.",
  "type": "object",
  "required": ["$schema", "version", "id", "namespace", "title", "entities"],
  "properties": {
    "$schema": {
      "type": "string",
      "const": "https://schema.superroot.kn/mndoc/index/v1",
      "description": "Schema namespace identifier"
    },
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Index version"
    },
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9]+([a-z0-9-]*[a-z0-9])?$",
      "description": "Index identifier"
    },
    "namespace": {
      "type": "string",
      "description": "Namespace for this index"
    },
    "title": {
      "type": "string",
      "description": "Human-readable title"
    },
    "last_updated": {
      "type": "string",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
      "description": "Last update date"
    },
    "schemas": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      },
      "description": "Schema file references"
    },
    "mapping_rules": {
      "type": "string",
      "description": "Path to mapping rules file"
    },
    "entities": {
      "type": "object",
      "properties": {
        "system": {
          "type": "object",
          "required": ["path", "id"],
          "properties": {
            "path": { "type": "string" },
            "id": { "type": "string" },
            "schema": { "type": "string" }
          }
        },
        "subsystems": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["path", "id"],
            "properties": {
              "path": { "type": "string" },
              "id": { "type": "string" },
              "schema": { "type": "string" }
            }
          }
        },
        "components": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["path"],
            "properties": {
              "path": { "type": "string" },
              "ids": {
                "type": "array",
                "items": { "type": "string" }
              },
              "schema": { "type": "string" }
            }
          }
        },
        "governance": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["path", "id"],
            "properties": {
              "path": { "type": "string" },
              "id": { "type": "string" },
              "schema": { "type": "string" }
            }
          }
        }
      },
      "description": "Entity registry"
    },
    "cross_references": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      },
      "description": "Cross-references to other config files"
    },
    "provenance": {
      "type": "object",
      "properties": {
        "slsa": {
          "type": "object",
          "properties": {
            "level": { "type": "string" },
            "generator": { "type": "string" },
            "attestation_path": { "type": "string" }
          }
        },
        "sbom": {
          "type": "object",
          "properties": {
            "format": { "type": "string" },
            "output_path": { "type": "string" }
          }
        },
        "signature": {
          "type": "object",
          "properties": {
            "provider": { "type": "string" },
            "keyless": { "type": "boolean" },
            "output_path": { "type": "string" }
          }
        }
      },
      "description": "Provenance configuration"
    },
    "validation": {
      "type": "object",
      "description": "Validation configuration"
    },
    "statistics": {
      "type": "object",
      "description": "Index statistics"
    }
  },
  "additionalProperties": false
}
