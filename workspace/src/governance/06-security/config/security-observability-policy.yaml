name: Security & Observability Governance Policy
description: Aligns governance enforcement with Skeleton #4 (security-observability) source-of-truth assets
version: "1.0"
skeleton:
  id: "security-observability"
  source_of_truth:
    base: "repo://${SKELETON_REPO:-unmanned-engineer-ceo}/80-skeleton-configs/04-security-observability/"
    files:
      security_model: "docs/security-model.md"
      observability_standards: "docs/observability-standards.md"
      rbac_policies: "config/rbac-policies.yaml"
      log_schema: "config/log-schema.json"
      trace_config: "config/trace-config.yaml"
      security_scan: "tools/security-scan.ts"
      log_validator: "tools/log-validator.ts"
  implementation: "repo://${AUTOMATION_REPO:-automation}/autonomous/security-observability/"
  implementation_notes: "Runtime enforcement hooks, OTEL collectors, and policy agents live in automation/autonomous/security-observability"

enforcement: strict

controls:
  authentication:
    required_flows:
      - "OAuth 2.0 Authorization Code (PKCE)"
      - "Service Account (JWT RS256)"
      - "API Key (hashed with bcrypt)"
    secrets_logging: prohibited
  authorization:
    model: ["RBAC", "ABAC"]
    rbac_roles:
      - super_admin
      - tenant_admin
      - project_admin
      - developer
      - viewer
    policy_reference: "repo://${SKELETON_REPO:-unmanned-engineer-ceo}/80-skeleton-configs/04-security-observability/config/rbac-policies.yaml"
    abac_policies:
      - "tenant_id isolation required"
      - "project membership attribute checks"
  audit_logging:
    log_schema: "config/log-schema.json"
    mandatory_events:
      - auth_failure
      - permission_change
      - sensitive_read
      - config_change
      - data_delete
  observability:
    log_schema: "config/log-schema.json"
    trace_config: "config/trace-config.yaml"
    metrics:
      red: ["request_rate", "error_rate", "duration"]
      use: ["utilization", "saturation", "errors"]
    sampling:
      default: "10%"
      errors: "100%"
      health_checks: "1%"
  tooling:
    security_scan: "tools/security-scan.ts"
    log_validator: "tools/log-validator.ts"
    execution:
      - "npm install"
      - "npx ts-node tools/security-scan.ts <glob-patterns>"
      - "npx ts-node tools/log-validator.ts config/log-schema.json <log-file>"

compliance_metrics:
  - name: "Auth Coverage"
    threshold: 100
    frequency: "continuous"
  - name: "RBAC Policy Adoption"
    threshold: 95
    frequency: "weekly"
  - name: "Structured Logging Compliance"
    threshold: 100
    frequency: "continuous"
  - name: "Trace Coverage"
    threshold: 90
    frequency: "bi-weekly"
