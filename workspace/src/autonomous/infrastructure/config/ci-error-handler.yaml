# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#                    SynergyMesh CI Error Handler Configuration
#                    CI éŒ¯èª¤è™•ç†é…ç½® (Phase 12)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ“‹ å®Œæ•´è§£æ±ºæ–¹æ¡ˆé…ç½®è«‹åƒè€ƒ: config/ci-comprehensive-solution.yaml
#

ci_error_handler:
  version: "1.1.0"
  enabled: true
  comprehensive_solution: "config/ci-comprehensive-solution.yaml"

# Error Categories
error_categories:
  - BUILD_ERROR
  - TEST_FAILURE
  - LINT_ERROR
  - TYPE_ERROR
  - DEPENDENCY_ERROR
  - SECURITY_SCAN
  - DEPLOYMENT_ERROR
  - STARTUP_FAILURE        # æ–°å¢: GitHub Actions å•Ÿå‹•å¤±æ•—
  - PERMISSION_ERROR       # æ–°å¢: æ¬Šé™éŒ¯èª¤
  - NETWORK_ERROR          # æ–°å¢: ç¶²è·¯éŒ¯èª¤

# Error Patterns
error_patterns:
  # GitHub Actions ç‰¹å®šéŒ¯èª¤
  startup_failure:
    pattern: "startup_failure|Workflow failed to start"
    category: STARTUP_FAILURE
    auto_fixable: true
    fix_command: null
    fix_description: "ç§»é™¤ job-level permissions å€å¡Šï¼ˆç”¨æ–¼ reusable workflows æ™‚ï¼‰"
    
  permission_error:
    pattern: "Resource not accessible by integration|Permission denied"
    category: PERMISSION_ERROR
    auto_fixable: false
    
  action_not_found:
    pattern: "Unable to resolve action|Could not find action"
    category: DEPENDENCY_ERROR
    auto_fixable: true
    fix_description: "æ›´æ–° Action åˆ°æœ€æ–°ç©©å®šç‰ˆæœ¬"

  # åŸæœ‰éŒ¯èª¤æ¨¡å¼
  eslint:
    pattern: "error\\s+.*eslint"
    category: LINT_ERROR
    auto_fixable: true
    fix_command: "npm run lint -- --fix"
  
  prettier:
    pattern: "Prettier.*check failed"
    category: LINT_ERROR
    auto_fixable: true
    fix_command: "npm run format"
  
  typescript:
    pattern: "error TS\\d+"
    category: TYPE_ERROR
    auto_fixable: false
  
  jest:
    pattern: "FAIL.*\\.test\\."
    category: TEST_FAILURE
    auto_fixable: false
  
  npm_audit:
    pattern: "npm audit.*vulnerabilities"
    category: SECURITY_SCAN
    auto_fixable: true
    fix_command: "npm audit fix"
    
  npm_ci_failure:
    pattern: "npm ERR!|Exit handler never called"
    category: DEPENDENCY_ERROR
    auto_fixable: true
    fix_command: "rm -rf node_modules package-lock.json && npm install"
    
  docker_error:
    pattern: "docker.*failed|Error response from daemon"
    category: BUILD_ERROR
    auto_fixable: true
    fix_command: "docker system prune -a --volumes"
    
  network_timeout:
    pattern: "ETIMEDOUT|ECONNREFUSED|network timeout"
    category: NETWORK_ERROR
    auto_fixable: false

# Issue Management
issue_management:
  auto_create: true
  
  labels:
    BUILD_ERROR: ["ci-failure", "build"]
    TEST_FAILURE: ["ci-failure", "test"]
    LINT_ERROR: ["ci-failure", "lint", "auto-fixable"]
    TYPE_ERROR: ["ci-failure", "typescript"]
    DEPENDENCY_ERROR: ["ci-failure", "dependencies"]
    SECURITY_SCAN: ["ci-failure", "security"]
    DEPLOYMENT_ERROR: ["ci-failure", "deployment"]
  
  assignees:
    enabled: true
    use_codeowners: true
  
  duplicate_detection: true
  
  templates:
    title: "[CI Failure] {workflow_name}: {error_category}"
    body: |
      ## CI Failure Report
      
      **Workflow:** {workflow_name}
      **Run ID:** {run_id}
      **Branch:** {branch}
      **Commit:** {commit_sha}
      
      ### Error Details
      ```
      {error_details}
      ```
      
      ### Suggested Fix
      {suggested_fix}
      
      ### Links
      - [Workflow Run]({run_url})
      - [Commit]({commit_url})

# Auto Fix
auto_fix:
  enabled: true
  
  safe_fixes:
    - lint_errors
    - formatting
    - dependency_audit
    - import_sorting
  
  create_pr: true
  pr_template:
    title: "[Auto-Fix] {error_category} in {workflow_name}"
    body: |
      ## Automated Fix
      
      This PR was automatically generated to fix CI errors.
      
      **Original Issue:** #{issue_number}
      **Error Category:** {error_category}
      
      ### Changes Made
      {changes_description}
      
      ### Verification
      - [ ] Tests pass
      - [ ] Lint passes
      - [ ] Build succeeds

# Status Tracking
status_tracking:
  statuses:
    - PENDING
    - IN_PROGRESS
    - PR_CREATED
    - VERIFIED
    - CLOSED
  
  metrics:
    track_fix_rate: true
    track_time_to_fix: true
    track_auto_vs_manual: true
