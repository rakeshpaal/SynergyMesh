# MachineNativeOps AAPS Core Engine Configuration
apiVersion: machinenativeops.io/v1
kind: AAPS Engine
metadata:
  name: aaps-core-engine
  version: "1.0.0"
  description: "AI Architecture & Artifact Provisioning System Core Engine"
spec:
  # Engine capabilities
  capabilities:
    - "architecture-definition"
    - "artifact-provisioning"
    - "gate-orchestration"
    - "spec-validation"
    - "policy-enforcement"
    - "registry-management"
    - "evidence-generation"
    - "supply-chain-governance"

  # Core engine configuration
  engine:
    # Execution mode
    mode: "production"
    
    # Resource allocation
    resources:
      memory: "2Gi"
      cpu: "1000m"
      storage: "10Gi"
    
    # Concurrency settings
    concurrency:
      max_concurrent_operations: 10
      operation_timeout: "5m"
      queue_size: 100
    
    # Retry configuration
    retry:
      max_attempts: 3
      backoff_strategy: "exponential"
      initial_delay: "1s"
      max_delay: "30s"

  # Architecture definition
  architecture:
    # System architecture
    system:
      type: "microservices"
      communication: "async"
      discovery: "service-mesh"
      
    # Data architecture
    data:
      storage: "distributed"
      consistency: "eventual"
      backup: "continuous"
      
    # Security architecture
    security:
      authentication: "mfa"
      authorization: "rbac"
      encryption: "aes-256"

  # Artifact provisioning
  provisioning:
    # Source repositories
    sources:
      - type: "git"
        url: "https://github.com/MachineNativeOps/MachineNativeOps"
        branch: "main"
      - type: "registry"
        url: "docker.io/machinenativeops"
      
    # Provisioning strategies
    strategies:
      - name: "blue-green"
        description: "Blue-green deployment strategy"
        enabled: true
        
      - name: "canary"
        description: "Canary deployment strategy"
        enabled: true
        initial_weight: 10
        
      - name: "rolling"
        description: "Rolling update strategy"
        enabled: true
        max_unavailable: 1
        max_surge: 1

  # Gate orchestration
  gates:
    # Gate definitions
    definitions:
      validation-gate:
        name: "validation-gate"
        type: "validation"
        description: "Validates configuration and compliance"
        enabled: true
        
      security-gate:
        name: "security-gate"
        type: "security"
        description: "Security and vulnerability scanning"
        enabled: true
        
      performance-gate:
        name: "performance-gate"
        type: "performance"
        description: "Performance benchmarking"
        enabled: true
    
    # Gate execution
    execution:
      parallel: false
      continue_on_failure: false
      timeout: "10m"
      retry_on_failure: true

  # Integration configuration
  integrations:
    # Monitoring integration
    monitoring:
      prometheus:
        enabled: true
        endpoint: "http://prometheus:9090"
        metrics_path: "/metrics"
      
      grafana:
        enabled: true
        endpoint: "http://grafana:3000"
        dashboard_path: "/d/machine-native-ops"
    
    # Logging integration
    logging:
      elasticsearch:
        enabled: true
        endpoint: "http://elasticsearch:9200"
        index_pattern: "machine-native-ops-*"
      
      loki:
        enabled: true
        endpoint: "http://loki:3100"
        
    # Notification integration
    notifications:
      slack:
        enabled: true
        webhook_url: "${SLACK_WEBHOOK_URL}"
        channel: "#machine-native-ops"
        
      email:
        enabled: true
        smtp_server: "${SMTP_SERVER}"
        smtp_port: 587
        username: "${SMTP_USERNAME}"
        password: "${SMTP_PASSWORD}"

  # Performance tuning
  performance:
    # Caching configuration
    cache:
      type: "redis"
      endpoint: "redis://redis:6379"
      ttl: "1h"
      max_size: "1GB"
    
    # Connection pooling
    connection_pool:
      max_connections: 100
      max_idle_connections: 10
      connection_timeout: "30s"
      idle_timeout: "5m"
    
    # Batch processing
    batch:
      size: 100
      timeout: "1m"
      max_wait_time: "5s"

status:
  created: "2025-12-21T05:14:00Z"
  updated: "2025-12-21T05:14:00Z"
  version: "1.0.0"
  phase: "operational"
  health_status: "healthy"
  last_health_check: "2025-12-21T05:14:00Z"
  validated: true