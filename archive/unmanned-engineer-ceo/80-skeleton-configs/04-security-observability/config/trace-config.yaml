attribute_filters:
  exclude:
  - http.request.header.authorization
  - http.request.header.cookie
  - http.request.body
  - db.statement
  mask:
  - attribute: user.email
    pattern: (.{3}).*(@.*)
    replacement: $1***$2
  - attribute: user.phone
    pattern: (.{3}).*(.{4})
    replacement: $1***$2
exporters:
  otlp:
    compression: gzip
    endpoint: http://otel-collector:4317
    protocol: grpc
    retry:
      enabled: true
      initial_interval: 5s
      max_elapsed_time: 300s
      max_interval: 30s
    timeout: 10s
instrumentations:
  database:
    capture_statement: false
    capture_statement_hash: true
    enabled: true
  grpc:
    enabled: true
  http:
    capture_body: false
    capture_headers: true
    enabled: true
  message_queue:
    enabled: true
  redis:
    enabled: true
required_attributes:
- service.name
- service.version
- deployment.environment
- trace.id
- span.id
resource:
  cloud.provider: ${CLOUD_PROVIDER:-unknown}
  cloud.region: ${CLOUD_REGION:-unknown}
  deployment.environment: ${ENVIRONMENT}
  service.name: ${SERVICE_NAME}
  service.version: ${SERVICE_VERSION}
sampling:
  default:
    ratio: 0.1
    type: parent_based_trace_id_ratio
  rules:
  - condition:
      attribute: http.status_code
      operator: gte
      value: 500
    sampler:
      type: always_on
  - condition:
      attribute: http.url.path
      operator: equals
      value: /health
    sampler:
      ratio: 0.01
      type: trace_id_ratio
  - condition:
      attribute: http.url.path
      operator: starts_with
      value: /api/v1/critical
    sampler:
      ratio: 0.5
      type: trace_id_ratio
span_processors:
- config:
    export_timeout: 30s
    max_export_batch_size: 512
    max_queue_size: 2048
    schedule_delay: 5s
  type: batch
version: 1.0.0
