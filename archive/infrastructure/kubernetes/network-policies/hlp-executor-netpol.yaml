apiVersion: machinenativeops.io/v2
kind: NetworkPolicy
metadata:
  annotations:
    machinenativeops.io/description: Network policy for HLP Executor Core - restricts
      ingress and egress traffic
  labels:
    machinenativeops.io/app: hlp-executor-core
    machinenativeops.io/component: execution-engine
  name: hlp-executor-core-netpol
  namespace: machinenativenops
spec:
  egress:
  - ports:
    - port: 53
      protocol: UDP
    - port: 53
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
  - ports:
    - port: 443
      protocol: TCP
    - port: 6443
      protocol: TCP
    to:
    - namespaceSelector: {}
      podSelector:
        matchLabels:
          component: apiserver
  - ports:
    - port: 8080
      protocol: TCP
    - port: 50051
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          name: unmanned-island-system
  - ports:
    - port: 5432
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          name: unmanned-island-system
      podSelector:
        matchLabels:
          app: postgresql
  - ports:
    - port: 6379
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          name: unmanned-island-system
      podSelector:
        matchLabels:
          app: redis
  - ports:
    - port: 9090
      protocol: TCP
    - port: 3000
      protocol: TCP
    - port: 14268
      protocol: TCP
    - port: 4317
      protocol: TCP
    to:
    - namespaceSelector:
        matchLabels:
          name: monitoring
  - ports:
    - port: 443
      protocol: TCP
    to:
    - namespaceSelector: {}
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: unmanned-island-system
    ports:
    - port: 8080
      protocol: TCP
    - port: 50051
      protocol: TCP
    - port: 9090
      protocol: TCP
  - from:
    - namespaceSelector:
        matchLabels:
          name: monitoring
      podSelector:
        matchLabels:
          app: prometheus
    ports:
    - port: 9090
      protocol: TCP
  podSelector:
    matchLabels:
      app: hlp-executor-core
  policyTypes:
  - Ingress
  - Egress
