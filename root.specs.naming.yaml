apiVersion: machinenativeops.io/v1
kind: RootNamingSpec
metadata:
  name: root-naming-specification
  namespace: machinenativenops
  labels:
    machinenativeops.io/tier: specs
    machinenativeops.io/version: v1.0.0
    machinenativeops.io/component: naming-spec
  annotations:
    machinenativeops.io/description: Machine-verifiable naming conventions for root
      layer
    machinenativeops.io/enforcement: strict
    machinenativeops.io/last-modified: '2025-12-21T02:00:00Z'
spec:
  version: 1
  scope:
    include_paths:
    - ^root\..*\.yaml$
    - ^root\..*\.map$
    - ^root\..*\.sh$
    exclude_paths:
    - ^archive/.*
    - ^tmp/.*
  naming_rules:
    yaml_keys:
      description: 所有 YAML 鍵必須使用 snake_case
      pattern: ^[a-z][a-z0-9_]*$
      examples:
        valid:
        - module_name
        - api_version
        - health_check
        - auto_start
        invalid:
        - moduleName
        - ModuleName
        - module-name
        - MODULE_NAME
      exceptions:
      - pattern: ^[A-Z][A-Z0-9_]*$
        context: environment variables only
        examples:
        - GOVERNANCE_MODE
        - API_KEY
        - DB_HOST
    module_names:
      description: 模組名稱必須使用 kebab-case
      pattern: ^[a-z][a-z0-9-]*[a-z0-9]$
      min_length: 3
      max_length: 50
      examples:
        valid:
        - governance-engine
        - trust-manager
        - config-manager
        - api-gateway
        invalid:
        - GovernanceEngine
        - governance_engine
        - a
        - governance-
    version_format:
      description: 版本號必須符合 Semantic Versioning 2.0.0
      pattern: ^v?\d+\.\d+\.\d+(-[a-z0-9.-]+)?(\+[a-z0-9.-]+)?$
      examples:
        valid:
        - 1.0.0
        - v1.0.0
        - 2.1.3-alpha
        - 1.0.0-beta.1
        - 1.0.0+20130313144700
        invalid:
        - '1.0'
        - v1
        - 1.0.0.0
    api_version:
      description: API 版本必須使用 domain/version 格式
      pattern: ^[a-z0-9.-]+/v\d+$
      examples:
        valid:
        - machinenativeops.io/v1
        - machinenativeops.io/v2
        - k8s.io/v1
        invalid:
        - v1
        - machinenativeops/v1
        - machinenativeops.io/1
    kind_names:
      description: Kind 必須使用 PascalCase 並以 Root 開頭
      pattern: ^Root[A-Z][a-zA-Z0-9]*$
      examples:
        valid:
        - RootModulesConfig
        - RootGovernanceConfig
        - RootBootstrapConfig
        invalid:
        - rootModulesConfig
        - ModulesConfig
        - Root_Config
    label_keys:
      description: 標籤鍵必須使用 domain/key 格式
      pattern: ^[a-z0-9.-]+/[a-z][a-z0-9-]*$
      examples:
        valid:
        - machinenativeops.io/tier
        - machinenativeops.io/version
        - machinenativeops.io/component
        invalid:
        - tier
        - machinenativeops.io/Tier
        - machinenativeops/tier
    file_names:
      description: Root 層檔案必須使用 root.<category>.<ext> 格式
      pattern: ^root\.[a-z][a-z0-9-]*\.(yaml|map|sh)$
      examples:
        valid:
        - root.config.yaml
        - root.modules.yaml
        - root.devices.map
        - root.env.sh
        invalid:
        - config.yaml
        - root.Config.yaml
        - root.config.yml
        - root config.yaml
    directory_names:
      description: 目錄名稱必須使用小寫字母和點號
      pattern: ^[a-z][a-z0-9.]*[a-z0-9]$
      examples:
        valid:
        - init.d
        - bin
        - etc
        - var
        invalid:
        - Init.d
        - init-d
        - init_d
  value_formats:
    namespace:
      pattern: ^[a-z][a-z0-9-]*$
      examples:
        valid:
        - machinenativenops-modules
        - machinenativenops-specs
        invalid:
        - MachineNativeOps-Modules
        - machinenativeops_modules
    description:
      min_length: 10
      max_length: 200
      pattern: ^[A-Z].*[^.]$
      examples:
        valid:
        - Core governance and policy enforcement engine
        invalid:
        - core governance
        - Core governance.
    file_path:
      pattern: ^/[a-z0-9/_-]+$
      examples:
        valid:
        - /opt/machinenativenops/modules/governance-engine/main.py
        invalid:
        - /Opt/MachineNativeOps/Modules/Main.py
    endpoint:
      pattern: ^/[a-z0-9/_-]*$
      examples:
        valid:
        - /health
        - /api/v1/status
        - /metrics
        invalid:
        - /Health
        - /API/V1/Status
    duration:
      pattern: ^\d+[smhd]$
      examples:
        valid:
        - 30s
        - 5m
        - 1h
        - 7d
        invalid:
        - '30'
        - 5 minutes
        - 1hour
    resource_quantity:
      pattern: ^\d+[mMGT]i?$
      examples:
        valid:
        - 200m
        - 256Mi
        - 1Gi
        - 100Mi
        invalid:
        - '200'
        - 256MB
        - 1G
  consistency_rules:
  - id: NAMING-001
    description: 同一檔案內的 metadata.name 必須與檔案用途一致
    check: metadata.name 應包含檔案類型關鍵字
    examples:
    - file: root.modules.yaml
      valid_names:
      - modules-registry-config
      - modules-config
      invalid_names:
      - config
      - root-config
  - id: NAMING-002
    description: 模組名稱在所有檔案中必須一致
    check: 同一模組在不同檔案中的名稱必須完全相同
    scope:
    - root.modules.yaml
    - root.bootstrap.yaml
    - root.super-execution.yaml
  - id: NAMING-003
    description: 標籤值必須與對應的配置值一致
    check: labels.machinenativeops.io/version 必須與 spec.version 一致
    examples:
      valid:
        labels:
          machinenativeops.io/version: v1.0.0
        spec:
          version: 1.0.0
      invalid:
        labels:
          machinenativeops.io/version: v1.0.0
        spec:
          version: 2.0.0
  forbidden_patterns:
  - pattern: '[A-Z]'
    context: file names
    reason: 檔案名稱禁止大寫字母
    severity: error
  - pattern: \s
    context: file names, keys
    reason: 禁止空白字元
    severity: error
  - pattern: \.yml$
    context: file extensions
    reason: 統一使用 .yaml 而非 .yml
    severity: error
  - pattern: ^[^a-z]
    context: yaml keys
    reason: YAML 鍵必須以小寫字母開頭
    severity: error
  - pattern: '[^a-z0-9_-]'
    context: module names
    reason: 模組名稱只允許小寫字母、數字、連字號
    severity: error
  validation:
    enabled: true
    enforcement_level: strict
    auto_fix: false
    report_format: markdown
    gates:
    - name: gate-root-specs
      workflow: .github/workflows/gate-root-specs.yml
      trigger: pull_request
      paths:
      - root.*.yaml
      - root.*.map
      - root.*.sh
    error_handling:
      on_violation:
      - Block PR merge
      - Add comment with specific violations
      - Provide fix suggestions
      escalation:
        first_violation: Warning + fix suggestions
        second_violation: Block + require manual review
        repeated_violations: Escalate to governance committee
status:
  phase: Active
  conditions:
  - type: Validated
    status: 'True'
    lastTransitionTime: '2025-12-21T02:00:00Z'
    reason: SpecificationComplete
    message: Naming specification is complete and validated
  statistics:
    total_rules: 8
    total_patterns: 15
    total_examples: 50
    coverage: 100%
