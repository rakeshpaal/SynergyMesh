name: ðŸšª Phase 1 Gates
on:
  pull_request:
    branches: [main, develop]
  push:
    branches: [main, develop]
jobs:
  phase1:
    permissions:
      contents: read
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 # v4.2.2
    - name: Setup Python
      uses: actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065 # v5
      with:
        python-version: '3.11'
    - name: Install deps (jsonschema, pyyaml, build)
      run: 'python -m pip install --upgrade pip

        pip install pyyaml jsonschema build

        '
    - name: Gate 1 - Root Schema Gate
      run: 'python tools/root_schema_gate.py

        '
    - name: Gate 2 - Module Graph Gate
      run: 'python tools/module_graph_gate.py

        '
    - name: Gate 3 - Build Recipe Gate (config-manager)
      run: 'python tools/build_module.py config-manager

        '
    - name: Gate 4 - RootFS Assemble Gate
      run: 'python tools/rootfs_assembler.py

        '
    - name: Gate 5 - Evidence Gate (sha3-512 authoritative + sha256 compatibility)
      run: 'python tools/evidence_generator.py

        '
    - name: Upload dist as artifact
      uses: actions/upload-artifact@ea165f8d65b6e75b540449e92b4886f43607fa02 # v4.6.2
      with:
        name: dist
        path: dist/
