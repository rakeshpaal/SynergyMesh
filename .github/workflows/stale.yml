# This workflow warns and then closes issues and PRs that have had no activity for a specified amount of time.
# Based on GitHub Advisory Database's professional stale PR management patterns.
#
# Policy:
# - PRs become stale after 15 days of inactivity
# - Stale PRs are closed after another 15 days (30 days total)
# - Issues are handled separately (not closed by this workflow)
# - PRs with "Keep" label are exempt from stale processing
#
# For more information, see:
# https://github.com/actions/stale
name: Close stale PRs

on:
  schedule:
  - cron: '00 0 * * *'  # runs at 00:00 daily

jobs:
  stale:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      pull-requests: write

    steps:
    - uses: actions/stale@v9.0.0
      name: Clean up stale PRs
      with:
        repo-token: ${{ secrets.GITHUB_TOKEN }}
        stale-pr-message: >
          ðŸ‘‹ This pull request has been marked as stale because it has been open with no activity.
          
          You can:
          - Comment on the issue or remove the stale label to hold stale off for a while
          - Add the `Keep` label to hold stale off permanently
          - Do nothing - this pull request will be closed eventually
          
          Please see CONTRIBUTING.md for more policy details.
        stale-pr-label: 'Stale'
        exempt-pr-labels: 'Keep'
        days-before-pr-stale: 15
        days-before-pr-close: 15
        days-before-issue-stale: -1  # prevents issues from being tagged by the bot
        days-before-issue-close: -1  # prevents issues from being closed by the bot
        ascending: true
