# ═══════════════════════════════════════════════════════════════════════════════
#                    SynergyMesh ESLint Configuration
#                    ESLint 代碼風格配置
# ═══════════════════════════════════════════════════════════════════════════════

root: true

env:
  browser: true
  es2022: true
  node: true
  jest: true

parser: "@typescript-eslint/parser"

parserOptions:
  ecmaVersion: 2022
  sourceType: module
  project:
    - "./tsconfig.json"
    - "./mcp-servers/tsconfig.json"
    - "./core/contract_service/contracts-L1/contracts/tsconfig.json"

plugins:
  - "@typescript-eslint"
  - "import"
  - "prettier"

extends:
  - "eslint:recommended"
  - "plugin:@typescript-eslint/recommended"
  - "plugin:@typescript-eslint/recommended-requiring-type-checking"
  - "plugin:import/recommended"
  - "plugin:import/typescript"
  - "prettier"

settings:
  import/resolver:
    typescript:
      alwaysTryTypes: true
      project:
        - "./tsconfig.json"

rules:
  # TypeScript
  "@typescript-eslint/explicit-function-return-type": warn
  "@typescript-eslint/no-explicit-any": error
  "@typescript-eslint/no-unused-vars":
    - error
    - argsIgnorePattern: "^_"
      varsIgnorePattern: "^_"
  "@typescript-eslint/no-non-null-assertion": warn
  "@typescript-eslint/prefer-nullish-coalescing": error
  "@typescript-eslint/prefer-optional-chain": error
  "@typescript-eslint/strict-boolean-expressions": warn
  "@typescript-eslint/no-floating-promises": error
  "@typescript-eslint/await-thenable": error
  "@typescript-eslint/no-misused-promises": error
  "@typescript-eslint/naming-convention":
    - error
    - selector: default
      format:
        - camelCase
    - selector: variable
      format:
        - camelCase
        - UPPER_CASE
    - selector: parameter
      format:
        - camelCase
      leadingUnderscore: allow
    - selector: memberLike
      modifiers:
        - private
      format:
        - camelCase
      leadingUnderscore: require
    - selector: typeLike
      format:
        - PascalCase
    - selector: enumMember
      format:
        - UPPER_CASE
    - selector: interface
      format:
        - PascalCase
      custom:
        regex: "^I[A-Z]"
        match: false

  # Import
  "import/order":
    - error
    - groups:
        - builtin
        - external
        - internal
        - parent
        - sibling
        - index
      newlines-between: always
      alphabetize:
        order: asc
        caseInsensitive: true
  "import/no-unresolved": error
  "import/no-cycle": error
  "import/no-duplicates": error

  # General
  "prefer-const": error
  "no-console": warn
  "no-debugger": error
  "no-alert": error
  "no-var": error
  "eqeqeq":
    - error
    - always
  "curly":
    - error
    - all
  "max-lines":
    - warn
    - max: 500
      skipBlankLines: true
      skipComments: true
  "complexity":
    - warn
    - 15

  # Prettier
  "prettier/prettier": error

overrides:
  # Test files
  - files:
      - "**/*.test.ts"
      - "**/*.spec.ts"
      - "**/__tests__/**"
    rules:
      "@typescript-eslint/no-explicit-any": off
      "@typescript-eslint/no-non-null-assertion": off
      "max-lines": off

  # Configuration files
  - files:
      - "*.config.ts"
      - "*.config.js"
    rules:
      "@typescript-eslint/no-var-requires": off
      "import/no-default-export": off

ignorePatterns:
  - "node_modules/"
  - "dist/"
  - "build/"
  - "coverage/"
  - "*.min.js"
  - "*.d.ts"
