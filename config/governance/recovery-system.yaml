backup:
  enabled: true
  paths:
    configs: config/
    data: data/
    state: .automation_logs/
  retention:
    daily: 7
    hourly: 24
    monthly: 3
    weekly: 4
  triggers:
  - before_recovery_attempt
  - configuration_change
  - system_upgrade
  - manual_request
  verification:
    enabled: true
    integrity_check: true
    test_restore: false
description: Self-healing system recovery with Dr. Phoenix
escalation:
  enabled: true
  levels:
  - actions:
    - log_event
    - update_metrics
    level: 1
    name: info
    notification: false
    trigger: automatic_recovery_successful
  - actions:
    - log_event
    - send_status_update
    - update_metrics
    level: 2
    name: warning
    notification: false
    trigger: recovery_in_progress
  - actions:
    - log_event
    - alert_team
    - create_incident
    level: 3
    name: alert
    notification: true
    notify_channels:
    - slack
    trigger: multiple_recovery_attempts
  - actions:
    - log_event
    - page_on_call
    - create_critical_incident
    - prepare_for_manual_intervention
    level: 4
    name: critical
    notification: true
    notify_channels:
    - slack
    - email
    - pagerduty
    trigger: all_automatic_recovery_failed
  - actions:
    - log_event
    - page_incident_commander
    - activate_disaster_recovery
    - notify_stakeholders
    level: 5
    name: emergency
    notification: true
    notify_channels:
    - slack
    - email
    - pagerduty
    - phone
    trigger: system_wide_outage
learning:
  enabled: true
  failure_analysis:
    correlation_analysis: true
    enabled: true
    root_cause_detection: true
  pattern_recognition:
    confidence_threshold: 0.8
    enabled: true
    min_samples: 10
  recommendations:
    enabled: true
    suggest_configuration_changes: true
    suggest_infrastructure_improvements: true
    suggest_preventive_measures: true
  strategy_optimization:
    adjustment_frequency: weekly
    duration_weight: 0.5
    enabled: true
    success_weight: 1.0
logging:
  files:
    emergency_recovery: .automation_logs/emergency_recovery.log
    incidents: .automation_logs/incidents.log
    phoenix_agent: .automation_logs/phoenix.log
    watchdog: .automation_logs/watchdog.log
  format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
  include_context: true
  level: INFO
  retention: 30
  structured: true
metadata:
  created_by: SynergyMesh Team
  created_date: '2025-12-09'
  last_updated: '2025-12-09'
  related_files:
  - services/agents/recovery/phoenix_agent.py
  - services/watchdog/system_watchdog.py
  - emergency_recovery.py
  - config/agents/profiles/recovery_expert.yaml
  - docs/PHOENIX_AGENT.md
  - docs/RECOVERY_PLAYBOOK.md
  version: 1.0.0
monitoring:
  critical_components:
  - critical: true
    health_check: process_running
    name: automation_launcher
    pattern: automation_launcher.py
  - critical: true
    health_check: api_endpoint
    name: master_orchestrator
    pattern: master_orchestrator
  - critical: true
    health_check: resource_usage
    name: core_services
    pattern: system_resources
  health_check_interval: 30
  heartbeat:
    enabled: true
    file: .launcher_heartbeat.json
    interval: 20
    timeout: 90
  thresholds:
    cpu_percent:
      critical: 90
      warning: 70
    disk_percent:
      critical: 90
      warning: 80
    memory_percent:
      critical: 90
      warning: 70
    response_time_ms:
      critical: 5000
      warning: 1000
name: SynergyMesh Recovery System
notifications:
  channels:
    email:
      enabled: false
      from_address: phoenix@machinenativeops.ai
      smtp_server: ${SMTP_SERVER}
      to_addresses: []
    pagerduty:
      api_key: ${PAGERDUTY_API_KEY}
      enabled: false
      service_id: ${PAGERDUTY_SERVICE_ID}
    slack:
      channel: '#alerts'
      enabled: false
      webhook_url: ${SLACK_WEBHOOK_URL}
  enabled: true
  templates:
    escalation:
      message: Incident {incident_id} escalated. {details}
      title: 'üö® Dr. Phoenix: Escalation Level {level}'
    recovery_failed:
      message: Failed to recover {component}. Escalating to level {level}
      title: '‚ùå Dr. Phoenix: Recovery Failed'
    recovery_started:
      message: Recovery initiated for {component} using {strategy}
      title: 'ü¶Ö Dr. Phoenix: Recovery Started'
    recovery_success:
      message: Successfully recovered {component} using {strategy}
      title: '‚úÖ Dr. Phoenix: Recovery Successful'
performance:
  max_concurrent_health_checks: 10
  max_concurrent_recoveries: 3
  phoenix_agent:
    max_cpu_percent: 10
    max_memory_mb: 256
    max_threads: 4
  watchdog:
    max_cpu_percent: 5
    max_memory_mb: 128
    max_threads: 2
phoenix_agent:
  enabled: true
  mode: autonomous
  parameters:
    always_running: true
    cannot_be_disabled: true
    independent_process: true
    priority: critical
    startup_delay: 0
  profile: config/agents/profiles/recovery_expert.yaml
recovery:
  max_restart_attempts: 3
  restart_cooldown: 60
  retry_delay: 5
  strategies:
  - actions:
    - terminate_process
    - wait_5_seconds
    - start_process
    conditions:
    - first_attempt
    - process_crashed
    description: Simple process restart
    name: quick_restart
    priority: 1
    rollback_on_failure: false
  - actions:
    - backup_current_config
    - load_minimal_config
    - restart_process
    - verify_startup
    conditions:
    - quick_restart_failed
    - configuration_suspected
    description: Restart with minimal configuration
    name: safe_mode_restart
    priority: 2
    rollback_on_failure: true
  - actions:
    - identify_last_good_config
    - backup_current_config
    - restore_previous_config
    - restart_all_services
    - verify_system
    conditions:
    - safe_mode_failed
    - recent_config_change
    description: Rollback to last known good configuration
    max_rollback_depth: 5
    name: configuration_rollback
    priority: 3
    rollback_on_failure: true
  - actions:
    - identify_dependencies
    - stop_all_dependent_services
    - restart_in_dependency_order
    - verify_all_services
    conditions:
    - configuration_rollback_failed
    - dependency_issues
    description: Restart all dependent services
    name: service_dependency_restart
    priority: 4
    rollback_on_failure: true
  - actions:
    - stop_all_services
    - identify_latest_backup
    - restore_backup
    - restart_all_services
    - verify_system
    conditions:
    - dependency_restart_failed
    - data_corruption
    description: Restore from latest backup
    name: backup_restore
    priority: 5
    requires_approval: true
    rollback_on_failure: false
  - actions:
    - emergency_shutdown
    - run_emergency_recovery_script
    - bootstrap_core_components
    - restore_configurations
    - restart_system
    - full_verification
    conditions:
    - all_other_strategies_failed
    - critical_failure
    description: Complete system rebuild from scratch
    name: full_system_bootstrap
    priority: 6
    requires_approval: true
    rollback_on_failure: false
  strategy_timeout:
    backup_restore: 1800
    configuration_rollback: 300
    full_system_bootstrap: 7200
    quick_restart: 30
    safe_mode_restart: 120
    service_dependency_restart: 600
security:
  audit:
    enabled: true
    include_context: true
    log_all_actions: true
    retention_days: 90
  authentication:
    required: false
  authorization:
    phoenix_agent_permissions:
    - read_logs
    - read_configs
    - write_state
    - restart_services
    - rollback_configs
    requires_approval:
    - data_deletion
    - major_version_rollback
    - infrastructure_changes
testing:
  chaos_engineering:
    enabled: false
    scenarios:
    - random_process_kill
    - configuration_corruption
    - resource_exhaustion
    - network_partition
  health_check_validation:
    enabled: true
    frequency: daily
    verify_all_checks: true
  recovery_drill:
    enabled: false
    frequency: monthly
    scenarios:
    - launcher_crash
    - configuration_error
    - dependency_failure
version: 1.0.0
watchdog:
  check_interval: 30
  enabled: true
  heartbeat_timeout: 90
  independent_process: true
  max_restart_attempts: 5
  monitored_processes:
  - auto_restart: true
    critical: true
    health_checks:
    - process_running
    - heartbeat_alive
    - responding_to_requests
    name: automation_launcher
    pattern: automation_launcher.py
  - auto_restart: true
    critical: true
    health_checks:
    - process_running
    name: phoenix_agent
    pattern: phoenix_agent.py
  restart_cooldown: 300
