api_layer_rules:
  graphql_api:
    allowed_languages:
    - TypeScript
    - Python
    framework_preferences:
      Python:
      - Graphene
      - Strawberry
      TypeScript:
      - Apollo Server
      - Nexus
  grpc_api:
    allowed_languages:
    - TypeScript
    - Go
    - C++
    - Python
    notes: gRPC 用於高性能服務間通訊
  rest_api:
    allowed_languages:
    - TypeScript
    - Go
    - Python
    framework_preferences:
      Go:
      - Gin
      - Echo
      - Chi
      Python:
      - FastAPI
      - Flask
      TypeScript:
      - Express
      - Fastify
      - NestJS
build_rules:
  C++:
    build_system:
    - CMake
    - Bazel
    compiler:
    - g++
    - clang++
    standard: '>=C++17'
  Go:
    build: go build
    output: bin/
    version: '>=1.21'
  Python:
    packaging:
    - setuptools
    - poetry
    runtime: '>=3.10'
    virtual_env: required
  TypeScript:
    bundler:
    - esbuild
    - vite
    - webpack
    compiler: tsc
    output: dist/
ci_checks:
  dependency_analyzer:
    allowed_protocols:
    - HTTP
    - gRPC
    - MCP
    - ROS
    check_cross_language: true
    enabled: true
  documentation_check:
    enabled: true
    files_to_update:
    - docs/architecture/language-stack.md
    - config/language-policy.yaml
    require_on_new_language: true
  language_scanner:
    enabled: true
    fail_on_violation: true
    report_path: reports/language-compliance.json
communication_protocols:
  Any_to_Cpp:
    allowed:
    - gRPC
    - ROS Topics
    - ROS Services
    forbidden:
    - HTTP (for real-time)
    - Direct import
  Python_to_TypeScript:
    allowed:
    - HTTP/REST
    - Message Queue
    - gRPC
    forbidden:
    - Direct import
  Service_to_Service:
    allowed:
    - HTTP/REST
    forbidden:
    - Direct database access
    preferred:
    - gRPC
  TypeScript_to_Python:
    allowed:
    - HTTP/REST
    - gRPC
    - MCP
    forbidden:
    - Direct import
    - Shared memory
dependency_rules:
  monorepo_strategy:
    notes: 使用 workspace 管理多語言 monorepo
    structure: language-agnostic
    tools:
    - npm workspaces
    - pnpm workspaces
  package_managers:
    C++:
    - conan
    - vcpkg
    Go:
    - go modules
    Python:
    - pip
    - poetry
    - uv
    Rust:
    - cargo
    TypeScript:
    - npm
    - pnpm
    - yarn
directory_rules:
  apps/:
    allowed_languages:
    - TypeScript
    - Python
    forbidden_patterns:
    - '*.php'
    - '*.rb'
    notes: 應用層統一使用 TypeScript，Python 僅用於後端分析 API
    primary_language: TypeScript
  apps/web/:
    allowed_languages:
    - TypeScript
    - JavaScript
    forbidden_patterns:
    - '*.py'
    - '*.php'
    framework: React
    notes: Web 前端統一使用 TypeScript + React
    primary_language: TypeScript
  automation/:
    allowed_languages:
    - Python
    - TypeScript
    forbidden_patterns:
    - '*.go'
    - '*.cpp'
    notes: 自動化和編排主要使用 Python，TypeScript 用於與 MCP/CLI 整合
    primary_language: Python
  automation/autonomous/:
    allowed_languages:
    - C++
    - C
    - Python
    - Rust
    forbidden_patterns:
    - '*.ts'
    - '*.js'
    notes: 自主框架底層使用 C++/ROS 2，C 用於 HAL 和硬體驅動，Python 僅用於高層編排
    primary_language: C++
  core/:
    allowed_languages:
    - TypeScript
    - JavaScript
    - Python
    - C++
    forbidden_patterns:
    - '*.php'
    - '*.rb'
    - '*.lua'
    notes: 核心引擎主要使用 TypeScript，JavaScript 允許用於測試配置和遺留兼容性，Python 用於 AI 整合，C++ 僅用於性能關鍵底層
    primary_language: TypeScript
  docs/:
    allowed_languages:
    - Markdown
    - YAML
    - Python
    - TypeScript
    - JavaScript
    - Bash
    notes: 文檔主要使用 Markdown，工具可用 Python/TypeScript，允許 JavaScript/Bash 示例
    primary_language: Markdown
  governance/:
    allowed_languages:
    - Python
    - Rego
    - TypeScript
    - Bash
    forbidden_patterns:
    - '*.go'
    - '*.cpp'
    notes: 治理系統主要使用 Python 處理 YAML/JSON，Rego 用於策略定義，Bash 用於初始化腳本
    primary_language: Python
  infrastructure/:
    allowed_languages:
    - YAML
    - HCL
    - TypeScript
    - Go
    notes: 基礎設施即代碼，主要使用 YAML 和 HCL
    primary_language: YAML
  scripts/:
    allowed_languages:
    - Bash
    - Python
    - TypeScript
    notes: 簡單腳本用 Bash，複雜邏輯用 Python 或 TypeScript
    primary_language: Bash
  services/:
    allowed_languages:
    - Go
    - TypeScript
    - Python
    - Bash
    forbidden_patterns:
    - '*.cpp'
    - '*.php'
    notes: 服務層優先使用 Go（高並發）或 TypeScript（統一開發），Python 僅用於 AI API，Bash 用於運維腳本
    primary_language: Go
    secondary_language: TypeScript
  services/mcp/:
    allowed_languages:
    - TypeScript
    forbidden_patterns:
    - '*.py'
    - '*.go'
    notes: MCP Servers 統一使用 TypeScript 以保持一致性
    primary_language: TypeScript
  tests/:
    allowed_languages:
    - TypeScript
    - JavaScript
    - Python
    - C++
    - Go
    notes: 測試語言應與被測試代碼一致，JavaScript 允許用於 Jest 配置
exceptions:
  permanent_exceptions:
    examples:
    - 遺留系統整合
    - 特定硬體驅動
    - 無可替代的第三方庫
    require_strong_justification: true
  process:
    approval_roles:
    - 架構師
    - 技術委員會
    documentation_required: true
    require_approval: true
    review_period: 季度
  temporary_exceptions:
    max_duration: 6個月
    require_migration_plan: true
global_policy:
  data_formats:
  - YAML
  - JSON
  - TOML
  - Markdown
  - XML
  forbidden_languages:
  - PHP
  - Ruby
  - Lua
  - Perl
  - VBScript
  primary_languages:
  - TypeScript
  - Python
  - C++
  special_purpose_languages:
  - Go
  - Rust
  - Rego
  - Swift
  - Kotlin
monitoring:
  metrics:
  - description: 各語言代碼行數分布
    frequency: 每週
    name: language_distribution
  - description: 跨語言調用統計
    frequency: 每日
    name: cross_language_calls
  - description: 策略違規統計
    frequency: 即時
    name: policy_violations
  reports:
  - frequency: 季度
    name: quarterly_language_review
    recipients:
    - 架構團隊
    - 技術主管
  - frequency: 年度
    name: annual_policy_review
    recipients:
    - 技術委員會
    - CTO
resources:
  documentation:
  - docs/architecture/language-stack.md
  - docs/architecture/language-governance.md
  references:
    Cpp: https://isocpp.org/
    Go: https://go.dev/doc/
    Python: https://docs.python.org/3/
    Rust: https://doc.rust-lang.org/
    TypeScript: https://www.typescriptlang.org/docs/
  training:
  - 新人語言堆疊培訓
  - 跨語言通訊最佳實踐
  - 語言選擇決策指南
version_control:
  changelog:
  - changes: 初始版本，定義完整語言策略
    date: '2025-12-06'
    version: '1.0'
  last_updated: '2025-12-06'
  schema_version: '1.0'
  update_frequency: 季度審查，必要時更新
