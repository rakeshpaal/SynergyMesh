network_security:
  allowed_ips:
  - 192.168.1.0/24
  - 10.0.0.0/8
  - 172.16.0.0/12
  api_rate_limits:
    burst: 20
    per_hour: 5000
    per_minute: 100
    per_second: 10
  audit_logging:
    destinations:
    - endpoint: ${ELASTICSEARCH_ENDPOINT}
      type: elasticsearch
    - endpoint: syslog.example.com:514
      type: syslog
    log_all_requests: true
    log_sensitive_data: false
    retention_days: 365
  blocked_ips:
  - 0.0.0.0/8
  - 127.0.0.0/8
  content_security_policy:
    directives:
      connect-src:
      - '''self'''
      - https://api.github.com
      default-src:
      - '''self'''
      font-src:
      - '''self'''
      - https://fonts.googleapis.com
      frame-ancestors:
      - '''none'''
      img-src:
      - '''self'''
      - 'data:'
      - 'https:'
      script-src:
      - '''self'''
      - '''unsafe-inline'''
      - https://cdn.example.com
      style-src:
      - '''self'''
      - '''unsafe-inline'''
    enabled: true
  cors:
    allowed_headers:
    - Authorization
    - Content-Type
    - X-Requested-With
    allowed_methods:
    - GET
    - POST
    - PUT
    - DELETE
    allowed_origins:
    - https://enterprise.example.com
    - https://*.enterprise.example.com
    enabled: true
    expose_headers:
    - X-RateLimit-Limit
    - X-RateLimit-Remaining
    max_age: 3600
  ddos_protection:
    action: throttle
    block_duration_minutes: 60
    enabled: true
    threshold:
      requests_per_ip: 100
      requests_per_minute: 1000
  firewall_rules:
  - action: allow
    name: Allow HTTPS
    port: 443
    priority: 100
    protocol: tcp
  - action: redirect
    name: Allow HTTP redirect
    port: 80
    priority: 90
    protocol: tcp
    redirect_to: 443
  - action: deny
    name: Block direct SSH
    port: 22
    priority: 80
    protocol: tcp
  proxy:
    enabled: false
    http_proxy: ${HTTP_PROXY}
    https_proxy: ${HTTPS_PROXY}
    no_proxy: localhost,127.0.0.1,.example.com
  security_headers:
    Permissions-Policy: geolocation=(), microphone=(), camera=()
    Referrer-Policy: strict-origin-when-cross-origin
    Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY
    X-XSS-Protection: 1; mode=block
  tls:
    cipher_suites:
    - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
    - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
    - TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
    min_version: '1.2'
    preferred_version: '1.3'
    verify_certificates: true
  vpn:
    allowed_ranges:
    - 10.0.0.0/8
    authentication_method: certificate
    idle_timeout_minutes: 30
    required: true
  webhook_endpoints:
  - events:
    - security_advisory
    - secret_scanning_alert
    - code_scanning_alert
    - dependabot_alert
    secret: ${WEBHOOK_SECRET}
    ssl_verification: true
    timeout_seconds: 30
    url: https://enterprise.example.com/webhooks/security
  - events:
    - repository
    - organization
    - team
    - member
    secret: ${AUDIT_WEBHOOK_SECRET}
    ssl_verification: true
    timeout_seconds: 30
    url: https://enterprise.example.com/webhooks/audit
