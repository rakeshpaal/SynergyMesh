version: "1.0.0"
skeleton_id: "identity-tenancy"

schemas:
  identity_tenancy_input:
    type: object
    description: "身份與多租戶請求：認證、授權或租戶隔離設計"
    properties:
      action_type:
        type: string
        enum:
          - "define_authentication"
          - "design_authorization"
          - "plan_multitenancy"
          - "isolate_tenant"
          - "evaluate_access_control"
        description: "執行動作類型"
      context:
        type: object
        properties:
          user_type: { type: string }
          service_name: { type: string }
          resource_type: { type: string }
          operation: { type: string }
        description: "身份與存取背景"
      requirements:
        type: object
        properties:
          authentication_methods: { type: array, items: { type: string } }
          authorization_model: { enum: ["rbac", "abac", "rebac"] }
          tenancy_scope: { enum: ["shared", "semi-isolated", "fully-isolated"] }
        description: "認證授權需求"
    required:
      - action_type
      - context

  identity_tenancy_report:
    type: object
    description: "身份與多租戶評估報告：認證策略與隔離合規性"
    properties:
      authentication_analysis:
        type: object
        properties:
          recommended_protocols: { type: array, items: { type: string } }
          protocol_comparison:
            type: array
            items:
              type: object
              properties:
                protocol: { type: string }
                pros: { type: array, items: { type: string } }
                cons: { type: array, items: { type: string } }
                security_level: { enum: ["low", "medium", "high"] }
      authorization_design:
        type: object
        properties:
          authorization_model: { type: string }
          roles_permissions:
            type: array
            items:
              type: object
              properties:
                role: { type: string }
                permissions: { type: array, items: { type: string } }
          policy_enforcement_points: { type: array, items: { type: string } }
      tenancy_isolation:
        type: object
        properties:
          isolation_level:
            { enum: ["shared", "semi-isolated", "fully-isolated"] }
          data_segregation_strategy: { type: string }
          blast_radius: { type: string }
          tenant_boundaries: { type: array, items: { type: string } }
      security_risks:
        type: array
        items:
          type: object
          properties:
            risk_id: { type: string }
            severity: { enum: ["critical", "high", "medium", "low"] }
            description: { type: string }
            mitigation: { type: string }
      compliance_status:
        type: object
        properties:
          multi_tenancy_secure: { type: boolean }
          tenant_isolation_verified: { type: boolean }
          access_control_complete: { type: boolean }
          audit_trail_enabled: { type: boolean }
      timestamp: { type: string, format: "date-time" }
    required:
      - authentication_analysis
      - authorization_design
      - tenancy_isolation

  identity_tenancy_suggestion:
    type: object
    description: "身份與多租戶改善建議：升級認證、優化授權或加強隔離"
    properties:
      suggestion_type:
        type: string
        enum:
          - "upgrade_authentication"
          - "implement_mfa"
          - "refactor_authorization"
          - "strengthen_isolation"
          - "implement_audit"
      current_state: { type: string }
      recommended_state: { type: string }
      implementation_steps:
        type: array
        items: { type: string }
      security_improvement:
        type: object
        properties:
          risk_reduction_percentage: { type: number }
          compliance_gaps_closed: { type: array, items: { type: string } }
      migration_path:
        type: object
        properties:
          phases: { type: array, items: { type: string } }
          rollback_plan: { type: string }
          testing_requirements: { type: array, items: { type: string } }
    required:
      - suggestion_type
      - current_state
      - recommended_state
