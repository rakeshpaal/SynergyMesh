# Tenant Quotas Configuration
version: 1.0.0

# 方案定義
tiers:
  free:
    name: Free
    price: 0
    isolation_level: shared
    quotas:
      max_users: 5
      max_projects: 3
      max_agents: 10
      max_knowledge_size_gb: 1
      max_api_calls_per_month: 10000
      max_deployments: 5
    features:
      sso_enabled: false
      custom_domain: false
      audit_logs: false
      priority_support: false
    rate_limits:
      api_calls_per_minute: 60
      concurrent_requests: 10

  standard:
    name: Standard
    price: 99  # USD/month
    isolation_level: dedicated
    quotas:
      max_users: 50
      max_projects: 20
      max_agents: 100
      max_knowledge_size_gb: 50
      max_api_calls_per_month: 1000000
      max_deployments: 50
    features:
      sso_enabled: true
      custom_domain: true
      audit_logs: true
      priority_support: false
    rate_limits:
      api_calls_per_minute: 600
      concurrent_requests: 100

  enterprise:
    name: Enterprise
    price: custom
    isolation_level: isolated
    quotas:
      max_users: unlimited
      max_projects: unlimited
      max_agents: unlimited
      max_knowledge_size_gb: unlimited
      max_api_calls_per_month: unlimited
      max_deployments: unlimited
    features:
      sso_enabled: true
      custom_domain: true
      audit_logs: true
      priority_support: true
      dedicated_support: true
      sla_guarantee: 99.95
    rate_limits:
      api_calls_per_minute: 10000
      concurrent_requests: 1000

# 配額檢查策略
quota_enforcement:
  # 超過配額時的行為
  on_quota_exceeded:
    hard_limit:
      - max_users
      - max_projects
      - max_knowledge_size_gb
    
    soft_limit:  # 允許短暫超過,但會警告
      - max_api_calls_per_month
      - max_agents
    
    throttle:  # 限流而非阻斷
      - api_calls_per_minute
      - concurrent_requests

  # 配額重置週期
  reset_periods:
    max_api_calls_per_month: monthly  # 每月 1 號重置
    api_calls_per_minute: minute

  # 警告閾值
  warning_thresholds:
    - percentage: 80
      notification: email
    - percentage: 95
      notification: email + dashboard

# 試用期設定
trial:
  duration_days: 14
  tier: standard  # 試用期使用 standard 方案
  auto_downgrade_to: free  # 試用結束後自動降級
  grace_period_days: 7  # 寬限期