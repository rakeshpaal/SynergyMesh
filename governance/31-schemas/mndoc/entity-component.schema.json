{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schema.superroot.kn/mndoc/entity/component/v1",
  "title": "Component Entity Schema",
  "description": "定義元件實體結構。Defines the structure for Component entities representing individual modules or services.",
  "type": "object",
  "required": ["$schema", "entity", "id", "type", "path"],
  "properties": {
    "$schema": {
      "type": "string",
      "const": "https://schema.superroot.kn/mndoc/entity/component/v1",
      "description": "Schema namespace identifier"
    },
    "entity": {
      "type": "string",
      "const": "Component",
      "description": "Entity type discriminator"
    },
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9]+([a-z0-9-]*[a-z0-9])?$",
      "description": "Component identifier (slug format)"
    },
    "type": {
      "type": "string",
      "enum": [
        "processor",
        "service",
        "engine",
        "registry",
        "validator",
        "handler",
        "hub",
        "detector",
        "optimizer",
        "orchestrator",
        "controller",
        "manager",
        "module"
      ],
      "description": "Component type"
    },
    "title": {
      "type": "string",
      "description": "Human-readable component name"
    },
    "description": {
      "type": "string",
      "description": "Component description"
    },
    "path": {
      "type": "string",
      "description": "File path relative to repository root"
    },
    "namespace": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9.]*[a-z0-9]$",
      "description": "Logical namespace (e.g., unmanned.island.core)"
    },
    "provides": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Capabilities provided by this component"
    },
    "interfaces": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Interfaces exposed by this component"
    },
    "dependencies": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Dependencies on other components"
    },
    "subsystem_ref": {
      "type": "string",
      "pattern": "^[a-z0-9]+([a-z0-9-]*[a-z0-9])?$",
      "description": "Reference to parent subsystem"
    },
    "language": {
      "type": "string",
      "enum": ["typescript", "javascript", "python", "go", "cpp", "rust", "java"],
      "description": "Primary programming language"
    },
    "entrypoint": {
      "type": "string",
      "description": "Main entry point file or function"
    },
    "owner": {
      "type": "string",
      "description": "Component owner"
    },
    "status": {
      "type": "string",
      "enum": ["draft", "active", "deprecated", "archived"],
      "description": "Lifecycle status"
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Classification tags"
    },
    "evidence_ref": {
      "type": "object",
      "properties": {
        "sbom": { "type": "string" },
        "signature": { "type": "string" },
        "slsa_ref": { "type": "string" }
      },
      "description": "Supply chain evidence references"
    },
    "meta": {
      "type": "object",
      "description": "Additional metadata"
    }
  },
  "additionalProperties": false
}
