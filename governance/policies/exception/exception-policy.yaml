apiVersion: machinenativeops.io/v2
kind: GovernancePolicy
metadata:
  annotations:
    machinenativeops.io/lastReviewed: '2025-12-17'
    machinenativeops.io/version: v1.0.0
  description: 合规例外处理流程与规范
  labels:
    machinenativeops.io/category: process
    machinenativeops.io/domain: compliance
  name: exception-handling-policy
spec:
  approvalProcess:
    approvalCriteria:
    - 明确的业务或技术理由
    - 合理的风险评估
    - 有效的缓解措施
    - 明确的到期日期和补救计划
    - 不会创建先例或滥用
    levels:
    - approvers:
      - count: 1
        role: Team Lead
      riskLevel: 低
      sla: 2 business days
    - approvers:
      - count: 1
        role: Department Manager
      - count: 1
        role: Governance Board Member
      riskLevel: 中
      sla: 5 business days
    - additionalReview:
      - Legal review (if applicable)
      - Compliance review
      approvers:
      - count: 1
        role: VP Engineering
      - count: 1
        role: CISO
      - count: 1
        role: Governance Board
      riskLevel: 高
      sla: 10 business days
  compliance:
    auditTrail:
      enabled: true
      includes:
      - All exception requests
      - Approval decisions and rationale
      - Reviews and updates
      - Expiration and revocation events
      retention: 5 years
    regulatoryAlignment:
    - controls:
      - CC3.1
      - CC3.2
      framework: SOC 2
    - controls:
      - A.6.1.1
      - A.18.1.1
      framework: ISO 27001
  durationLimits:
    default: 3 months
    extensions:
      approvalRequired: Original approvers + Governance Board
      justificationRequired: true
      maxCount: 2
    maximum: 12 months
  enforcement:
    level: error
    violations:
      expiredExceptionInUse:
        action: Automatic revocation + incident report
        severity: High
      missingRemediation:
        action: Prevent renewal until plan provided
        severity: Medium
      unapprovedDeviation:
        action: Immediate escalation to management
        severity: Critical
  exceptionTypes:
  - description: 命名规范例外
    maxDuration: 6 months
    maxRenewals: 2
    renewalAllowed: true
    type: Naming Compliance Exception
    typicalReasons:
    - 遗留系统迁移成本过高
    - 第三方集成依赖现有名称
    - 业务连续性要求
  - description: 安全策略例外
    maxDuration: 3 months
    renewalAllowed: false
    requiresCompensatingControls: true
    type: Security Policy Exception
    typicalReasons:
    - 特定业务需求
    - 技术限制
    - 临时解决方案
  - description: 变更管理流程例外
    maxDuration: Immediate
    postApprovalReview: true
    type: Change Management Exception
    typicalReasons:
    - 紧急生产问题
    - 安全漏洞修复
    - 监管要求
  - description: 文档要求例外
    maxDuration: 1 month
    renewalAllowed: false
    type: Documentation Exception
    typicalReasons:
    - 临时试验项目
    - POC 阶段
  lifecycle:
    states:
    - actions:
      - Edit
      - Submit
      description: 申请人准备中
      state: Draft
    - actions:
      - Approve
      - Reject
      - Request More Info
      description: 等待审批
      state: Under Review
    - actions:
      - Activate
      - Withdraw
      description: 已批准
      state: Approved
    - actions:
      - Review
      - Extend
      - Revoke
      - Remediate
      description: 例外生效中
      monitoring: Active
      state: Active
    - actions:
      - Archive
      automaticAction: Revoke privileges
      description: 已过期
      state: Expired
    - actions:
      - Archive
      description: 已撤销
      state: Revoked
    - actions:
      - Archive
      description: 已补救完成
      state: Remediated
      verification: Required
  metadata:
    approvers:
    - cto@example.com
    - ciso@example.com
    nextReviewDate: '2026-06-17'
    owner: governance-board
    reviewDate: '2025-12-17'
    version: v1.0.0
  monitoring:
    automaticAlerts:
    - action: Notify owner and approvers
      trigger: 30 days before expiration
    - action: Escalate to manager
      trigger: 7 days before expiration
    - action: Automatic revocation
      trigger: Expiration
    metrics:
    - name: Active exceptions
      tracking: Real-time count
    - name: Exception rate by policy
      tracking: Monthly trend
    - name: Average exception duration
      tracking: Monthly average
    - name: Expired exceptions
      tracking: Alert if > 0
    reviewFrequency:
      中: monthly
      低: quarterly
      高: weekly
  prohibitions:
  - description: 不得为避免工作而申请例外
    example: 因为不想更新文档而申请文档例外
  - description: 不得滥用紧急例外流程
    example: 非紧急情况使用紧急变更例外
  - description: 不得无限期续期例外
    example: 连续多次续期而无实质补救进展
  - description: 不得将例外范围扩大
    example: 批准单一服务的例外，但应用到多个服务
  references:
  - title: NIST Risk Management Framework
    url: https://csrc.nist.gov/projects/risk-management
  - title: COBIT Exception Management
    url: https://www.isaca.org/resources/cobit
  remediation:
    components:
    - description: 计划何时符合标准规范
      name: 目标日期
      required: true
    - description: 如何最终符合规范的具体步骤
      name: 实施步骤
      required: true
    - description: 补救计划负责人
      name: 负责人
      required: true
    - description: 补救计划的依赖和阻塞因素
      name: 依赖项
      required: false
    planRequired: true
  reporting:
    contents:
    - Active exceptions by type and risk level
    - New exceptions this period
    - Expired/revoked exceptions
    - Exceptions nearing expiration
    - Remediation progress
    - Trends and patterns
    frequency: Monthly
    recipients:
    - Governance Board
    - Department Managers
    - Compliance Team
  riskAssessment:
    components:
    - description: 评估例外带来的风险等级
      name: 风险等级
      values:
      - 高
      - 中
      - 低
    - description: 受影响的系统、服务、用户
      name: 影响范围
      required: true
    - description: 降低风险的补偿控制措施
      minCount: 1
      name: 缓解措施
      required: true
    - description: 实施缓解措施后的剩余风险
      name: 剩余风险
      required: true
    required: true
  training:
    frequency: Annually
    requiredFor:
    - Team leads
    - Managers
    - Governance board members
    topics:
    - Exception policy overview
    - Risk assessment methodology
    - Approval process
    - Monitoring and reporting
