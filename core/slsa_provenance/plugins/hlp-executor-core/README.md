# HLP Executor Core - SLSA Provenance

This directory contains Supply-Chain Levels for Software Artifacts (SLSA) Level
3 provenance and security attestations for the HLP Executor Core plugin.

## Directory Structure

```
hlp-executor-core/
├── README.md                 # This file
├── sbom.spdx.json           # Software Bill of Materials (SPDX format)
├── provenance.intoto.json   # In-toto provenance attestation
└── signatures/              # Digital signatures directory
    └── cosign.bundle        # Cosign signature bundle
```

## SLSA Level 3 Requirements

This plugin meets SLSA Level 3 requirements:

### ✅ Source Requirements

- **Source integrity**: Git commit SHA verified
- **Provenance available**: Build provenance recorded
- **Unforgeable**: Provenance cryptographically signed

### ✅ Build Requirements

- **Scripted build**: Automated build process
- **Build service**: Secure build platform used
- **Build as code**: Build configuration version-controlled
- **Ephemeral environment**: Clean build environment per build
- **Isolated**: Build isolated from other builds

### ✅ Provenance Requirements

- **Available**: Provenance available to consumers
- **Authenticated**: Provenance is signed
- **Service generated**: Build service generates provenance
- **Non-falsifiable**: Provenance cannot be tampered

### ✅ Common Requirements

- **Security**: Security reviews conducted
- **Access**: Access controls enforced
- **Superusers**: Limited privileged access

## Verification

### Verify SBOM

```bash
# Install SPDX tools
pip install spdx-tools

# Validate SBOM
spdx-tools validate sbom.spdx.json
```

### Verify Provenance

```bash
# Install in-toto
pip install in-toto

# Verify provenance
in-toto-verify --layout provenance.intoto.json
```

### Verify Signatures

```bash
# Install Cosign
brew install cosign  # macOS
# or
curl -O -L "https://github.com/sigstore/cosign/releases/download/v2.0.0/cosign-linux-amd64"

# Verify signature
cosign verify --key /etc/unmanned-island/trust/hlp-executor-core.pub \
  ghcr.io/synergymesh-admin/hlp-executor-core:v1.0.0
```

## SBOM Generation

The Software Bill of Materials is generated during the build process and
includes:

- All direct dependencies
- All transitive dependencies
- Dependency versions and licenses
- Known vulnerabilities (CVEs)
- Package integrity hashes

## Provenance Generation

Build provenance is automatically generated by the secure build platform and
includes:

- Build timestamp
- Builder identity
- Source commit SHA
- Build parameters
- Build outputs
- Build environment details

## Signing Process

All artifacts are signed using Cosign with the following process:

1. **Build**: Artifact built in isolated environment
2. **Generate SBOM**: SBOM created from build metadata
3. **Generate Provenance**: Provenance statement created
4. **Sign**: All artifacts signed with private key
5. **Publish**: Signed artifacts published with signatures

## Security Policy

### Vulnerability Scanning

All dependencies are scanned for vulnerabilities:

- **Block**: Critical and High severity vulnerabilities
- **Warn**: Medium severity vulnerabilities
- **Log**: Low severity vulnerabilities

### Update Policy

- **Security patches**: Applied within 24 hours
- **Dependency updates**: Reviewed weekly
- **SBOM updates**: Generated on every build

## Compliance

This provenance meets the following standards:

- **SLSA Level 3**: Supply-chain security framework
- **NIST SSDF**: Secure Software Development Framework
- **SOC2 Type 2**: Security and availability controls
- **GDPR**: Data protection and privacy

## Contact

For security issues or questions about provenance:

- **Security Team**: <security@unmanned-island.io>
- **Platform Team**: <platform@unmanned-island.io>
- **Issue Tracker**:
  <https://github.com/SynergyMesh-admin/Unmanned-Island/issues>

## References

- [SLSA Framework](https://slsa.dev/)
- [In-toto Provenance](https://github.com/in-toto/attestation)
- [SPDX Specification](https://spdx.dev/)
- [Cosign](https://docs.sigstore.dev/cosign/)
- [Supply-chain Security Best Practices](https://github.com/ossf/wg-best-practices-os-developers)

---

**Last Updated**: 2025-12-07  
**SLSA Level**: 3  
**Status**: Planned (artifacts to be generated during first build)
